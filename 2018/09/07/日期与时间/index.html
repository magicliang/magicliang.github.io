<!DOCTYPE html>

<html lang="zh-Hans">
    <head>
    <meta charset="utf-8">
    <!--
        hexo-theme-suka © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
    -->

    <!-- ### Resource Hint ### -->

    <!-- ## DNS Prefetch ## -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->







<!-- analytics -->







    <!-- ## Preload ## -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="renderer" content="webkit">

    <!-- Title -->
    <title>日期与时间 | 守株阁</title>

    <!-- Favicons -->
    <link rel="icon" type="image&#x2F;ico" href="/img/suka-favicon.ico">

    <!-- ### Import File ### -->
    <link rel="stylesheet" href="/lib/spectre/spectre.min.css"><style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style><link rel="stylesheet" href="/css/style.min.css">








    <!-- Prettify Theme -->
    
    <link rel="preload" href="/css/highlight/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/css/highlight/github.min.css"></noscript>





<script>
/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
</script>

    <!-- ### Site Verification ### -->
    


    <link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="守株阁"><meta name="msapplication-starturl" content="http://magicliang.github.io"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="守株阁"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="日期与时间 | 守株阁"><meta property="og:site_name" content="守株阁"><meta property="og:type" content="article"><meta property="og:url" content="http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/"><meta property="og:locale" content="zh-Hans"><meta name="description" content="JSR 310 Java Date与Time API新旧 API 的更迭旧的 Java API 主要包括java.util.Date和java.util.Calendar 两个包的内容。这两个包的时间类型是可变的。如 Date 的实例可以通过 setYear 来产生变化。 JSR 310 中包括的日期类型主要有：  计算机时间：Instant，对应 java.util.Date，它代表了一个确定的 - magicliang - 守株阁"><meta name="keywords" content="Java, MySQL"><meta property="article:published_time" content="2018-09-07T03:16:39.000Z"><meta property="article:modified_time" content="2020-06-03T06:25:22.000Z"><meta property="og:updated_time" content="2020-06-03T06:25:22.000Z"><meta property="article:author" content="magicliang"><meta property="article:tag" content="Java, MySQL"><meta name="twitter:card" content="summary">

    

    <!-- ### Canonical link ### -->
    <link rel="canonical" href="http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/">

    <meta name="generator" content="Hexo 6.0.0">

    <!-- ### Analytics ### -->
    







    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/",
    "@type": "BlogPosting",
    "logo": "http://magicliang.github.io/img/suka-favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/"
    },
    "headline": "日期与时间 | 守株阁",
    
    "image": {
        "@type": "ImageObject",
        "url": "http://magicliang.github.io/img/suka-favicon.ico"
    },
    
    "datePublished": "2018-09-07T03:16:39.000Z",
    "dateModified": "2020-06-03T06:25:22.000Z",
    "author": {
        "@type": "Person",
        "name": "magicliang",
        "image": {
            "@type": "ImageObject",
            "url": "http://magicliang.github.io/img/default_avatar.png"
        },
        "description": "Hi, nice to meet you."
    },
    "publisher": {
        "@type": "Organization",
        "name": "守株阁",
        "logo": {
            "@type": "ImageObject",
            "url": "http://magicliang.github.io/img/suka-favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "http://magicliang.github.io/search?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "Java, MySQL",
    "description": "JSR 310 Java Date与Time API新旧 API 的更迭旧的 Java API 主要包括java.util.Date和java.util.Calendar 两个包的内容。这两个包的时间类型是可变的。如 Date 的实例可以通过 setYear 来产生变化。 JSR 310 中包括的日期类型主要有：  计算机时间：Instant，对应 java.util.Date，它代表了一个确定的 - magicliang - 守株阁"
}
</script>



    <!-- ### Custom Head ### -->
    
</head>

    <body>
            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/">守株阁</a></h1>

    <p class="text-center header-slogan">
        
            
                Hi, nice to meet you.
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/" class="navbar-link">Home</a>
    
    
        <a href="/archives/" class="navbar-link">Archives</a>
    
    
        <a href="/search" class="navbar-link">Search</a>
    
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">Share</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=守株阁&url=http://magicliang.github.io&pic=http://magicliang.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=守株阁&url=http://magicliang.github.io&via=magicliang" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://magicliang.github.io&title=日期与时间" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=守株阁&title=日期与时间&summary=关于技术以及人生&pics=http://magicliang.github.io/img/suka-favicon.ico&url=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=http://magicliang.github.io&text=日期与时间" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAAAAAAYplnuAAACs0lEQVR42u3c0U4CUQxFUf7/p/XJxOC0Zx9mMCGzeVFhwDXEzu1tK4+vD7w9RIsWLfqG6Mdy+3l8Ou73/c/HPj/n+djfxxGHaNEN+vCPfsAeYabXmY47el5yiBbdoqcATI8dvcYEnDDYIVr0BWh6IiTQtsAVLfq/0Fsys8GmgGwSM9Giz6DTxZ+cAEmQpqC9NMsTfXs03di+++tbduOib4eORT9YXNk2xttmdwrAU1VT0bdGT8nOhqEFSJLkb29OLECKFj1cp6eDJkg60YSnBXrRol9Fb8VDWohMRZu0aG2BKVr0q2i6kU1BRpIq8pp/fhYtGqKbBWJbCGixkmyeYyCKFg2v0wRAGj5t8zMlZ6JFUzRtfqaiTNP4bApDokW36K3QTQqIKcmiyRRJmkSLpugUVG3RnBQctw3tuCCJFg3QZMiVBiFp9G9D4HWjSLTo0EdMjaC0eJBmESlqjkEuWnSBJk2hJhkigd0GvWjRDZoEFllcmoBti5CiRbfoFAxpoLvZSKSiPJ6sES0aosmwX9MMJQEXh7NEiy7RTbO+GUxJSVZq+osW3aBJIkOaSGk4gDZMUbFGtOiAJkVv+j3ZENACUZzqFS0a5tOkcJ7uP1uQxEMqokUfoGkj50yCRJpK8Q0TLbrsjdMEfTspskikDQi+eogWXQ7I0uAhwyh0MVq/Fy365Px0Kq7QxiZpLqEES7RogL4yySH/1IA3sVtRXbTogE6Df22yvxVwyO9CgShadLhON8FHGpx0IHYbGo+NItGiX/xANJJUkcAjDdf1DRItGqLb5PxMY5M08fEUgmjRF34QfNospPto41+06KvRdPivSf63osyaXIkWfSGaNpM2BNlw1EMqokWXCVMzUNIuPGQT8dImQPTt0aQQeGYQkDTz0cIjWjRAf9JNtGjRom+E/gasK4p4iJswUwAAAABJRU5ErkJggg==" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
</nav>
</header>

            
    <!-- ## Post ## -->
    <div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">日期与时间</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/img/default_avatar.png" src="/img/suka-lazyload.gif" alt="magicliang's Avatar">
        <span>2018-09-07</span>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">Share the post</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=日期与时间&url=http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/&pic=http://magicliang.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=日期与时间&url=http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/&via=magicliang" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/&title=守株阁" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=守株阁&title=守株阁&summary=关于技术以及人生&pics=http://magicliang.github.io/img/suka-favicon.ico&url=http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=http://magicliang.github.io/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/&text=守株阁" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAAAAAAYplnuAAACs0lEQVR42u3c0U4CUQxFUf7/p/XJxOC0Zx9mMCGzeVFhwDXEzu1tK4+vD7w9RIsWLfqG6Mdy+3l8Ou73/c/HPj/n+djfxxGHaNEN+vCPfsAeYabXmY47el5yiBbdoqcATI8dvcYEnDDYIVr0BWh6IiTQtsAVLfq/0Fsys8GmgGwSM9Giz6DTxZ+cAEmQpqC9NMsTfXs03di+++tbduOib4eORT9YXNk2xttmdwrAU1VT0bdGT8nOhqEFSJLkb29OLECKFj1cp6eDJkg60YSnBXrRol9Fb8VDWohMRZu0aG2BKVr0q2i6kU1BRpIq8pp/fhYtGqKbBWJbCGixkmyeYyCKFg2v0wRAGj5t8zMlZ6JFUzRtfqaiTNP4bApDokW36K3QTQqIKcmiyRRJmkSLpugUVG3RnBQctw3tuCCJFg3QZMiVBiFp9G9D4HWjSLTo0EdMjaC0eJBmESlqjkEuWnSBJk2hJhkigd0GvWjRDZoEFllcmoBti5CiRbfoFAxpoLvZSKSiPJ6sES0aosmwX9MMJQEXh7NEiy7RTbO+GUxJSVZq+osW3aBJIkOaSGk4gDZMUbFGtOiAJkVv+j3ZENACUZzqFS0a5tOkcJ7uP1uQxEMqokUfoGkj50yCRJpK8Q0TLbrsjdMEfTspskikDQi+eogWXQ7I0uAhwyh0MVq/Fy365Px0Kq7QxiZpLqEES7RogL4yySH/1IA3sVtRXbTogE6Df22yvxVwyO9CgShadLhON8FHGpx0IHYbGo+NItGiX/xANJJUkcAjDdf1DRItGqLb5PxMY5M08fEUgmjRF34QfNospPto41+06KvRdPivSf63osyaXIkWfSGaNpM2BNlw1EMqokWXCVMzUNIuPGQT8dImQPTt0aQQeGYQkDTz0cIjWjRAf9JNtGjRom+E/gasK4p4iJswUwAAAABJRU5ErkJggg==" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                        
                            <div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#JSR-310-Java-Date%E4%B8%8ETime-API"><span class="post-toc-number">1.</span> <span class="post-toc-text">JSR 310 Java Date与Time API</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B0%E6%97%A7-API-%E7%9A%84%E6%9B%B4%E8%BF%AD"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">新旧 API 的更迭</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%97%B6%E5%8C%BA%EF%BC%88%E6%AF%94%E5%A6%82Europe-Paris%E4%B8%8EAmerica-New-York%EF%BC%89%E5%92%8C%E8%B7%9DUTC%E7%9A%84%E5%81%8F%E7%A7%BB%E9%87%8F%EF%BC%88%E6%AF%94%E5%A6%82-01-00%E4%B8%8E-08-00%EF%BC%89%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%AE%E5%88%AB"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">时区（比如Europe&#x2F;Paris与America&#x2F;New_York）和距UTC的偏移量（比如+01:00与-08:00）之间的差别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%85%B6%E4%BB%96%E9%99%84%E5%B1%9E%E7%B1%BB%E5%9E%8B"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">其他附属类型</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#API-%E4%B8%BE%E4%BE%8B"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">API 举例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#DateTimeFormatter"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">DateTimeFormatter</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MySQL-%E4%B8%AD%E7%9A%84%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B%EF%BC%88Date-and-Time-Types%EF%BC%89"><span class="post-toc-number">2.</span> <span class="post-toc-text">MySQL 中的时间类型（Date and Time Types）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">取值范围</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#DATETIME-%E5%92%8C-TIMESTAMP-%E7%9A%84%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%9B%B4%E6%96%B0%E8%A1%8C%E4%B8%BA"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">DATETIME 和 TIMESTAMP 的自动初始化和更新行为</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#DATETIME-%E5%92%8C-TIMESTAMP-%E7%9A%84%E5%85%B6%E4%BB%96%E5%8C%BA%E5%88%AB"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">DATETIME 和 TIMESTAMP 的其他区别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%97%B6%E5%8C%BA%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">时区的影响</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%9F%AB%E6%AD%A3%E5%88%B0%E9%9B%B6%E5%80%BC"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">矫正到零值</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%B2%BE%E5%BA%A6%E5%AE%9A%E4%B9%89"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">精度定义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">日期和时间类型的转换</span></a></li></ol></li></ol></div>
                        
                    
                    <article id="post-content">
                        <h2 id="JSR-310-Java-Date与Time-API"><a href="#JSR-310-Java-Date与Time-API" class="headerlink" title="JSR 310 Java Date与Time API"></a>JSR 310 Java Date与Time API</h2><h3 id="新旧-API-的更迭"><a href="#新旧-API-的更迭" class="headerlink" title="新旧 API 的更迭"></a>新旧 API 的更迭</h3><p>旧的 Java API 主要包括<code>java.util.Date</code>和<code>java.util.Calendar</code> 两个包的内容。这两个包的时间类型是可变的。如 Date 的实例可以通过 setYear 来产生变化。</p>
<p>JSR 310 中包括的日期类型主要有：</p>
<ol>
<li>计算机时间：Instant，对应 java.util.Date，它代表了一个确定的时间点，即相对于标准Java纪元（1970年1月1日）的偏移量；但与java.util.Date类不同的是其精确到了纳秒级别。</li>
<li>人类时间：对应于人类自身的观念，比如LocalDate和LocalTime。他们代表了一般的时区概念，要么是日期（不包含时间），要么是时间（不包含日期），类似于java.sql的表示方式。此外，还有一个MonthDay，它可以存储某人的生日（不包含年份）。每个类都在内部存储正确的数据而不是<strong>像java.util.Date那样利用午夜12点来区分日期，利用1970-01-01来表示时间</strong>。这些类型的实例是 immutable 的，而且只能通过工厂方法创建。</li>
</ol>
<h3 id="时区（比如Europe-Paris与America-New-York）和距UTC的偏移量（比如-01-00与-08-00）之间的差别"><a href="#时区（比如Europe-Paris与America-New-York）和距UTC的偏移量（比如-01-00与-08-00）之间的差别" class="headerlink" title="时区（比如Europe/Paris与America/New_York）和距UTC的偏移量（比如+01:00与-08:00）之间的差别"></a>时区（比如Europe/Paris与America/New_York）和距UTC的偏移量（比如+01:00与-08:00）之间的差别</h3><p>偏移量仅仅是 UTC （基础偏移起点）和本地时间之间的差值。</p>
<p>而时区是一个具名的规则集合，描述了偏移量改如何随着时间的变化而变化。比如说，时区会描述一个特定的区域（比如纽约）在给定的一个时刻具有某个偏移量，之后具有另一个 偏移量（在本地时间线上创建一个间隙或是重叠，如春秋时制的变换）。换言之，时区是比偏移量更复杂的规则集合。</p>
<p>有三个级别的类支持这些概念：</p>
<ol>
<li>LocalDateTime 无需使用偏移量和时区就能表示时间。</li>
<li>OffsetDateTime 额外地指定了偏移量。</li>
<li>ZonedDateTime 则增加了时区规则。</li>
</ol>
<p>过去，很多应用都喜欢使用时区，但他们真正需要的其实只是偏移量而已（使用偏移量更简单、更快且不易出错）。所以我们更加应该使用偏移量。XML Schema规范就是一个典型，它只支持偏移量而不支持时区。JSR 310可以明确表示出这些差别。</p>
<p>时区规则会随着时间的推移而不断发生变化。就在千禧年之前，一些国家将时区由国际日界线之后改为之前；此外，夏时制也在不断变化。</p>
<h3 id="其他附属类型"><a href="#其他附属类型" class="headerlink" title="其他附属类型"></a>其他附属类型</h3><p>可以使用Duration界定任意两个Instant之间的范围。</p>
<p>现在有一些具体的概念来表示YearMonth和MonthDay，在适当的时候应该使用这两个类。还有一个Period类来表示任意的时间周期，如“两年、3个月、7天、4小时、50分钟”等。</p>
<p>核心日历是ISOChronology，默认情况下使用它来映射时间，就像目前Java API中的GregorianCalendar一样。然而，我们对其他一些年代也提供了支持，如CopticChronology和ThaiBuddhistChronology。</p>
<h3 id="API-举例"><a href="#API-举例" class="headerlink" title="API 举例"></a>API 举例</h3><p>操作日期的时候，都会在方法名上让人看出合理的行为模式，模仿自 Joda API：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.journaldev.java8.time;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalTime;</span><br><span class="line"><span class="keyword">import</span> java.time.Period;</span><br><span class="line"><span class="keyword">import</span> java.time.temporal.TemporalAdjusters;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateAPIUtilities</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        LocalDate today = LocalDate.now();</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Get the Year, check if it&#x27;s leap year</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Year &quot;</span>+today.getYear()+<span class="string">&quot; is Leap Year? &quot;</span>+today.isLeapYear());</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Compare two LocalDate for before and after</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Today is before 01/01/2015? &quot;</span>+today.isBefore(LocalDate.of(<span class="number">2015</span>,<span class="number">1</span>,<span class="number">1</span>)));</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Create LocalDateTime from LocalDate</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Current Time=&quot;</span>+today.atTime(LocalTime.now()));</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//plus and minus operations</span></span><br><span class="line">        System.out.println(<span class="string">&quot;10 days after today will be &quot;</span>+today.plusDays(<span class="number">10</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;3 weeks after today will be &quot;</span>+today.plusWeeks(<span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;20 months after today will be &quot;</span>+today.plusMonths(<span class="number">20</span>));</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">&quot;10 days before today will be &quot;</span>+today.minusDays(<span class="number">10</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;3 weeks before today will be &quot;</span>+today.minusWeeks(<span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;20 months before today will be &quot;</span>+today.minusMonths(<span class="number">20</span>));</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Temporal adjusters for adjusting the dates</span></span><br><span class="line">        System.out.println(<span class="string">&quot;First date of this month= &quot;</span>+today.with(TemporalAdjusters.firstDayOfMonth()));</span><br><span class="line">        LocalDate lastDayOfYear = today.with(TemporalAdjusters.lastDayOfYear());</span><br><span class="line">        System.out.println(<span class="string">&quot;Last date of this year= &quot;</span>+lastDayOfYear);</span><br><span class="line"> </span><br><span class="line">        Period period = today.until(lastDayOfYear);</span><br><span class="line">        System.out.println(<span class="string">&quot;Period Format= &quot;</span>+period);</span><br><span class="line">        System.out.println(<span class="string">&quot;Months remaining in the year= &quot;</span>+period.getMonths());        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>新式的 DateTimeFormatter，使用字符串来初始化：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.journaldev.java8.time;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateParseFormatExample</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Format examples</span></span><br><span class="line">        LocalDate date = LocalDate.now();</span><br><span class="line">        <span class="comment">//default format</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Default format of LocalDate=&quot;</span>+date);</span><br><span class="line">        <span class="comment">//specific format</span></span><br><span class="line">        System.out.println(date.format(DateTimeFormatter.ofPattern(<span class="string">&quot;d::MMM::uuuu&quot;</span>)));</span><br><span class="line">        System.out.println(date.format(DateTimeFormatter.BASIC_ISO_DATE));</span><br><span class="line"> </span><br><span class="line">        LocalDateTime dateTime = LocalDateTime.now();</span><br><span class="line">        <span class="comment">//default format</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Default format of LocalDateTime=&quot;</span>+dateTime);</span><br><span class="line">        <span class="comment">//specific format</span></span><br><span class="line">        System.out.println(dateTime.format(DateTimeFormatter.ofPattern(<span class="string">&quot;d::MMM::uuuu HH::mm::ss&quot;</span>)));</span><br><span class="line">        System.out.println(dateTime.format(DateTimeFormatter.BASIC_ISO_DATE));</span><br><span class="line"> </span><br><span class="line">        Instant timestamp = Instant.now();</span><br><span class="line">        <span class="comment">//default format</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Default format of Instant=&quot;</span>+timestamp);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Parse examples</span></span><br><span class="line">        LocalDateTime dt = LocalDateTime.parse(<span class="string">&quot;27::Apr::2014 21::39::48&quot;</span>,</span><br><span class="line">                DateTimeFormatter.ofPattern(<span class="string">&quot;d::MMM::uuuu HH::mm::ss&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;Default format after parsing = &quot;</span>+dt);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>与旧 API 的兼容：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.journaldev.java8.time;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.time.ZoneId;</span><br><span class="line"><span class="keyword">import</span> java.time.ZonedDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.GregorianCalendar;</span><br><span class="line"><span class="keyword">import</span> java.util.TimeZone;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateAPILegacySupport</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Date to Instant</span></span><br><span class="line">        Instant timestamp = <span class="keyword">new</span> Date().toInstant();</span><br><span class="line">        <span class="comment">//Now we can convert Instant to LocalDateTime or other similar classes</span></span><br><span class="line">        LocalDateTime date = LocalDateTime.ofInstant(timestamp, </span><br><span class="line">                        ZoneId.of(ZoneId.SHORT_IDS.get(<span class="string">&quot;PST&quot;</span>)));</span><br><span class="line">        System.out.println(<span class="string">&quot;Date = &quot;</span>+date);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Calendar to Instant</span></span><br><span class="line">        Instant time = Calendar.getInstance().toInstant();</span><br><span class="line">        System.out.println(time);</span><br><span class="line">        <span class="comment">//TimeZone to ZoneId</span></span><br><span class="line">        ZoneId defaultZone = TimeZone.getDefault().toZoneId();</span><br><span class="line">        System.out.println(defaultZone);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//ZonedDateTime from specific Calendar</span></span><br><span class="line">        ZonedDateTime gregorianCalendarDateTime = <span class="keyword">new</span> GregorianCalendar().toZonedDateTime();</span><br><span class="line">        System.out.println(gregorianCalendarDateTime);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//Date API to Legacy classes</span></span><br><span class="line">        Date dt = Date.from(Instant.now());</span><br><span class="line">        System.out.println(dt);</span><br><span class="line"> </span><br><span class="line">        TimeZone tz = TimeZone.getTimeZone(defaultZone);</span><br><span class="line">        System.out.println(tz);</span><br><span class="line"> </span><br><span class="line">        GregorianCalendar gc = GregorianCalendar.from(gregorianCalendarDateTime);</span><br><span class="line">        System.out.println(gc);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DateTimeFormatter"><a href="#DateTimeFormatter" class="headerlink" title="DateTimeFormatter"></a>DateTimeFormatter</h3><p>DateTimeFormatter 是线程安全的，而 SimpleDateFormat 不是。</p>
<p>它的基础用法是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LocalDate date = LocalDate.now();</span><br><span class="line">String text = date.format(formatter);</span><br><span class="line">LocalDate parsedDate = LocalDate.parse(text, formatter);</span><br></pre></td></tr></table></figure>

<p>常见的模式有：</p>
<table>
<thead>
<tr>
<th align="center">Formatter</th>
<th align="center">Description</th>
<th align="center">Example</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ofLocalizedDate(dateStyle)</td>
<td align="center">Formatter with date style from the locale</td>
<td align="center">‘2011-12-03’</td>
</tr>
<tr>
<td align="center">ofLocalizedTime(timeStyle)</td>
<td align="center">Formatter with time style from the locale</td>
<td align="center">‘10:15:30’</td>
</tr>
<tr>
<td align="center">ofLocalizedDateTime(dateTimeStyle)</td>
<td align="center">Formatter with a style for date and time from the locale</td>
<td align="center">‘3 Jun 2008 11:05:30’</td>
</tr>
<tr>
<td align="center">ofLocalizedDateTime(dateStyle,timeStyle)</td>
<td align="center">Formatter with date and time styles from the locale</td>
<td align="center">‘3 Jun 2008 11:05’</td>
</tr>
<tr>
<td align="center">BASIC_ISO_DATE</td>
<td align="center">Basic ISO date</td>
<td align="center">‘20111203’</td>
</tr>
<tr>
<td align="center">ISO_LOCAL_DATE</td>
<td align="center">ISO Local Date</td>
<td align="center">‘2011-12-03’</td>
</tr>
<tr>
<td align="center">ISO_OFFSET_DATE</td>
<td align="center">ISO Date with offset</td>
<td align="center">‘2011-12-03+01:00’</td>
</tr>
<tr>
<td align="center">ISO_DATE</td>
<td align="center">ISO Date with or without offset</td>
<td align="center">‘2011-12-03+01:00’; ‘2011-12-03’</td>
</tr>
<tr>
<td align="center">ISO_LOCAL_TIME</td>
<td align="center">Time without offset</td>
<td align="center">‘10:15:30’</td>
</tr>
<tr>
<td align="center">ISO_OFFSET_TIME</td>
<td align="center">Time with offset</td>
<td align="center">‘10:15:30+01:00’</td>
</tr>
<tr>
<td align="center">ISO_TIME</td>
<td align="center">Time with or without offset</td>
<td align="center">‘10:15:30+01:00’; ‘10:15:30’</td>
</tr>
<tr>
<td align="center">ISO_LOCAL_DATE_TIME</td>
<td align="center">ISO Local Date and Time</td>
<td align="center">‘2011-12-03T10:15:30’</td>
</tr>
<tr>
<td align="center">ISO_OFFSET_DATE_TIME</td>
<td align="center">Date Time with Offset</td>
<td align="center">2011-12-03T10:15:30+01:00’</td>
</tr>
<tr>
<td align="center">ISO_ZONED_DATE_TIME</td>
<td align="center">Zoned Date Time</td>
<td align="center">‘2011-12-03T10:15:30+01:00[Europe/Paris]’</td>
</tr>
<tr>
<td align="center">ISO_DATE_TIME</td>
<td align="center">Date and time with ZoneId</td>
<td align="center">‘2011-12-03T10:15:30+01:00[Europe/Paris]’</td>
</tr>
<tr>
<td align="center">ISO_ORDINAL_DATE</td>
<td align="center">Year and day of year</td>
<td align="center">‘2012-337’</td>
</tr>
<tr>
<td align="center">ISO_WEEK_DATE</td>
<td align="center">Year and Week</td>
<td align="center">2012-W48-6’</td>
</tr>
<tr>
<td align="center">ISO_INSTANT</td>
<td align="center">Date and Time of an Instant</td>
<td align="center">‘2011-12-03T10:15:30Z’</td>
</tr>
<tr>
<td align="center">RFC_1123_DATE_TIME</td>
<td align="center">RFC 1123 / RFC 822</td>
<td align="center">‘Tue, 3 Jun 2008 11:05:30 GMT’</td>
</tr>
</tbody></table>
<p>其中 date 和 time 之间的 T 是 ISO 8601 标准。</p>
<p>其他缩写字母的含义见此文档：<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html</a></p>
<p>以上内容主要参考：</p>
<ol>
<li><a target="_blank" rel="noopener" href="http://www.infoq.com/cn/news/2010/05/jsr-310">《JSR 310 Java Date与Time API》</a></li>
<li><a target="_blank" rel="noopener" href="http://www.importnew.com/14140.html">《Java8 日期/时间（Date Time）API指南》</a></li>
</ol>
<h2 id="MySQL-中的时间类型（Date-and-Time-Types）"><a href="#MySQL-中的时间类型（Date-and-Time-Types）" class="headerlink" title="MySQL 中的时间类型（Date and Time Types）"></a>MySQL 中的时间类型（Date and Time Types）</h2><p>MySQL 共有5种类型来表示时间值（temporal values），包括 DATE，TIME，DATETIME，TIMESTAMP 和 YEAR。所有的时间类型都有一个 valid range，当你插入 invalid value 的时候，<strong>有个 zero value 会被使用</strong>。</p>
<p>MySQL 的时间 API 有几个通用的设计考量：</p>
<ol>
<li>从 MySQL 中获取数据，总是会获取到标准化数据（严出 ）；但对于同一种特定类型，它可以接受并试图解释多种格式的输入。</li>
<li>对于日期，MySQL 倾向于使用年月日的顺序（’98-09-04’），而不是其他顺序。</li>
<li>只有两位数字（two-digit）的年份可能存在二义性，MySQL 的转义规则是：</li>
<li>Year values in the range 70-99 are converted to 1970-1999.</li>
<li>Year values in the range 00-69 are converted to 2000-2069.</li>
<li>如果日期被用在一个数字上下文，MySQL 会自动帮转化为数字。反之亦然。</li>
<li>改变 SQL MODE，可以让 MySQL 接受一些看起来 invalid 的日期。有些日期是用户故意输错的，MySQL 只检查月份是不是在1-12，而日期是不是在1-31里。</li>
<li>MySQL 允许在月和日里存储零值（zero value）。这可以拿来存储不知道确切日期的生日（类似 null 之于 integer）。要 disable 掉这种行为，启动  NO_ZERO_IN_DATE MODE。’0000-00-00’ 就是这样一个 dummy date。使用这种日期的话，相关的日期函数计算就不能得到正确的结果。</li>
<li>零值在 ODBC 等连接器里面，通常会被转化为 NULL，因为这些连接器不知道怎么处理这些零值。</li>
<li>零值表</li>
</ol>
<table>
<thead>
<tr>
<th align="center">数据类型</th>
<th align="center">零值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">DATE</td>
<td align="center">‘0000-00-00’</td>
</tr>
<tr>
<td align="center">TIME</td>
<td align="center">‘00:00:00’</td>
</tr>
<tr>
<td align="center">DATETIME</td>
<td align="center">‘0000-00-00 00:00:00’</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center">‘0000-00-00 00:00:00’</td>
</tr>
<tr>
<td align="center">YEAR</td>
<td align="center">0000</td>
</tr>
</tbody></table>
<ol start="9">
<li>时间值通常有两种字面量表达方法，用引号标准起来的字符串，或者纯数字：’2015-07-21’, ‘20150721’ 和 20150721 都是合理的日期。松散的字面量定义见<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-literals.html">此链接</a>，注意下面的评论，有些断句符本身必须和语言 collation 一起使用。。</li>
</ol>
<h3 id="取值范围"><a href="#取值范围" class="headerlink" title="取值范围"></a>取值范围</h3><p>DATE 类型没有时间部分，通用格式为 ‘YYYY-MM-DD’，合理的取值范围为’1000-01-01’ 至 ‘9999-12-31’。</p>
<p>DATETIME 类型既有日期部分，又有时间部分。合理的取值范围为’1000-01-01’ 至 ‘9999-12-31’。这类似 Java 8 的 LocalDatetime，是属于人的形式，不需要理解时区和偏移。</p>
<p>TIMESTAMP 类型既有日期部分，又有时间部分。合理的取值范围为 ‘1970-01-01 00:00:01’ UTC 至 ‘2038-01-19 03:14:07’ UTC。也就是说， TIMESTAMP 这个类型类似 Unix Epoch timestamp，时间范围又窄，基础偏移量又基于 UTC。</p>
<p>这两种类型的字面量里都是没有 T 的。</p>
<p>DATETIME 和 TIMESTAMP 可以包含最多到微秒六位精度的小数部分。</p>
<p>如果加入了小数部分：</p>
<p>DATETIME 的取值范围变为 ‘1000-01-01 00:00:00.000000’ 到 ‘9999-12-31 23:59:59.999999’。</p>
<p>TIMESTAMP 的取值范围变为 ‘1970-01-01 00:00:01.000000’ 到 ‘2038-01-19 03:14:07.999999’。</p>
<h3 id="DATETIME-和-TIMESTAMP-的自动初始化和更新行为"><a href="#DATETIME-和-TIMESTAMP-的自动初始化和更新行为" class="headerlink" title="DATETIME 和 TIMESTAMP 的自动初始化和更新行为"></a>DATETIME 和 TIMESTAMP 的自动初始化和更新行为</h3><p>基本示例</p>
<p>可以从初始值和其他 column 被修改时自动修改值两个维度来设置类型：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1 (</span><br><span class="line">  ts <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> UPDATE <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">  dt DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> UPDATE <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>但总体来讲不是很好用。还是把缺省初始值设置为某个时间戳比较简单。</p>
<p>具体文档在<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/timestamp-initialization.html">《Automatic Initialization and Updating for TIMESTAMP and DATETIME》</a>。</p>
<h3 id="DATETIME-和-TIMESTAMP-的其他区别"><a href="#DATETIME-和-TIMESTAMP-的其他区别" class="headerlink" title="DATETIME 和 TIMESTAMP 的其他区别"></a>DATETIME 和 TIMESTAMP 的其他区别</h3><ol>
<li>TIMESTAMP 消耗的存储空间更小。</li>
<li>DATETIME 不能使用缺省值，因为这个 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/168736/how-do-you-set-a-default-value-for-a-mysql-datetime-column/10603198">post</a>，以下操作不会生效，插入一个 null gmt_payment_begin_time 依然会收到 jdbc 报错：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`gmt_payment_begin_time` DATETIME <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1971-01-01 00:00:00&#x27;</span> COMMENT <span class="string">&#x27;支付时间&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="时区的影响"><a href="#时区的影响" class="headerlink" title="时区的影响"></a>时区的影响</h3><p>TIMESTAMP 类型在被存储时，会被转往 UTC 时区（此处 UTC 被当做时区来用），在取值的时候，又会被取成当前时区的时间-所以 TIMESTAMP 可以适应服务器、连接的时区变更，DATETIME不行。</p>
<p>而 MySQL 的时区设置，是针对每一个连接可以单独设置的。这也就意味着，如果时区不是一个常量，一个 TIMESTAMP 被存进去一个值，取出来是另一个值。这个可能存在的问题，是大家都喜欢用 datetime 的原因。时区相关的具体行为，可以通过 time_zone 这个环境变量来修改。</p>
<h3 id="矫正到零值"><a href="#矫正到零值" class="headerlink" title="矫正到零值"></a>矫正到零值</h3><p>对于不合理的赋值，MySQL 可能把它赋值为各种类型的零值，还可能产生若干警告。</p>
<h3 id="精度定义"><a href="#精度定义" class="headerlink" title="精度定义"></a>精度定义</h3><p>语法是 type_name(fsp)。type_name 可以是 TIME, DATETIME, 或者 TIMESTAMP，而 fsp 是小数秒精度。</p>
<p>一个例子：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1 (t <span class="type">TIME</span>(<span class="number">3</span>), dt DATETIME(<span class="number">6</span>));</span><br></pre></td></tr></table></figure>

<p>如果定义里面不存在秒数，存值的时候可能会被抹去，<strong>比值的时候可能失败</strong>。</p>
<h3 id="日期和时间类型的转换"><a href="#日期和时间类型的转换" class="headerlink" title="日期和时间类型的转换"></a>日期和时间类型的转换</h3><p>这两种类型相互转换有点类似移位。能补零则补零，否则会变成全零值。</p>
<p>具体内容见<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-type-conversion.html">《Conversion Between Date and Time Types》</a>。</p>

                    </article>
                    


    <blockquote id="date-expire-notification" class="post-expired-notify">This article was last updated on <span id="date-expire-num"></span> days ago, and the information described in the article may have changed.</blockquote>
    <script>
    (function() {
        var dateUpdate = Date.parse("2020-06-03");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    })();
    </script>


<p class="post-footer-info mb-0 pt-0">Published at&nbsp;<time datetime="2018-09-07T03:16:39.000Z" itemprop="datePublished">2018-09-07</time>

    , Updated at&nbsp;<time datetime="2020-06-03T06:25:22.000Z" itemprop="dateModified">2020-06-03</time>

</p>
<p class="post-footer-info mb-0 pt-2">



<span class="post-tags-list mt-2">

<a class="post-tags-list-item" href="/tags/Java/" rel="tag">#&nbsp;Java</a>

<a class="post-tags-list-item" href="/tags/MySQL/" rel="tag">#&nbsp;MySQL</a>

</span>


</p>

                </div>
                <div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/2018/09/07/Docker-%E4%B8%8E%E7%BD%91%E7%BB%9C/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">Docker 与网络</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/2018/08/29/%E4%BD%BF%E7%94%A8-Truffle-%E6%9D%A5%E7%BC%96%E8%AF%91%E3%80%81%E5%AE%89%E8%A3%85%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6-%E6%97%A7%E6%96%87%E4%B8%80%E7%AF%87/" rel="next">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">使用 Truffle 来编译、安装智能合约(旧文一篇)</div>
            </a>
        </li>
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    
        <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span>
            <a class="footer-copyright-a" href="http://magicliang.github.io">守株阁</a>
        </p>

    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>




        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>


        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>

    
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};
document.getElementById('copyright-year').textContent = new Date().getFullYear();
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');

</script>

<script src="/lib/vanilla-lazyload/lazyload.min.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->




<!-- Comment -->


<!-- ### Custom Footer ### -->

    </body>

</html>