<!DOCTYPE html>

<html lang="zh-Hans">
    <head>
    <meta charset="utf-8">
    <!--
        hexo-theme-suka © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
    -->

    <!-- ### Resource Hint ### -->

    <!-- ## DNS Prefetch ## -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->







<!-- analytics -->







    <!-- ## Preload ## -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="renderer" content="webkit">

    <!-- Title -->
    <title>Fabric 文档拾遗 | 守株阁</title>

    <!-- Favicons -->
    <link rel="icon" type="image&#x2F;ico" href="/img/suka-favicon.ico">

    <!-- ### Import File ### -->
    <link rel="stylesheet" href="/lib/spectre/spectre.min.css"><style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style><link rel="stylesheet" href="/css/style.min.css">








    <!-- Prettify Theme -->
    
    <link rel="preload" href="/css/highlight/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/css/highlight/github.min.css"></noscript>





<script>
/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
</script>

    <!-- ### Site Verification ### -->
    


    <link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="守株阁"><meta name="msapplication-starturl" content="http://magicliang.github.io"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="守株阁"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="Fabric 文档拾遗 | 守株阁"><meta property="og:site_name" content="守株阁"><meta property="og:type" content="article"><meta property="og:url" content="http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/"><meta property="og:locale" content="zh-Hans"><meta name="description" content="基本名词解释ledger账本上一系列由事务驱动的状态迁移的记录。状态迁移是链码调用（调用即事务）的结果。这些记录是不可修改顺序的，因此也上抗篡改的。 每个channel有一个账本，但恐怕不只一个账本。 理论上账本是由产生它的链码的命名空间隔离开来的，不能直接被其他链码访问到。 chain由包含一系列 transaction 的 block 通过hash-link（由散列值作为前驱指针的一种连接方式 - magicliang - 守株阁"><meta name="keywords" content="区块链, Hyperledger Fabric"><meta property="og:image" content="https://ws1.sinaimg.cn/large/66dd581fly1fq8up9arebj20wu0h5q3o.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/66dd581fly1fq8uplpjkwj20oj0c70t4.jpg"><meta property="article:published_time" content="2018-04-10T09:28:06.000Z"><meta property="article:modified_time" content="2019-09-09T13:35:42.000Z"><meta property="og:updated_time" content="2019-09-09T13:35:42.000Z"><meta property="article:author" content="magicliang"><meta property="article:tag" content="区块链, Hyperledger Fabric"><meta name="twitter:card" content="summary">

    

    <!-- ### Canonical link ### -->
    <link rel="canonical" href="http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/">

    <meta name="generator" content="Hexo 6.0.0">

    <!-- ### Analytics ### -->
    







    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/",
    "@type": "BlogPosting",
    "logo": "http://magicliang.github.io/img/suka-favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/"
    },
    "headline": "Fabric 文档拾遗 | 守株阁",
    
    "image": {
        "@type": "ImageObject",
        "url": "http://magicliang.github.io/img/suka-favicon.ico"
    },
    
    "datePublished": "2018-04-10T09:28:06.000Z",
    "dateModified": "2019-09-09T13:35:42.000Z",
    "author": {
        "@type": "Person",
        "name": "magicliang",
        "image": {
            "@type": "ImageObject",
            "url": "http://magicliang.github.io/img/default_avatar.png"
        },
        "description": "Hi, nice to meet you."
    },
    "publisher": {
        "@type": "Organization",
        "name": "守株阁",
        "logo": {
            "@type": "ImageObject",
            "url": "http://magicliang.github.io/img/suka-favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "http://magicliang.github.io/search?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "区块链, Hyperledger Fabric",
    "description": "基本名词解释ledger账本上一系列由事务驱动的状态迁移的记录。状态迁移是链码调用（调用即事务）的结果。这些记录是不可修改顺序的，因此也上抗篡改的。 每个channel有一个账本，但恐怕不只一个账本。 理论上账本是由产生它的链码的命名空间隔离开来的，不能直接被其他链码访问到。 chain由包含一系列 transaction 的 block 通过hash-link（由散列值作为前驱指针的一种连接方式 - magicliang - 守株阁"
}
</script>



    <!-- ### Custom Head ### -->
    
</head>

    <body>
            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/">守株阁</a></h1>

    <p class="text-center header-slogan">
        
            
                Hi, nice to meet you.
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/" class="navbar-link">Home</a>
    
    
        <a href="/archives/" class="navbar-link">Archives</a>
    
    
        <a href="/search" class="navbar-link">Search</a>
    
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">Share</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=守株阁&url=http://magicliang.github.io&pic=http://magicliang.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=守株阁&url=http://magicliang.github.io&via=magicliang" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://magicliang.github.io&title=Fabric 文档拾遗" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=守株阁&title=Fabric 文档拾遗&summary=关于技术以及人生&pics=http://magicliang.github.io/img/suka-favicon.ico&url=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=http://magicliang.github.io&text=Fabric 文档拾遗" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKQAAACkCAAAAAA83tqdAAACK0lEQVR42u3b0W6DMBBEUf7/p9vnIrNzF6iaei8vqVASDhJ21uPt8fUPjkOkSJEiPwB5FMePD5zOnd9XfeZ8nl5X5Fzk8qEtkGdsel0CwHVFzkauBsIKt8InePX+q+uKFFkhlw/1Al/d5NXAESnyrYFDBlHnPSJF0h/6BKuKWYp5XAWJ3A5ZLYh+8/W11aLIrZAxNCoWUFVgQMKD11I1kVshqwf5bvhEJ/n0OZEzkVUYlSZdMqiqgCCFCSLnIukDnsIoEvBfTe6tAkPk1shOMFUVHFc3VQ3AWMCIHI1MEy4ZGCRcSAGsSJHdIiMVy+lGySaoyNnI7uRc/U0HHdlEECmyE9anQVAFCKQhSqTIKgilDSGdjVK6+SRyJvJOAVBupD8MWUWKTA82DaLSALvV3CxyJJKEVSRU7W5KobBMpMiHm/FkMq8Cq7gBKnIski7uqyK4E1hdXk/kSGQqCNKCK26sg+AVBVYiRyJpI+bdwUGLX5GzkVWYnxDdUCp9Byp6RW6PJBuZHVA6RzY+RYrED3JYUNHAqpr4URUkcgSyCvnJZNzdeCeNJSJFpsV/VYQ8aaZvNXmK3B4Zf+RvXIBuJsWBJHIkkl68s7AnhUe7O1rkKCQpLkhImgZINdmjhZjIUUjcDHzkfxIik3YqjkWKpAsn2qScbqAKEUSKpI1FpJBIN0BvUKTI9IWkSaTbPHIrwRA5Aol/8EHhSjdCU/OoyLnITz5EihQp8g+Pb3Oo9WSOItLjAAAAAElFTkSuQmCC" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
</nav>
</header>

            
    <!-- ## Post ## -->
    <div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">Fabric 文档拾遗</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/img/default_avatar.png" src="/img/suka-lazyload.gif" alt="magicliang's Avatar">
        <span>2018-04-10</span>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">Share the post</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=Fabric 文档拾遗&url=http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/&pic=http://magicliang.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=Fabric 文档拾遗&url=http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/&via=magicliang" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/&title=守株阁" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=守株阁&title=守株阁&summary=关于技术以及人生&pics=http://magicliang.github.io/img/suka-favicon.ico&url=http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=http://magicliang.github.io/2018/04/10/Fabric-%E6%96%87%E6%A1%A3%E6%8B%BE%E9%81%97/&text=守株阁" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKQAAACkCAAAAAA83tqdAAACK0lEQVR42u3b0W6DMBBEUf7/p9vnIrNzF6iaei8vqVASDhJ21uPt8fUPjkOkSJEiPwB5FMePD5zOnd9XfeZ8nl5X5Fzk8qEtkGdsel0CwHVFzkauBsIKt8InePX+q+uKFFkhlw/1Al/d5NXAESnyrYFDBlHnPSJF0h/6BKuKWYp5XAWJ3A5ZLYh+8/W11aLIrZAxNCoWUFVgQMKD11I1kVshqwf5bvhEJ/n0OZEzkVUYlSZdMqiqgCCFCSLnIukDnsIoEvBfTe6tAkPk1shOMFUVHFc3VQ3AWMCIHI1MEy4ZGCRcSAGsSJHdIiMVy+lGySaoyNnI7uRc/U0HHdlEECmyE9anQVAFCKQhSqTIKgilDSGdjVK6+SRyJvJOAVBupD8MWUWKTA82DaLSALvV3CxyJJKEVSRU7W5KobBMpMiHm/FkMq8Cq7gBKnIski7uqyK4E1hdXk/kSGQqCNKCK26sg+AVBVYiRyJpI+bdwUGLX5GzkVWYnxDdUCp9Byp6RW6PJBuZHVA6RzY+RYrED3JYUNHAqpr4URUkcgSyCvnJZNzdeCeNJSJFpsV/VYQ8aaZvNXmK3B4Zf+RvXIBuJsWBJHIkkl68s7AnhUe7O1rkKCQpLkhImgZINdmjhZjIUUjcDHzkfxIik3YqjkWKpAsn2qScbqAKEUSKpI1FpJBIN0BvUKTI9IWkSaTbPHIrwRA5Aol/8EHhSjdCU/OoyLnITz5EihQp8g+Pb3Oo9WSOItLjAAAAAElFTkSuQmCC" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                        
                            <div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本名词解释</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ledger"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">ledger</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#chain"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">chain</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#state-database"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">state database</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%AF%BB%E5%86%99%E9%9B%86%E8%AF%AD%E4%B9%89"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">读写集语义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%94%9A%E8%8A%82%E7%82%B9"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">锚节点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#leader-%E8%8A%82%E7%82%B9"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">leader 节点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Member"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">Member</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Membership-Service-Provider"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">Membership Service Provider</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Membership-Services"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">Membership Services</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#BCCSP"><span class="post-toc-number">1.10.</span> <span class="post-toc-text">BCCSP</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#bin-%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84%E5%86%85%E5%AE%B9"><span class="post-toc-number">2.</span> <span class="post-toc-text">bin 文件夹下的内容</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="post-toc-number">3.</span> <span class="post-toc-text">初始化的步骤</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="post-toc-number">4.</span> <span class="post-toc-text">启动脚本的作用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#transaction-%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="post-toc-number">5.</span> <span class="post-toc-text">transaction 的流程</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CA-%E9%97%AE%E9%A2%98"><span class="post-toc-number">6.</span> <span class="post-toc-text">CA 问题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B8%B8%E8%A7%81%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="post-toc-number">7.</span> <span class="post-toc-text">常见端口号</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SDK-%E9%97%AE%E9%A2%98"><span class="post-toc-number">8.</span> <span class="post-toc-text">SDK 问题</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%AF%BB%E5%86%99%E9%9B%86%E8%AF%AD%E4%B9%89-1"><span class="post-toc-number">9.</span> <span class="post-toc-text">读写集语义</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#configuration-block"><span class="post-toc-number">10.</span> <span class="post-toc-text">configuration block</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#packaging"><span class="post-toc-number">11.</span> <span class="post-toc-text">packaging</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%81%9C%E6%AD%A2%E9%93%BE%E7%A0%81"><span class="post-toc-number">12.</span> <span class="post-toc-text">停止链码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B3%BB%E7%BB%9F%E9%93%BE%E7%A0%81"><span class="post-toc-number">13.</span> <span class="post-toc-text">系统链码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9E%B6%E6%9E%84%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="post-toc-number">14.</span> <span class="post-toc-text">架构流程图</span></a></li></ol></div>
                        
                    
                    <article id="post-content">
                        <h2 id="基本名词解释"><a href="#基本名词解释" class="headerlink" title="基本名词解释"></a>基本名词解释</h2><h3 id="ledger"><a href="#ledger" class="headerlink" title="ledger"></a>ledger</h3><p>账本上一系列由事务驱动的状态迁移的记录。状态迁移是链码调用（调用即事务）的结果。这些记录是不可修改顺序的，因此也上抗篡改的。</p>
<p>每个channel有一个账本，但恐怕不只一个账本。</p>
<p>理论上账本是由产生它的链码的命名空间隔离开来的，不能直接被其他链码访问到。</p>
<h3 id="chain"><a href="#chain" class="headerlink" title="chain"></a>chain</h3><p>由包含一系列 transaction 的 block 通过hash-link（由散列值作为前驱指针的一种连接方式）组成的数据结构。</p>
<h3 id="state-database"><a href="#state-database" class="headerlink" title="state database"></a>state database</h3><p>记录各种 key 的 latest value。可以被认为上chain的indexed view，可以随时被从链上重建出来。</p>
<p>所以 Fabric 自己就有双层数据结构。</p>
<h3 id="读写集语义"><a href="#读写集语义" class="headerlink" title="读写集语义"></a>读写集语义</h3><p>读集和写集搞不好是同一个事务里的数据结构（待查）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;TxReadWriteSet&gt;</span><br><span class="line">  &lt;NsReadWriteSet name=&quot;chaincode1&quot;&gt;</span><br><span class="line">    &lt;read-set&gt;</span><br><span class="line">      &lt;read key=&quot;K1&quot;, version=&quot;1&quot;&gt;</span><br><span class="line">      &lt;read key=&quot;K2&quot;, version=&quot;1&quot;&gt;</span><br><span class="line">    &lt;/read-set&gt;</span><br><span class="line">    &lt;write-set&gt;</span><br><span class="line">      &lt;write key=&quot;K1&quot;, value=&quot;V1&quot;</span><br><span class="line">      &lt;write key=&quot;K3&quot;, value=&quot;V2&quot;</span><br><span class="line">      &lt;write key=&quot;K4&quot;, isDelete=&quot;true&quot;</span><br><span class="line">    &lt;/write-set&gt;</span><br><span class="line">  &lt;/NsReadWriteSet&gt;</span><br><span class="line">&lt;TxReadWriteSet&gt;</span><br></pre></td></tr></table></figure>

<h3 id="锚节点"><a href="#锚节点" class="headerlink" title="锚节点"></a>锚节点</h3><p>一个 peer 节点，全 channel 里所有的其他节点都可以跟它交谈。每个组织（Member）都有一个锚节点，Member 里  的所有节点通过它来发现频道中的所有其他节点，<strong>通过锚节点和其他组织交换数据</strong>。</p>
<p>特别像以太坊中的 bootnode。</p>
<h3 id="leader-节点"><a href="#leader-节点" class="headerlink" title="leader 节点"></a>leader 节点</h3><p>这个节点代表组织跟 orderer 通信，拉取最新到达的节点以后，<strong>通过 gossip 协议</strong>向其他节点做同步。</p>
<h3 id="Member"><a href="#Member" class="headerlink" title="Member"></a>Member</h3><p>法律上分离的实体，拥有独立的网络根证书。</p>
<h3 id="Membership-Service-Provider"><a href="#Membership-Service-Provider" class="headerlink" title="Membership Service Provider"></a>Membership Service Provider</h3><p>一个抽象的插件化组件，可以切换实现。主要用意是提供 credentials 甚至 peers 给 client，让它跟网络交流。理论上每个 Member 应该有个 MSP。</p>
<p>MSP 的本质是一系列证书、私钥和验证算法，实际上就是一堆文件夹。</p>
<h3 id="Membership-Services"><a href="#Membership-Services" class="headerlink" title="Membership Services"></a>Membership Services</h3><p>每个 peer 和 orderer 都可能实现 MSP，也就是说 MS 其实是它们的一个服务组件。</p>
<h3 id="BCCSP"><a href="#BCCSP" class="headerlink" title="BCCSP"></a>BCCSP</h3><p>Blockchain Crypto Service Provider</p>
<p>和MSP一样，是加密服务的提供者。</p>
<h2 id="bin-文件夹下的内容"><a href="#bin-文件夹下的内容" class="headerlink" title="bin 文件夹下的内容"></a>bin 文件夹下的内容</h2><p>configtxlator<br>get-byfn.sh<br>get-docker-images.sh<br>orderer<br>peer</p>
<p>其中 orderer、peer 都会被映射到镜像之内。</p>
<h2 id="初始化的步骤"><a href="#初始化的步骤" class="headerlink" title="初始化的步骤"></a>初始化的步骤</h2><ol>
<li>cryptogen 这个工具根据配置文件生成指定拓扑的 x.509证书材料。</li>
<li>用 configtxgen 工具生成 orderer 创世区块，给 orderer 用。</li>
<li>生成频道配置事务-算是元事务的一种吧，给 channel 用。</li>
<li>生成相关组织的锚节点。</li>
</ol>
<h2 id="启动脚本的作用"><a href="#启动脚本的作用" class="headerlink" title="启动脚本的作用"></a>启动脚本的作用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./byfn.sh -m up -l node</span><br></pre></td></tr></table></figure>

<p>默认的 chaincode 开发语言是 Golang，但也可以切换到 node 上面。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./byfn.sh -m down</span><br></pre></td></tr></table></figure>

<p>这里的<code>-m</code>是 mode 的意思。</p>
<p>这个命令会消灭掉 docker 网络残余文件，包括密码学文件和链码镜像。</p>
<p>这个大脚本会大量依赖父文件夹的../bin脚本。</p>
<h2 id="transaction-的流程"><a href="#transaction-的流程" class="headerlink" title="transaction 的流程"></a>transaction 的流程</h2><ol>
<li>client 根据 endorsement policy  发送 transaction proposal 到各个 peer。</li>
<li>各个 peer 通过合约容器试算，生成 read-write-set。</li>
<li>client 再根据读写集语义签真正的 transaction，如果不是查询的试算，会把 transaction 发给 orderer。</li>
<li>orderer只负责收集所有的 transaction 打包成区块。</li>
<li>区块发送给 peer，如果 read-write-set 语义还依然满足，则 transaction validate 通过，把区块添加到区块链上。</li>
</ol>
<h2 id="CA-问题"><a href="#CA-问题" class="headerlink" title="CA 问题"></a>CA 问题</h2><p>CA 是可选组件。</p>
<p>但如果 CA server 跑起来，我们可以向它发送 REST 请求给组织的 CA 来完成用户注册和登记。</p>
<p>CA 是 PKI 的实现。PKI 可以抗女巫攻击。</p>
<p>CA 可以像 cryptogen 一样，先生成组织里的节点证书和私钥（组织里一定会有 root-ca），然后生成成员（admin 和普通成员）的证书和私钥。</p>
<h2 id="常见端口号"><a href="#常见端口号" class="headerlink" title="常见端口号"></a>常见端口号</h2><p>这些端口号有先后顺序，适合在同一个 host 编排一系列容器。</p>
<p>orderer：7050<br>peer：7051<br>peer event：7053<br>ca：7054</p>
<h2 id="SDK-问题"><a href="#SDK-问题" class="headerlink" title="SDK 问题"></a>SDK 问题</h2><p>区块链天然可以用gRPC来通信。</p>
<p>因为各种语言都支持 Protocol Buffers，基于Protocol Buffers over gRPC，我们可以制造各种语言的SDK。</p>
<p>所以理论上我们可以直接通过 gRPC 跟区块链通信。</p>
<h2 id="读写集语义-1"><a href="#读写集语义-1" class="headerlink" title="读写集语义"></a>读写集语义</h2><p>实际上读集（read set）和写集（write set）是分开的。<br>它们共同组成了事务。</p>
<h2 id="configuration-block"><a href="#configuration-block" class="headerlink" title="configuration block"></a>configuration block</h2><p>有configtx，就有configuration block，这不奇怪。两者都要经过orderer。</p>
<p>可以通过命令行来获取configuration（peer channel fetch）。peer channel fetch 可以用来获取任意序号的区块。</p>
<h2 id="packaging"><a href="#packaging" class="headerlink" title="packaging"></a>packaging</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer chaincode package -n mycc -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 -v 0 -s -S -i &quot;AND(&#x27;OrgA.admin&#x27;)&quot; ccpack.out</span><br></pre></td></tr></table></figure>

<p>这一行命令生成了一个 signedCDS。</p>
<p>有<code>-s</code>（signing的意思）应该有<code>-S</code>，否则再也没有机会让 owner 来签署这个 package 了。<code>-S</code>指出了需要本地 MSP 来 sign 这个 package。</p>
<p><code>-i</code>是 intantiate policy，指的是只有 OrgA 的 admin 可以初始化这个 package。</p>
<p>实际上不用 package 和 sign 最好了，反正每个peer默认可以初始化链码也只有本 Member 的 admin（这种 admin 在默认的情况下是大多数需要产生变化的 wrtier）。</p>
<p>可见这个初始化策略是针对 package 而不是针对 channel 的。我们只可以组织一个 package 被初始化，不能阻止别人在一个 channel 上安装任意的 chaincode。</p>
<p>这个初始化策略还会进一步限制 upgrade。只有符合策略的 MSP 才能 upgrade 整个lian ma</p>
<h2 id="停止链码"><a href="#停止链码" class="headerlink" title="停止链码"></a>停止链码</h2><p>目前只能通过停止和删除容器，并删除 peer 上 CDS的方式来做到，对其他组织的机器是个考验呢。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f &lt;container id&gt;</span><br><span class="line">rm /var/hyperledger/production/chaincodes/&lt;ccname&gt;:&lt;ccversion&gt;</span><br></pre></td></tr></table></figure>

<h2 id="系统链码"><a href="#系统链码" class="headerlink" title="系统链码"></a>系统链码</h2><p>逻辑上和普通链码是一样的（应该也是通过各种事务驱动的），但只跑在 peer 进程内。</p>
<p>系统链码的目的是为了减少 peer 和 chaincode 容器之间的 gRPC。</p>
<p>要 upgrade 链码只有 upgrade peer 二进制文件（实际上就是跟着 Fabric 版本走）。</p>
<h2 id="架构流程图"><a href="#架构流程图" class="headerlink" title="架构流程图"></a>架构流程图</h2><p><img src="https://ws1.sinaimg.cn/large/66dd581fly1fq8up9arebj20wu0h5q3o.jpg"></p>
<p><img src="https://ws1.sinaimg.cn/large/66dd581fly1fq8uplpjkwj20oj0c70t4.jpg"></p>

                    </article>
                    


    <blockquote id="date-expire-notification" class="post-expired-notify">This article was last updated on <span id="date-expire-num"></span> days ago, and the information described in the article may have changed.</blockquote>
    <script>
    (function() {
        var dateUpdate = Date.parse("2019-09-09");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    })();
    </script>


<p class="post-footer-info mb-0 pt-0">Published at&nbsp;<time datetime="2018-04-10T09:28:06.000Z" itemprop="datePublished">2018-04-10</time>

    , Updated at&nbsp;<time datetime="2019-09-09T13:35:42.000Z" itemprop="dateModified">2019-09-09</time>

</p>
<p class="post-footer-info mb-0 pt-2">



<span class="post-tags-list mt-2">

<a class="post-tags-list-item" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">#&nbsp;区块链</a>

<a class="post-tags-list-item" href="/tags/Hyperledger-Fabric/" rel="tag">#&nbsp;Hyperledger Fabric</a>

</span>


</p>

                </div>
                <div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/2018/05/09/%E9%87%8D%E6%8B%BETCP-IP%E5%8D%8F%E8%AE%AE%E7%B0%87/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">重拾TCP/IP协议簇</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/2018/04/09/Fabric-%E4%B8%AD%E7%9A%84-peer/" rel="next">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">Fabric 中的 peer</div>
            </a>
        </li>
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    
        <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span>
            <a class="footer-copyright-a" href="http://magicliang.github.io">守株阁</a>
        </p>

    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>




        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>


        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>

    
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};
document.getElementById('copyright-year').textContent = new Date().getFullYear();
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');

</script>

<script src="/lib/vanilla-lazyload/lazyload.min.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->




<!-- Comment -->


<!-- ### Custom Footer ### -->

    </body>

</html>