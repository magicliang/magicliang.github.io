<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>比特币小细节 | 守株阁</title><meta name="author" content="magicliang"><meta name="copyright" content="magicliang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="收款地址是公钥的hash。 区块结构：     数据项 描述 长度     Magic No 魔数 总是 0xD9B4BEF9 4 字节（定长）   BlockSize 区块大小 到区块结束的字节长度 4字节（定长）   BlockHeader 区块头 包含六个数据项 80字节（定长）   Transaction Counter 交易计数器 正整数 VI&#x3D;VarInt 1-9字节（变长）   B">
<meta property="og:type" content="article">
<meta property="og:title" content="比特币小细节">
<meta property="og:url" content="https://magicliang.github.io/2018/01/27/%E6%AF%94%E7%89%B9%E5%B8%81%E5%B0%8F%E7%BB%86%E8%8A%82/index.html">
<meta property="og:site_name" content="守株阁">
<meta property="og:description" content="收款地址是公钥的hash。 区块结构：     数据项 描述 长度     Magic No 魔数 总是 0xD9B4BEF9 4 字节（定长）   BlockSize 区块大小 到区块结束的字节长度 4字节（定长）   BlockHeader 区块头 包含六个数据项 80字节（定长）   Transaction Counter 交易计数器 正整数 VI&#x3D;VarInt 1-9字节（变长）   B">
<meta property="og:locale">
<meta property="og:image" content="https://magicliang.github.io/img/wall-paper-112.jpg">
<meta property="article:published_time" content="2018-01-27T08:45:27.000Z">
<meta property="article:modified_time" content="2025-10-22T08:01:31.905Z">
<meta property="article:author" content="magicliang">
<meta property="article:tag" content="区块链">
<meta property="article:tag" content="比特币">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://magicliang.github.io/img/wall-paper-112.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "比特币小细节",
  "url": "https://magicliang.github.io/2018/01/27/%E6%AF%94%E7%89%B9%E5%B8%81%E5%B0%8F%E7%BB%86%E8%8A%82/",
  "image": "https://magicliang.github.io/img/wall-paper-112.jpg",
  "datePublished": "2018-01-27T08:45:27.000Z",
  "dateModified": "2025-10-22T08:01:31.905Z",
  "author": [
    {
      "@type": "Person",
      "name": "magicliang",
      "url": "https://magicliang.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://magicliang.github.io/2018/01/27/%E6%AF%94%E7%89%B9%E5%B8%81%E5%B0%8F%E7%BB%86%E8%8A%82/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: magicliang","link":"Link: ","source":"Source: 守株阁","info":"Copyright belongs to the author. For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source."}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '比特币小细节',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="守株阁" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/wall-paper-112.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">守株阁</span></a><a class="nav-page-title" href="/"><span class="site-name">比特币小细节</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">比特币小细节</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2018-01-27T08:45:27.000Z" title="Created 2018-01-27 16:45:27">2018-01-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-22T08:01:31.905Z" title="Updated 2025-10-22 16:01:31">2025-10-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>7mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><ul>
<li>收款地址是公钥的hash。</li>
<li>区块结构：</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">数据项</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">长度</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Magic No 魔数</td>
<td style="text-align:center">总是 0xD9B4BEF9</td>
<td style="text-align:center">4 字节（定长）</td>
</tr>
<tr>
<td style="text-align:center">BlockSize 区块大小</td>
<td style="text-align:center">到区块结束的字节长度</td>
<td style="text-align:center">4字节（定长）</td>
</tr>
<tr>
<td style="text-align:center">BlockHeader 区块头</td>
<td style="text-align:center">包含六个数据项</td>
<td style="text-align:center">80字节（定长）</td>
</tr>
<tr>
<td style="text-align:center">Transaction Counter 交易计数器</td>
<td style="text-align:center">正整数 VI=VarInt</td>
<td style="text-align:center">1-9字节（变长）</td>
</tr>
<tr>
<td style="text-align:center">BlockHeader 区块头</td>
<td style="text-align:center">包含六个数据项</td>
<td style="text-align:center">80字节（定长）</td>
</tr>
<tr>
<td style="text-align:center">Transactions 交易</td>
<td style="text-align:center">交易列表（非空）</td>
<td style="text-align:center">由Transaction Counter 描述的长度（变长）</td>
</tr>
</tbody>
</table>
<p>由此表可见，只有交易计数器和交易明细列表是变长的。</p>
<ul>
<li>比特币使用 SHA256 算法，它的结果哈希值大小为 256 位。也就是说，只要输入超过2的256次方个数，就一定会发生碰撞，即使只有2的255次方个数，也有百分之九十九的几率发生碰撞（为什么？）。</li>
<li>当前（这一百年内），每个区块都至少包含一个 Transaction，它被称为生产交易，或者coinbase交易，用于给生成这个区块的矿工以奖励，它经常是区块中第一个交易。</li>
<li>奖励每21万个区块减半一次。</li>
<li>区块客户端的目标总是每小时产生6个区块。每2016个区块（大约2周）后，所有客户端（即矿工节点）收集当前区块的实际数目，和目标数目做对比，借此调整目标 Hash值，来调节产生区块的难度。</li>
<li>区块链的客户端总是接受最长链。在这里，长度指的是“难度”，而不是具有最大区块数量的链，可以防止某些人构造大量低难度的链制造分叉。</li>
<li>如果能够制造分叉，则可以在比特币网络里为所欲为，双花攻击只是其中之一。</li>
<li>创世区块讽刺了银行动用准备金而导致金融系统稳定性下降。创世区块中的50个比特币无法被花掉。简而言之，是每个客户端的创世区块不尽相同：</li>
</ul>
<blockquote>
<p>创世块的收益不可能被花掉，因为创世块是用代码表示的(这个巧合可能是故意的)，尽管如此，其50BTC收益还是被发送到地址：1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa。<br>
(译者按：创世块的收益花不掉，原因如下：比特币客户端把区块和交易分开存贮在两个数据库中，当客户端发现区块数据库为空时，用代码直接生成一个创世块，但是没有生成这个交易，所以客户端中的交易数据库中是没有发送到上述地址这个交易的，因而一旦收到要花掉该收益的交易时，都会拒绝，所以无法得到任何确认，就花不掉这50个币。出现这种情况很可能是中本聪故意的。)</p>
</blockquote>
<ul>
<li>区块和区块链把交易的world history break down 成了若干个小的时间片内的记录，而记录之间又因为数学相关性互相串联，形成了可追溯又抗篡改的强大特性。</li>
<li>区块的奖励有一个100个区块的成熟时间：</li>
</ul>
<blockquote>
<p>译者按：区块成熟时间(Maturation Time)，是指矿工产生一个新区块得到25BTC收益后，要等过了100个块后，才能使用这些币；这个100区块时间，即收到100个确认的时间，就是区块成熟时间。为什么要设这个时间？如果这个区块在分叉时变成了孤立区块，25个BTC的收益将消失，如果矿工挖到比特币后可以马上花掉，就会造成后续的一系列接收者损失比特币，因而设定了100个确认的限制，在这之后产生分叉的可能性非常小，即使产生分叉，也只会影响矿工收益，不会影响到其他人。</p>
</blockquote>
<ul>
<li>区块头的格式：</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">数据项</th>
<th style="text-align:center">目的</th>
<th style="text-align:center">更新时间</th>
<th style="text-align:center">大小</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Version 版本</td>
<td style="text-align:center">区域版本号</td>
<td style="text-align:center">更新软件后，它指定了一个新版本号（也就是说，客户端是有自己的版本号区别的）</td>
<td style="text-align:center">4字节</td>
</tr>
<tr>
<td style="text-align:center">hashPrevBlock 前一个区块Hash</td>
<td style="text-align:center">前一区块的256位HASH值</td>
<td style="text-align:center">新的区块进来时</td>
<td style="text-align:center">32字节 恰好等于 SHA256散列的结果字符串长度</td>
</tr>
<tr>
<td style="text-align:center">hashMerkleRoot Merkele根节点HASH值</td>
<td style="text-align:center">基于一个区块中所有交易产生的默克尔树的 256位SHA值（也就是32个字节，32个 Ascii码）</td>
<td style="text-align:center">接受一个交易时（也就是说在区块更新时会一直更新？）</td>
<td style="text-align:center">32字节 恰好等于 SHA256散列的结果字符串长度</td>
</tr>
<tr>
<td style="text-align:center">Time 时间戳</td>
<td style="text-align:center">从1970-01-01 00:00 UTC开始到现在，以秒为单位的当前时间戳（类似 Unix epoch） 这个时间戳在全球范围内可能出现不准的情况，怎么办？</td>
<td style="text-align:center">每几秒就更新一次（终止于区块生成时？）</td>
<td style="text-align:center">4字节（对毫秒而言不够，对秒而言就够了）</td>
</tr>
<tr>
<td style="text-align:center">Bits</td>
<td style="text-align:center">压缩格式当前的目标值</td>
<td style="text-align:center">当挖矿难度调整时</td>
<td style="text-align:center">4字节（4 * 8 = 32位） 使用特殊的方法用4字节表达32字节的 SHA256 散列字符串</td>
</tr>
<tr>
<td style="text-align:center">Nonce 随机数</td>
<td style="text-align:center">从0开始的32位随机数</td>
<td style="text-align:center">产生Hash时（每次产生Hash随机数都要增长，为什么？）</td>
<td style="text-align:center">4字节</td>
</tr>
</tbody>
</table>
<blockquote>
<p>区块内包含许多交易，它们通过Merkle根节点间接被HASH，因为所有交易不可能直接被HASH，HASH包含一个交易的区块所花的时间，和HASH包含1万个交易的区块一样。</p>
</blockquote>
<p>也就是说区块的Hash里包含了非常多的内容。</p>
<blockquote>
<p>目标HASH值的压缩格式是一个特殊的浮点编码类型，首字节是指数(仅使用了5个最低位)，后3个字节是尾数，它能表示256位的数值。一个区块头的SHA256值必定要小于或等于目标HASH值，该区块才能被网络所接受，目标HASH越低，产生一个新区块的难度越大。</p>
</blockquote>
<p>用特殊的格式用一个4字节的Bit来描述32字节的难度字符串。</p>
<blockquote>
<p>上述大部分数据项对所有用户是一致的，可能在时间戳上有些区别。(译者按：该段的以下内容来自：)如果当前区块的时间戳大于前11个区块的的平均时间戳，并且小于“网络调整时间(Network-Adjusted Time)”+2小时，则认为该时间戳是有效的。其中的“网络调整时间”是指与你相连接的所有节点的平均时间。当节点A连接到节点B时，A从B处得到一个UTC标准的时间戳，A先转换成本地UTC标准时间保存起来，网络调整时间等于所有节点的本地UTC时间+所有相连节点的偏移量平均值，然而，该网络时间永远不会调整到超过本地系统时间70分钟以上。</p>
</blockquote>
<p>时间戳确实是有用的，不能乱写时间。</p>
<blockquote>
<p>Nonce随机数通常不同，但是它以严格的线性方式增长，从0开始，每次HASH时都会增长，当Nonce溢出时(此事经常发生)，生产交易的extraNonce项会增长，将改变Merkle树的根节点。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://bitcoin.stackexchange.com/questions/5048/what-is-the-extranonce">extraNonce有人认为会占用默克尔树的根，也有人认为会占用coinbase</a>：</p>
<blockquote>
<p>A solo miner increments Nonce until it overflows. Then it increments extraNonce and resets Nonce. extraNonce is located in the coinbase transaction, so changing it alters the Merkle root. extraNonce is reset based on the time.</p>
</blockquote>
<p>nonce的增长过程请看接下来的解谜过程详解。</p>
<ul>
<li>解谜过程详解：</li>
</ul>
<p>可以在这个字符串后面添加一个整数值（在比特币中为nonce的标记），对变更后的字符串进行SHA256哈希运算，如果得到的哈希结果（以16进制的形式表示）是以&quot;0000&quot;开头的，则验证通过。为了达到这个工作量证明的目标。我们需要不停的递增值，对得到的新字符串进行SHA256哈希运算。按照这个规则，我们预计需要经过4251次计算才能找到恰好前4位为0的哈希散列。</p>
<blockquote>
<p>“Hello, world!0” =&gt; 1312af178c253f84028d480a6adc1e25e81caa44c749ec81976192e2ec934c64<br>
“Hello, world!1” =&gt; e9afc424b79e4f6ab42d99c81156d3a17228d6e1eef4139be78e948a9332a7d8<br>
“Hello, world!2” =&gt; ae37343a357a8297591625e7134cbea22f5928be8ca2a32aa475cf05fd4266b7<br>
…<br>
“Hello, world!4248” =&gt; 6e110d98b388e77e9c6f042ac6b497cec46660deef75a55ebc7cfdf65cc0b965<br>
“Hello, world!4249” =&gt; c004190b822f1669cac8dc37e761cb73652e7832fb814565702245cf26ebb9e6<br>
“Hello, world!4250” =&gt; 0000c3af42fc31103f1fdc0151fa747ff87349a4714df7cc52ea464e12dcd4e9</p>
</blockquote>
<p>比特币使用双重散列区块头：SHA256(SHA256(区块头))计算HASH，但你要注意字节序。这也就是其他客户端节点验算区块的过程。</p>
<p>例如：以下python代码用于计算某一区块的HASH值，使用2011年6月的区块号125552的最小HASH值。该区块头建立上述6个数据项之上，并且以十六进制的小端结尾方式连接在一起。</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">import</span> hashlib</span><br><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">header_hex = (“<span class="hljs-number">0</span>1000000″ +</span><br><br>“81cd02ab7e569e8bcd9317e2fe99f2de44d49ab2b8851ba4a308000000000000″ +<br><br>“e320b6c2fffc8d750423db8b1eb942ae710e951ed797f7affc8892b0f1fc122b” +<br><br>“c7f5d74d” +<br><br>“f2b9441a” +<br><br>“42a14695″)<br><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">header_bin = header_hex.decode(‘<span class="hljs-built_in">hex</span>’)</span><br><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">hash</span> = hashlib.sha256(hashlib.sha256(header_bin).digest()).digest()</span><br><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">hash</span>.encode(‘hex_codec’)</span><br><br>’1dbd981fe6985776b644b173a4d0385ddc1aa2a829688d1e0000000000000000′<br><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">hash</span>[::-<span class="hljs-number">1</span>].encode(‘hex_codec’)</span><br><br>’00000000000000001e8d6829a8a21adc5d38d0a473b144b6765798e61f98bd1d’<br><br></code></pre></td></tr></table></figure>
<ul>
<li>比特币是一个附带脚本的货币，也就意味着，汇款可以有附录。这个附录启发了智能合约区块链的诞生：</li>
</ul>
<blockquote>
<p>正如我们所见，每个比特币交易里都有一段比特币脚本语言。这个脚本在这篇文章里被简化成了类似于这样的话 “我Alice要给Bob 10个比特币”。 但是这个脚本语言可以同时被用来表述更复杂的交易。换句话说，比特币是一个可编程的货币。</p>
</blockquote>
<ul>
<li>挖矿硬件的演变：最开始的CPU挖矿，过度到GPU挖矿，最终演化到当前的ASIC（专业矿机）。目前为止，诞生了两种矿池协议：<img src="https://ws1.sinaimg.cn/large/66dd581fly1fnv9rc70grj20h00f7aal.jpg" alt=""></li>
</ul>
<p>参考文献：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/33114775">https://zhuanlan.zhihu.com/p/33114775</a></li>
<li><a target="_blank" rel="noopener" href="http://www.8btc.com/bitcoin-transactions">http://www.8btc.com/bitcoin-transactions</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/23558268">https://zhuanlan.zhihu.com/p/23558268</a></li>
<li><a target="_blank" rel="noopener" href="http://www.8btc.com/blockchain-tech-mining">http://www.8btc.com/blockchain-tech-mining</a></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://magicliang.github.io">magicliang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://magicliang.github.io/2018/01/27/%E6%AF%94%E7%89%B9%E5%B8%81%E5%B0%8F%E7%BB%86%E8%8A%82/">https://magicliang.github.io/2018/01/27/%E6%AF%94%E7%89%B9%E5%B8%81%E5%B0%8F%E7%BB%86%E8%8A%82/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/">区块链</a><a class="post-meta__tags" href="/tags/%E6%AF%94%E7%89%B9%E5%B8%81/">比特币</a></div><div class="post-share"><div class="social-share" data-image="/img/wall-paper-112.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2018/02/20/%E9%97%AA%E7%94%B5%E7%BD%91%E7%BB%9C%E3%80%81%E4%BE%A7%E9%93%BE%E3%80%81%E9%9A%94%E7%A6%BB%E8%A7%81%E8%AF%81%E4%B8%8E%E5%A4%A7%E5%8C%BA%E5%9D%97%E6%89%A9%E5%AE%B9%E9%97%AE%E9%A2%98/" title="闪电网络、侧链、隔离见证与大区块扩容问题"><img class="cover" src="/img/wall-paper-59.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-02-20</div><div class="info-item-2">闪电网络、侧链、隔离见证与大区块扩容问题</div></div><div class="info-2"><div class="info-item-1">闪电网络 闪电网络的原理 闪电网络就是在链外专门设置一个通道（channel），所有的交易都在链上进行，只有最终结算在链上进行。这就好像我们的计算机体系结构里面加入的一个工作内存和主内存的 hiarachy。 过程描述如下：  假设我和你，咱俩人经常交易，于是就在闪电网络上开个通道，容量是2BTC； 通道里面AB在总量不超过2BTC的情况下随便相互收发，所有操作送到一个具有AB多重签名的地址，每次操作签名就好； 通道里面的操作没有手续费，因为真实的BTC在链上其实没动过，通道里面的操作本质上是只是对俩人那两个BTC份额所有权的交易； 等啥时候AB不想交易了，把隧道关闭，去真实的比特币主链上兑换一下自己在那两个BTC里的份额就好； 高手续费只发生在打开，或是关闭一个通道的时候。   为什么闪电网络会不安全 这种侧链的出现，必然会导致庞大的中间人出现：  网络上会演化出一些大的中间人节点，这些节点有足够多的BTC，足够的流动性，和足够多的通道数量，所以你再也不用担心高额的手续费，自己去找中间人等等一系列麻烦。 然而这些节点，和矿工不一样，他们并不和你直接交易BTC，他们更像是一种“第...</div></div></div></a><a class="pagination-related" href="/2018/03/08/%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB%E9%97%AE%E9%A2%98/" title="重放攻击问题"><img class="cover" src="/img/wall-paper-125.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-03-08</div><div class="info-item-2">重放攻击问题</div></div><div class="info-2"><div class="info-item-1">比特币靠不同的地址前缀可以规避重放攻击问题。 以太坊可以靠 EIP155 钱包来规避重放攻击问题。 何为重放攻击问题？ 一个区块链有若干个测试网络。如果一套公私钥可以在不同的网络上通用，则可以恶意地把在测试网络中出现的 transaction 播放到主网上。如果在测试网络上有人从账户 A 转了一笔钱到账户 B，而账户 B 是一个傻瓜测试账户，私钥是由类似123456之类的种子生成的话。那么只要账户 A 在主网中的余额大于这笔钱，心怀恶意者就能把主网中 A 的钱财转走，从主网中的账户 B 里把钱取出来。即使心怀恶意者没有 B 的取款方法，也能让账户 A 蒙受资金损失。 所以不要跨网使用相同的公私钥对。 </div></div></div></a><a class="pagination-related" href="/2018/03/08/UTXO-%E4%B8%8E-account-balance-%E6%A8%A1%E5%9E%8B/" title="UTXO 与 account balance 模型"><img class="cover" src="/img/wall-paper-81.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-03-08</div><div class="info-item-2">UTXO 与 account balance 模型</div></div><div class="info-2"><div class="info-item-1">UTXO 简介   UTXO 的全称的 unspent transaction output，就是没有被人用过的可用资金。   这个模型是比特币首创的，被其他货币所模仿。以太坊天然的模型不是 UTXO 而是 account balance。   UTXO 必须配平，UTXO 的输入者必须上一个 UTXO 的输出者：    这就把一个一个账户型数据库，转成了链式的交易数据库，交易要靠 merge 整个数据库的相关节点。   UTXO 的好处是：  更加好的隐私模型 更加强的并发范型（因为不会触发间隙锁了吗？）  ZCash 的 UTXO   ZCash 也一样有 UTXO，但它的 UTXO 是加密过的，而且每个矿工那里还有一个专门的 UTXO 作废数据库。具体情况见《不是程序员也能看懂的ZCash零知识证明》。 ##以太坊中的 account 模型##   以太坊没有使用 UTXO 模型，而使用 account balance 模型，他们把 account balance 模型称为 world state。account balance 模型比 UTXO 模型更加容易实现智能合约，...</div></div></div></a><a class="pagination-related" href="/2018/03/11/%E7%B2%BE%E9%80%9A%E6%AF%94%E7%89%B9%E5%B8%81%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="精通比特币读书笔记"><img class="cover" src="/img/wall-paper-108.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-03-11</div><div class="info-item-2">精通比特币读书笔记</div></div><div class="info-2"><div class="info-item-1">第一章 介绍 传统货币的防止双花，必须在一个中心化（centralized）的清算所（clearing house）里清算。比特币则用全局选举的机制达到共识，来清算双花问题。本质上来讲，就是把一个固定的中心化的清算过程，用选举的方式转化为无数个去中心化的局部清算过程。这就弥补了在比特币之前出现的数字货币的缺点。 clearing 在比特币网络里就被称作 mining 。 钱包是保存地址和管理密钥的地方。不要害怕公开自己的钱包地址。 全节点可以获取全部的交易信息，也因此可以验证交易，发出交易。硬件钱包是运转在专有硬件上的节点（树莓派？），冷钱包就是纸一类的东西。离线钱包是非常安全的。 第二章 比特币原理 比特币最多可以分割到一亿分之一的大小。 Transaction就像是复式记账法账簿上的行，即每行都有输入和输出。 简单来说，每一笔交易包含一个或多个“输入”，输入是针对一个比特币账号的提款（而不是债务）。 这笔交易的另一面，有一个或多个“输出”，被当成信用点数记入到比特币账户中。这些输入和输出的总额（负债和信用）不需要相等。相反，当输出累加略少于输入量时，两者的差额就代表了一笔隐含...</div></div></div></a><a class="pagination-related" href="/2017/10/27/Hyperledger-Fabric-%E7%BD%91%E7%BB%9C%E7%9A%84%E5%90%AF%E5%8A%A8%E6%AD%A5%E9%AA%A4/" title="Hyperledger Fabric 网络的启动步骤"><img class="cover" src="/img/wall-paper-55.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-10-27</div><div class="info-item-2">Hyperledger Fabric 网络的启动步骤</div></div><div class="info-2"><div class="info-item-1">  本文是截至日前（2017.10.27）时对官方教程和自我实验的重新梳理。   Hyperledger Fabric 可以说是 Hyperledger 的拳头项目。虽然同为  Apache 的顶级项目，但大部分其他项目都以 Fabric 为基础。它是顶级项目中的顶级项目，可以认为是0级项目。   docker 要有高于 17.06.2-ce 的版本。docker-compose 要有 1.14.0 及以上的版本。当然当前的高版本的 docker 已经自带了高版本的 docker-compose，这通常不用担心。   安装1.9+ 的 Golang。应该预期这样的结果：    echo $GOPATH   /Users/xxx/go   如果这个结果出不来，考虑当前 Shell 的环境变量没有正确设置：   export GOPATH=$HOME/go   export PATH=$PATH:$GOPATH/bin   要用一个很特别的 nodejs 版本。6.9以上，却不能用8.x。npm 也有特别的版本要求：   npm install npm@3.10.10 -g   要用...</div></div></div></a><a class="pagination-related" href="/2017/10/27/%E6%80%9D%E8%80%83%E5%8C%BA%E5%9D%97%E9%93%BE/" title="思考区块链"><img class="cover" src="/img/wall-paper-122.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-10-27</div><div class="info-item-2">思考区块链</div></div><div class="info-2"><div class="info-item-1"> 区块链是比特币的基础设施。由区块组成链，是为区块链。各个区块链的持有者之间，总是在玩不确定选主的游戏，所以这和所有传统的分布式数据库不同，是一个去中心的数据存储模式。 比特币的区块链是1.0的玩法，以太坊是2.0的玩法。有些人认为 Hyperledger 是3.0的玩法，还有待怀疑。 区块链上的资产，可以是自带的（比特币网络里的比特币，以太坊网络里的以太币），也可以是智能合约定义和约束的。 智能合约是个看起来很美好，实际上只能执行在沙盒里面的东西。曾经在某个IBM程序员的分享里看到过，Hyperledger 的智能合约本质上也是 GO 程序，所以理论上可以做一切事情。但目前没有看到除了调用各种 Shim API 以外的任何用处。比如，如果我们想要用智能合约发出另外一个调用请求，让真实的系统发生转账，如何做到？ 很多人都有热思考，人类再也回不到没有比特币的时代了。也有冷思考，区块链的时代还未到来。就目前而言，现在的计算性能真的不足以支撑真实的行业流量，只能养养鸡，运运肉。 也有观点认为，公有链是真命题，而私有链是伪命题。就目前的观察看来，不管是 Hyperledger 还是 Co...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/rei.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">magicliang</div><div class="author-info-description">关于技术以及人生</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">338</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">197</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/magicliang"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/magicliang" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:magicliang@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">人生只是，守株待兔</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/13/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式事务"><img src="/2025/09/13/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/3pc.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式事务"/></a><div class="content"><a class="title" href="/2025/09/13/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式事务">分布式事务</a><time datetime="2025-09-13T15:06:11.000Z" title="Created 2025-09-13 23:06:11">2025-09-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/13/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/" title="系统设计"><img src="/img/wall-paper-48.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="系统设计"/></a><div class="content"><a class="title" href="/2025/09/13/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/" title="系统设计">系统设计</a><time datetime="2025-09-13T08:07:11.000Z" title="Created 2025-09-13 16:07:11">2025-09-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/04/%E3%80%8A%E7%BC%96%E7%A8%8B%E4%B9%8B%E7%BE%8E%E3%80%8B/" title="《编程之美》"><img src="/img/wall-paper-23.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="《编程之美》"/></a><div class="content"><a class="title" href="/2025/08/04/%E3%80%8A%E7%BC%96%E7%A8%8B%E4%B9%8B%E7%BE%8E%E3%80%8B/" title="《编程之美》">《编程之美》</a><time datetime="2025-08-04T07:53:32.000Z" title="Created 2025-08-04 15:53:32">2025-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/01/Grokking-the-System-Design/" title="Grokking the System Design"><img src="/img/wall-paper-20.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Grokking the System Design"/></a><div class="content"><a class="title" href="/2025/08/01/Grokking-the-System-Design/" title="Grokking the System Design">Grokking the System Design</a><time datetime="2025-08-01T04:14:07.000Z" title="Created 2025-08-01 12:14:07">2025-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/29/%E6%88%91%E4%B8%8E-AI-%E7%9A%84%E9%97%AE%E7%AD%94/" title="我与 AI 的问答"><img src="/img/wall-paper-113.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="我与 AI 的问答"/></a><div class="content"><a class="title" href="/2025/07/29/%E6%88%91%E4%B8%8E-AI-%E7%9A%84%E9%97%AE%E7%AD%94/" title="我与 AI 的问答">我与 AI 的问答</a><time datetime="2025-07-29T07:05:34.000Z" title="Created 2025-07-29 15:05:34">2025-07-29</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2017 - 2025 By magicliang</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">簡</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>