<!DOCTYPE html>

<html lang="zh-Hans">
    <head>
    <meta charset="utf-8">
    <!--
        hexo-theme-suka © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
    -->

    <!-- ### Resource Hint ### -->

    <!-- ## DNS Prefetch ## -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->







<!-- analytics -->







    <!-- ## Preload ## -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="renderer" content="webkit">

    <!-- Title -->
    <title>CoffeeScript2 简明教程 | 守株阁</title>

    <!-- Favicons -->
    <link rel="icon" type="image&#x2F;ico" href="/img/suka-favicon.ico">

    <!-- ### Import File ### -->
    <link rel="stylesheet" href="/lib/spectre/spectre.min.css"><style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style><link rel="stylesheet" href="/css/style.min.css">








    <!-- Prettify Theme -->
    
    <link rel="preload" href="/css/highlight/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/css/highlight/github.min.css"></noscript>





<script>
/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
</script>

    <!-- ### Site Verification ### -->
    


    <link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="守株阁"><meta name="msapplication-starturl" content="http://magicliang.github.io"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="守株阁"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="CoffeeScript2 简明教程 | 守株阁"><meta property="og:site_name" content="守株阁"><meta property="og:type" content="article"><meta property="og:url" content="http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"><meta property="og:locale" content="zh-Hans"><meta name="description" content="写在前面的话&amp;emsp;&amp;emsp;之前在工作群里看到一个排行榜:  &amp;emsp;&amp;emsp;在羡慕美国同行的薪水超高的同时，也奇怪为何 CoffeeScript 的生命力超过了自己之前的想象。 &amp;emsp;&amp;emsp;JavaScript 本是 Brendan Eich 在10天内做完的急就章之作，在设计之初，即带有大量的大意设计和缺陷。可以说，即使到了 1.5 时代，JavaScript 作为 - magicliang - 守株阁"><meta name="keywords" content="CoffeeScript"><meta property="og:image" content="https://ws1.sinaimg.cn/large/66dd581fly1fmf6zwaftnj20iw0iqmz7.jpg"><meta property="article:published_time" content="2017-12-29T11:50:37.000Z"><meta property="article:modified_time" content="2019-09-09T13:35:42.000Z"><meta property="og:updated_time" content="2019-09-09T13:35:42.000Z"><meta property="article:author" content="magicliang"><meta property="article:tag" content="CoffeeScript"><meta name="twitter:card" content="summary">

    

    <!-- ### Canonical link ### -->
    <link rel="canonical" href="http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/">

    <meta name="generator" content="Hexo 6.0.0">

    <!-- ### Analytics ### -->
    







    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/",
    "@type": "BlogPosting",
    "logo": "http://magicliang.github.io/img/suka-favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/"
    },
    "headline": "CoffeeScript2 简明教程 | 守株阁",
    
    "image": {
        "@type": "ImageObject",
        "url": "http://magicliang.github.io/img/suka-favicon.ico"
    },
    
    "datePublished": "2017-12-29T11:50:37.000Z",
    "dateModified": "2019-09-09T13:35:42.000Z",
    "author": {
        "@type": "Person",
        "name": "magicliang",
        "image": {
            "@type": "ImageObject",
            "url": "http://magicliang.github.io/img/default_avatar.png"
        },
        "description": "Hi, nice to meet you."
    },
    "publisher": {
        "@type": "Organization",
        "name": "守株阁",
        "logo": {
            "@type": "ImageObject",
            "url": "http://magicliang.github.io/img/suka-favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "http://magicliang.github.io/search?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "CoffeeScript",
    "description": "写在前面的话&amp;amp;emsp;&amp;amp;emsp;之前在工作群里看到一个排行榜:  &amp;amp;emsp;&amp;amp;emsp;在羡慕美国同行的薪水超高的同时，也奇怪为何 CoffeeScript 的生命力超过了自己之前的想象。 &amp;amp;emsp;&amp;amp;emsp;JavaScript 本是 Brendan Eich 在10天内做完的急就章之作，在设计之初，即带有大量的大意设计和缺陷。可以说，即使到了 1.5 时代，JavaScript 作为 - magicliang - 守株阁"
}
</script>



    <!-- ### Custom Head ### -->
    
</head>

    <body>
            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/">守株阁</a></h1>

    <p class="text-center header-slogan">
        
            
                Hi, nice to meet you.
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/" class="navbar-link">Home</a>
    
    
        <a href="/archives/" class="navbar-link">Archives</a>
    
    
        <a href="/search" class="navbar-link">Search</a>
    
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">Share</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=守株阁&url=http://magicliang.github.io&pic=http://magicliang.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=守株阁&url=http://magicliang.github.io&via=magicliang" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://magicliang.github.io&title=CoffeeScript2 简明教程" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=守株阁&title=CoffeeScript2 简明教程&summary=关于技术以及人生&pics=http://magicliang.github.io/img/suka-favicon.ico&url=http://magicliang.github.io" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=http://magicliang.github.io&text=CoffeeScript2 简明教程" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAAAAAAYplnuAAACnElEQVR42u3c227CMBBFUf7/p9vXisZz9rEjJJSdF1RByTKSmYtHvH6+8HqJFi1a9APRr+H6+5r3166eW97w7bmr94kO0aIhOt2EYFaPV9CrBSKHaNEF+v3NVhvsavPQm08fRHKIFn0nmmyoKQClBYgW/Wn0lNysFrNCpg0uWvRd6CkRmm7YJEArzO1ZnujHo6eC8pOPt1Xjoh+Njk2/YTGnxcGUVB11TUU/Gj1thAZEkvqmsLh8jWjRAJ2ah7SRTgLTFERW7ydadIueNl8qcknASBsxQUWL3kGvNiRNpFIwaQrgCS5aNEGnIDAdvtMkKi0gNSdFiz5FtzcgwyekWIiH/qJFb6DJ4WcaZkmJDylqq40oWvSiCJiaM2QRpDHTHiCJFr2DJg0aunlIsKGFhGjRO+imGKDNcrqQ1HhEh5+iRS/QzWAVTfqbQyA0yCJaNECPSXcxSNJsXvol8O/DFC0aoHGjZAgA7UFp03wXLfoEnZoxJBilZiMZBkAJk2jREH0ylEICSFPooq6paNGwWUMa7mnhJCFqCgrRoim6PfSkw4Bk86VAJVr0DpriyVAgaT7SIlm06DvQZCh2+rs9sE9Nn5gwiRYdEiY6HJWSrHYhR0WAaNHD4efUMKSN9iaIkP8RLbpBk8ZhakTShk1KnuIwgWjRZbNmN7FJGzQNCeAgJ1p0gSY3npKkdoAroVGWJ1p0QKeAQxqFTROTfgGIFt2g00U3UDMYsHPoL1o0RdNmeAI2DZ32YEm06Badkh46CEgXMw0HbCdMokVvHhTtHMrT5CwmaaJF34zeOSidBqpIQDreiKJFv/IPlEwHSaRwpcWtaNEnaDrwSpInmgyRD0m06B10M/RKAwJtzKeAI1p0i/6mS7Ro0aIfhP4Ft1qbWcEXVLcAAAAASUVORK5CYII=" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
</nav>
</header>

            
    <!-- ## Post ## -->
    <div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">CoffeeScript2 简明教程</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/img/default_avatar.png" src="/img/suka-lazyload.gif" alt="magicliang's Avatar">
        <span>2017-12-29</span>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">Share the post</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=CoffeeScript2 简明教程&url=http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/&pic=http://magicliang.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=CoffeeScript2 简明教程&url=http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/&via=magicliang" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/&title=守株阁" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=守株阁&title=守株阁&summary=关于技术以及人生&pics=http://magicliang.github.io/img/suka-favicon.ico&url=http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=http://magicliang.github.io/2017/12/29/CoffeeScript2-%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/&text=守株阁" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAAAAAAYplnuAAACnElEQVR42u3c227CMBBFUf7/p9vXisZz9rEjJJSdF1RByTKSmYtHvH6+8HqJFi1a9APRr+H6+5r3166eW97w7bmr94kO0aIhOt2EYFaPV9CrBSKHaNEF+v3NVhvsavPQm08fRHKIFn0nmmyoKQClBYgW/Wn0lNysFrNCpg0uWvRd6CkRmm7YJEArzO1ZnujHo6eC8pOPt1Xjoh+Njk2/YTGnxcGUVB11TUU/Gj1thAZEkvqmsLh8jWjRAJ2ah7SRTgLTFERW7ydadIueNl8qcknASBsxQUWL3kGvNiRNpFIwaQrgCS5aNEGnIDAdvtMkKi0gNSdFiz5FtzcgwyekWIiH/qJFb6DJ4WcaZkmJDylqq40oWvSiCJiaM2QRpDHTHiCJFr2DJg0aunlIsKGFhGjRO+imGKDNcrqQ1HhEh5+iRS/QzWAVTfqbQyA0yCJaNECPSXcxSNJsXvol8O/DFC0aoHGjZAgA7UFp03wXLfoEnZoxJBilZiMZBkAJk2jREH0ylEICSFPooq6paNGwWUMa7mnhJCFqCgrRoim6PfSkw4Bk86VAJVr0DpriyVAgaT7SIlm06DvQZCh2+rs9sE9Nn5gwiRYdEiY6HJWSrHYhR0WAaNHD4efUMKSN9iaIkP8RLbpBk8ZhakTShk1KnuIwgWjRZbNmN7FJGzQNCeAgJ1p0gSY3npKkdoAroVGWJ1p0QKeAQxqFTROTfgGIFt2g00U3UDMYsHPoL1o0RdNmeAI2DZ32YEm06Badkh46CEgXMw0HbCdMokVvHhTtHMrT5CwmaaJF34zeOSidBqpIQDreiKJFv/IPlEwHSaRwpcWtaNEnaDrwSpInmgyRD0m06B10M/RKAwJtzKeAI1p0i/6mS7Ro0aIfhP4Ft1qbWcEXVLcAAAAASUVORK5CYII=" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                        
                            <div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E8%AF%9D"><span class="post-toc-number">1.</span> <span class="post-toc-text">写在前面的话</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B"><span class="post-toc-number">2.</span> <span class="post-toc-text">简明教程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CoffeeScript-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">CoffeeScript 是什么？</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AE%89%E8%A3%85%E5%92%8C%E8%AF%95%E7%94%A8-coffee"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">安装和试用 coffee</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%99%AE%E9%80%9A%E5%87%BD%E6%95%B0"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">普通函数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">字符串</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E7%BB%84"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">对象和数组</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">注释</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%8F%98%E9%87%8F%E5%AE%89%E5%85%A8"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">词法作用域和变量安全</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#If-Else-Unless-%E4%B8%8E%E6%9D%A1%E4%BB%B6%E8%B5%8B%E5%80%BC"><span class="post-toc-number">2.8.</span> <span class="post-toc-text">If,Else,Unless, 与条件赋值</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%8D%E5%AE%9A%E5%8F%82%E6%95%B0%E8%AF%AD%E6%B3%95"><span class="post-toc-number">2.9.</span> <span class="post-toc-text">不定参数语法</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BE%AA%E7%8E%AF%E5%92%8C%E8%A1%A8%E5%A4%84%E7%90%86"><span class="post-toc-number">2.10.</span> <span class="post-toc-text">循环和表处理</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%95%B0%E7%BB%84%E5%88%86%E7%89%87%E5%92%8C-range-%E5%88%86%E7%89%87"><span class="post-toc-number">2.11.</span> <span class="post-toc-text">数组分片和 range 分片</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%80%E5%88%87%E7%9A%86%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="post-toc-number">2.12.</span> <span class="post-toc-text">一切皆表达式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6%E4%B8%8E%E5%88%AB%E5%90%8D"><span class="post-toc-number">2.13.</span> <span class="post-toc-text">操作符与别名</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%98%E5%9C%A8%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="post-toc-number">2.14.</span> <span class="post-toc-text">存在操作符</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%97%A0%E6%8B%AC%E5%8F%B7%E7%9A%84%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8"><span class="post-toc-number">2.15.</span> <span class="post-toc-text">无括号的链式调用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%A7%A3%E6%9E%84%E8%B5%8B%E5%80%BC"><span class="post-toc-number">2.16.</span> <span class="post-toc-text">解构赋值</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BB%91%E5%AE%9A%EF%BC%88%E8%83%96%EF%BC%89%E5%87%BD%E6%95%B0"><span class="post-toc-number">2.17.</span> <span class="post-toc-text">绑定（胖）函数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%87%BD%E6%95%B0"><span class="post-toc-number">2.18.</span> <span class="post-toc-text">生成器函数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BC%82%E6%AD%A5%E5%87%BD%E6%95%B0"><span class="post-toc-number">2.19.</span> <span class="post-toc-text">异步函数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB"><span class="post-toc-number">2.20.</span> <span class="post-toc-text">类</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8E%9F%E5%9E%8B%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="post-toc-number">2.21.</span> <span class="post-toc-text">原型式继承</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Switch-When-Else"><span class="post-toc-number">2.22.</span> <span class="post-toc-text">Switch&#x2F;When&#x2F;Else</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Try-Catch-Finally"><span class="post-toc-number">2.23.</span> <span class="post-toc-text">Try&#x2F;Catch&#x2F;Finally</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%93%BE%E5%BC%8F%E6%AF%94%E8%BE%83"><span class="post-toc-number">2.24.</span> <span class="post-toc-text">链式比较</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%9D%97%E7%8A%B6%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="post-toc-number">2.25.</span> <span class="post-toc-text">块状的正则表达式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A0%87%E7%AD%BE%E5%8C%96%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="post-toc-number">2.26.</span> <span class="post-toc-text">标签化的模板字面量</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A8%A1%E5%9D%97"><span class="post-toc-number">2.27.</span> <span class="post-toc-text">模块</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B5%8C%E5%85%A5%E5%BC%8F-JavaScript"><span class="post-toc-number">2.28.</span> <span class="post-toc-text">嵌入式 JavaScript</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#JSX"><span class="post-toc-number">2.29.</span> <span class="post-toc-text">JSX</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3"><span class="post-toc-number">2.30.</span> <span class="post-toc-text">类型注解</span></a></li></ol></li></ol></div>
                        
                    
                    <article id="post-content">
                        <h1 id="写在前面的话"><a href="#写在前面的话" class="headerlink" title="写在前面的话"></a>写在前面的话</h1><p>&emsp;&emsp;之前在工作群里看到一个排行榜:</p>
<p><img src="https://ws1.sinaimg.cn/large/66dd581fly1fmf6zwaftnj20iw0iqmz7.jpg"></p>
<p>&emsp;&emsp;在羡慕美国同行的薪水超高的同时，也奇怪为何 CoffeeScript 的生命力超过了自己之前的想象。</p>
<p>&emsp;&emsp;JavaScript 本是 Brendan Eich 在10天内做完的急就章之作，在设计之初，即带有大量的大意设计和缺陷。可以说，即使到了 1.5 时代，JavaScript 作为一门现代语言，依然要提防 Douglas Crockford 在《JavaScript:The Good Parts》中提出的种种陷阱。历年来，各路框架作者和超集语言作者，都不断在 JavaScript 上做出各种各样炫目的模式用法和衍生方言，足见其可提高空间之大。包括 CoffeeScript/TypeScript/Dart/Elm 等解决方案的出现，其实就是在倡导使用 Pre-JavaScript 的语言编写抽象逻辑，然后编译成原生 JavaScript 运行。</p>
<p>&emsp;&emsp;CoffeeScript 即是 JavaScript 1.5 时代的 Pre-JavaScript 语言中的佼佼者。其设计的语法和句法利用了 Ruby 和 Python 的优点，然而又能去除 JavaScript 中容易产生二义性的部分，可以认为是一种变换写法的 JavaScript 语言子集，也就是美化过的“The Good Parts”。CoffeeScript 的定位，本来是一门 little language，它的目的不是取代 JavaScript，而是用更好的风格来编写 JavaScript，因此其最终目标也是编译成 JavaScript。因此，很多人都把它当做下一代 JavaScript 标准出现以前的过渡用法。</p>
<p>&emsp;&emsp;2015年以来，ES6.0以及后来的 ES2015等标准的制定以及现代浏览器对原生语法支持的逐步实现，使得大部分众望所归的语言特性都可以在原生 JavaScript 中找到。旧的 CoffeeScript(CoffeeScript 1) 编译的结果已然不兼容新的ES2015的发展方向，CoffeeScript 作为一个过渡时期的产物，似乎已然完成了它的历史使命。</p>
<p>&emsp;&emsp;但 CoffeeScript 的发展并没有停止。CofffeeScript 紧随现代 JavaScript 推出了 CoffeeScript 2。这一版本的 CoffeeScript 不仅保留了大部分上一版本 Ruby/Python 风格的优美语法，也大量兼容了 ES2015 的新特性（除了 import/export 这个在前后端实行起来经常需要转义和 polyfill 的特性以外），成为了一门更加现代的 little langugage。</p>
<p>&emsp;&emsp;可能有读者会问，既然已经有了 ES2015，为什么还要再来一门编程语言呢？笔者认为，不同的编程语言，其实是不同的思考和设计工具。虽说图灵完备的语言总是等价的，但通过另一个角度来对问题和解建模，可以更有效地提高自己对原本掌握的语言的理解。因此，了解 CoffeeScript 的设计和使用理念，一定能对使用原生 JavaScript 编程有所脾益。</p>
<p>&emsp;&emsp;本文基本上是 coffeescript.org 在2.0版本后文档的摘译和简化。每一个小的知识点会配上若干的代码块，两个相连的代码块总是代表一段 CoffeeScript 代码和它编译生成的 JavaScript 代码。阅读本文需要一定的 JavaScript 基础。</p>
<h1 id="简明教程"><a href="#简明教程" class="headerlink" title="简明教程"></a>简明教程</h1><h2 id="CoffeeScript-是什么？"><a href="#CoffeeScript-是什么？" class="headerlink" title="CoffeeScript 是什么？"></a>CoffeeScript 是什么？</h2><p><strong>CoffeeScript 是一门编译成 Javascript 的小语言。</strong>在 Java 风格的笨拙锈色之下，JavaScript 有着一颗华丽的心。CoffeeScript 试图用简明的方式，把 JavaScript 中的精粹部分表现出来。</p>
<p>CoffeeScript 的黄金法则是：“它只是 JavaScript”。代码会被一对一地编译成对等的 JS，不会有运行时解释。可以在 CoffeeScript 中无缝地使用任何现存的 JavaScript 库（反之亦然）。编译输出是可读，美化打印过的，而且趋向于和等价的手写 JavaScript 跑得一样快。</p>
<h2 id="安装和试用-coffee"><a href="#安装和试用-coffee" class="headerlink" title="安装和试用 coffee"></a>安装和试用 coffee</h2><p>最新版本：2.1.0</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为一个项目局部安装:</span></span><br><span class="line">npm install --save-dev coffeescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局安装以在任意处执行.coffee 文件:</span></span><br><span class="line">npm install --global coffeescript</span><br></pre></td></tr></table></figure>

<p>假设我们有一个 test.coffee 的文件如下：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Assignment:</span></span><br><span class="line">number   = <span class="number">42</span></span><br><span class="line">opposite = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Conditions:</span></span><br><span class="line">number = <span class="number">-42</span> <span class="keyword">if</span> opposite</span><br><span class="line"></span><br><span class="line"><span class="comment"># Functions:</span></span><br><span class="line"><span class="function"><span class="title">square</span> = <span class="params">(x)</span> -&gt;</span> x * x</span><br><span class="line"></span><br><span class="line"><span class="comment"># Arrays:</span></span><br><span class="line">list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Objects:</span></span><br><span class="line">math =</span><br><span class="line">  root:   <span class="built_in">Math</span>.sqrt</span><br><span class="line">  square: square</span><br><span class="line">  cube:   <span class="function"><span class="params">(x)</span> -&gt;</span> x * square x</span><br><span class="line"></span><br><span class="line"><span class="comment"># Splats:</span></span><br><span class="line"><span class="function"><span class="title">race</span> = <span class="params">(winner, runners...)</span> -&gt;</span></span><br><span class="line">  <span class="built_in">print</span> winner, runners</span><br><span class="line"></span><br><span class="line"><span class="comment"># Existence:</span></span><br><span class="line">alert <span class="string">&quot;I knew it!&quot;</span> <span class="keyword">if</span> elvis?</span><br><span class="line"></span><br><span class="line"><span class="comment"># Array comprehensions:</span></span><br><span class="line">cubes = (math.cube num <span class="keyword">for</span> num <span class="keyword">in</span> list)</span><br></pre></td></tr></table></figure>

<p>运行<code>coffee -c test.coffee</code>就会得到一个test.js 文件如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Generated by CoffeeScript 2.1.0</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Assignment:</span></span><br><span class="line">  <span class="keyword">var</span> cubes, list, math, num, number, opposite, race, square;</span><br><span class="line"></span><br><span class="line">  number = <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line">  opposite = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (opposite) &#123;</span><br><span class="line">    <span class="comment">// Conditions:</span></span><br><span class="line">    number = -<span class="number">42</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Functions:</span></span><br><span class="line">  square = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Arrays:</span></span><br><span class="line">  list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Objects:</span></span><br><span class="line">  math = &#123;</span><br><span class="line">    <span class="attr">root</span>: <span class="built_in">Math</span>.sqrt,</span><br><span class="line">    <span class="attr">square</span>: square,</span><br><span class="line">    <span class="attr">cube</span>: <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> x * square(x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Splats:</span></span><br><span class="line">  race = <span class="function"><span class="keyword">function</span>(<span class="params">winner, ...runners</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> print(winner, runners);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> elvis !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; elvis !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// Existence:</span></span><br><span class="line">    alert(<span class="string">&quot;I knew it!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Array comprehensions:</span></span><br><span class="line">  cubes = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i, len, results;</span><br><span class="line">    results = [];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>, len = list.length; i &lt; len; i++) &#123;</span><br><span class="line">      num = list[i];</span><br><span class="line">      results.push(math.cube(num));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><br><span class="line">&#125;).call(<span class="built_in">this</span>);</span><br></pre></td></tr></table></figure>

<p>缺省的 coffee 编译结果为了最大限度地保证不污染顶层的变量，总是会把文件编译成一个立即执行的函数，使得所有变量的声明和使用局限在一个小作用域里面。当然，它也有个 bare 模式可以去掉这种立即执行函数，如果使用<code>import</code>和<code>export</code> 的功能，也可以自动进入 bare 模式。这个模式的细节很繁琐，请读者自行查阅文档。</p>
<h2 id="普通函数"><a href="#普通函数" class="headerlink" title="普通函数"></a>普通函数</h2><figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">square</span> = <span class="params">(x)</span> -&gt;</span> x * x</span><br><span class="line"><span class="function"><span class="title">cube</span>   = <span class="params">(x)</span> -&gt;</span> square(x) * x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 带有默认值的函数参数</span></span><br><span class="line"><span class="function"><span class="title">fill</span> = <span class="params">(container, liquid = <span class="string">&quot;coffee&quot;</span>)</span> -&gt;</span></span><br><span class="line">  <span class="string">&quot;Filling the <span class="subst">#&#123;container&#125;</span> with <span class="subst">#&#123;liquid&#125;</span>...&quot;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 空函数</span></span><br><span class="line"><span class="function"><span class="title">a</span> = -&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cube, square;</span><br><span class="line"></span><br><span class="line">square = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">cube = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> square(x) * x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fill;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 带有默认值的函数参数</span></span><br><span class="line">fill = <span class="function"><span class="keyword">function</span>(<span class="params">container, liquid = <span class="string">&quot;coffee&quot;</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`Filling the <span class="subst">$&#123;container&#125;</span> with <span class="subst">$&#123;liquid&#125;</span>...`</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 空函数</span></span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line"></span><br><span class="line">  a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>使用<code>-&gt;</code>生成 function 函数。带默认值的参数，同样是 ES2015 的内容。</p>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">author = <span class="string">&quot;Wittgenstein&quot;</span></span><br><span class="line">quote  = <span class="string">&quot;A picture is a fact. -- <span class="subst">#&#123; author &#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">sentence = <span class="string">&quot;<span class="subst">#&#123; <span class="number">22</span> / <span class="number">7</span> &#125;</span> is a decent approximation of π&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> author, quote, sentence;</span><br><span class="line"></span><br><span class="line">author = <span class="string">&quot;Wittgenstein&quot;</span>;</span><br><span class="line"></span><br><span class="line">quote = <span class="string">`A picture is a fact. -- <span class="subst">$&#123;author&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">sentence = <span class="string">`<span class="subst">$&#123;<span class="number">22</span> / <span class="number">7</span>&#125;</span> is a decent approximation of π`</span>;</span><br></pre></td></tr></table></figure>

<p>CoffeeScript 的字符串同 JavaScript 一样，可以用<code>&quot;</code>和<code>&#39;</code>分界。用”引用的字符串，可以用<code>#&#123;&#125;</code> 来进行内插（甚至可以在对象的key 里执行内插）。用’引用的字符串是字面量。</p>
<p>双引号的多行字符串可以自动被编译器连接起来，当然，所有的缩进都失效了：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mobyDick = <span class="string">&quot;Call me Ishmael. Some years ago --</span></span><br><span class="line"><span class="string">  never mind how long precisely -- having little</span></span><br><span class="line"><span class="string">  or no money in my purse, and nothing particular</span></span><br><span class="line"><span class="string">  to interest me on shore, I thought I would sail</span></span><br><span class="line"><span class="string">  about a little and see the watery part of the</span></span><br><span class="line"><span class="string">  world...&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mobyDick;</span><br><span class="line"></span><br><span class="line">mobyDick = <span class="string">&quot;Call me Ishmael. Some years ago -- never mind how long precisely -- having little or no money in my purse, and nothing particular to interest me on shore, I thought I would sail about a little and see the watery part of the world...&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>使用三引号<code>&quot;&quot;&quot;</code>和三个单引号<code>&#39;&#39;&#39;</code>，还可以生成保留格式（特别是缩进）的<strong>块</strong>字符串：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">html = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">       &lt;strong&gt;</span></span><br><span class="line"><span class="string">         cup of coffeescript</span></span><br><span class="line"><span class="string">       &lt;/strong&gt;</span></span><br><span class="line"><span class="string">       &quot;&quot;&quot;</span></span><br><span class="line">       </span><br><span class="line">html = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">       &lt;strong&gt;</span></span><br><span class="line"><span class="string">         cup of coffeescript</span></span><br><span class="line"><span class="string">       &lt;/strong&gt;</span></span><br><span class="line"><span class="string">       &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> html;</span><br><span class="line"></span><br><span class="line">html = <span class="string">&quot;&lt;strong&gt;\n  cup of coffeescript\n&lt;/strong&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> html;</span><br><span class="line"></span><br><span class="line">html = <span class="string">&#x27;&lt;strong&gt;\n  cup of coffeescript\n&lt;/strong&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>用双引号制造出来的块字符串，也一样支持字符串内插功能。</p>
<h2 id="对象和数组"><a href="#对象和数组" class="headerlink" title="对象和数组"></a>对象和数组</h2><p>CoffeeScript 支持 JavaScript 格式的对象和数组字面量，也支持更简明的无逗号的、依靠换行的字面量：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">song = [<span class="string">&quot;do&quot;</span>, <span class="string">&quot;re&quot;</span>, <span class="string">&quot;mi&quot;</span>, <span class="string">&quot;fa&quot;</span>, <span class="string">&quot;so&quot;</span>]</span><br><span class="line"></span><br><span class="line">singers = &#123;Jagger: <span class="string">&quot;Rock&quot;</span>, Elvis: <span class="string">&quot;Roll&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用换行来代替分隔符</span></span><br><span class="line">bitlist = [</span><br><span class="line">  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">  <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">  <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类 YAML 格式，用换行来代替分隔符</span></span><br><span class="line">kids =</span><br><span class="line">  brother:</span><br><span class="line">    name: <span class="string">&quot;Max&quot;</span></span><br><span class="line">    age:  <span class="number">11</span></span><br><span class="line">  sister:</span><br><span class="line">    name: <span class="string">&quot;Ida&quot;</span></span><br><span class="line">    age:  <span class="number">9</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bitlist, kids, singers, song;</span><br><span class="line"></span><br><span class="line">song = [<span class="string">&quot;do&quot;</span>, <span class="string">&quot;re&quot;</span>, <span class="string">&quot;mi&quot;</span>, <span class="string">&quot;fa&quot;</span>, <span class="string">&quot;so&quot;</span>];</span><br><span class="line"></span><br><span class="line">singers = &#123;</span><br><span class="line">  <span class="attr">Jagger</span>: <span class="string">&quot;Rock&quot;</span>,</span><br><span class="line">  <span class="attr">Elvis</span>: <span class="string">&quot;Roll&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">bitlist = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">kids = &#123;</span><br><span class="line">  <span class="attr">brother</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Max&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">11</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">sister</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Ida&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">9</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>CoffeeScript 也支持 ES2015的字面量语法：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;Michelangelo&quot;</span></span><br><span class="line">mask = <span class="string">&quot;orange&quot;</span></span><br><span class="line">weapon = <span class="string">&quot;nunchuks&quot;</span></span><br><span class="line">turtle = &#123;name, mask, weapon&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mask, name, output, turtle, weapon;</span><br><span class="line"></span><br><span class="line">name = <span class="string">&quot;Michelangelo&quot;</span>;</span><br><span class="line"></span><br><span class="line">mask = <span class="string">&quot;orange&quot;</span>;</span><br><span class="line"></span><br><span class="line">weapon = <span class="string">&quot;nunchuks&quot;</span>;</span><br><span class="line"></span><br><span class="line">turtle = &#123;name, mask, weapon&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><p>聪明的读者可能已经发现了注释应该怎么写，但这里还是要总结下。CoffeeScript 里的注释其实是脚本语言的注释的应用：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="comment">Fortune Cookie Reader v1.0</span></span><br><span class="line"><span class="comment">Released under the MIT License</span></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">sayFortune</span> = <span class="params">(fortune)</span> -&gt;</span></span><br><span class="line">  <span class="built_in">console</span>.log fortune <span class="comment"># in bed!</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Fortune Cookie Reader v1.0</span></span><br><span class="line"><span class="comment">Released under the MIT License</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> sayFortune;</span><br><span class="line"></span><br><span class="line">sayFortune = <span class="function"><span class="keyword">function</span>(<span class="params">fortune</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">console</span>.log(fortune); <span class="comment">// in bed!</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>值得注意的是，<code>###</code>支持了类型注解。</p>
<h2 id="词法作用域和变量安全"><a href="#词法作用域和变量安全" class="headerlink" title="词法作用域和变量安全"></a>词法作用域和变量安全</h2><p>聪明的读者可能也发现了，在 CoffeeScript 中，是不需要手写<code>var</code>这样的关键字的。实际上，ES2015为了解决过去的 JavaScript 中不存在块级作用域这样的问题，专门提出的<code>const</code>和<code>let</code>解决方案，CoffeeScript 也不支持。在有多层变量的时候，CoffeeScript <strong>会自动地推导变量的作用域</strong>，保证内层的变量绝不会污染任何外层变量。每个变量的实际作用域，会被限制在它首次被声明的地方。JavaScript 无意之中忘加<code>var</code>关键字而污染全局变量的情况便不复存在了。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">outer = <span class="number">1</span></span><br><span class="line"><span class="function"><span class="title">changeNumbers</span> = -&gt;</span></span><br><span class="line">  inner = <span class="number">-1</span></span><br><span class="line">  outer = <span class="number">10</span></span><br><span class="line">inner = changeNumbers()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> changeNumbers, inner, outer;</span><br><span class="line"></span><br><span class="line">outer = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">changeNumbers = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> inner;</span><br><span class="line">  inner = -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> outer = <span class="number">10</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">inner = changeNumbers();</span><br></pre></td></tr></table></figure>

<p><code>outer</code> 因为在外部作用域里已经声明过了，所以不需要重复声明。而<code>inner</code>只是在内部作用域里被使用，所以还额外声明了一个函数内的 <code>inner</code>来专门隔离它的作用域。外部专门声明的<code>var inner</code>其实就是一个编译器为了谨慎做的声明顶部上推，在这个编译的例子里不影响任何语义。</p>
<p>因为无法使用<code>var</code>关键字，所以实际上我们是无法遮蔽（shadow）住外部变量的，只能在内部作用域引用外部变量。</p>
<h2 id="If-Else-Unless-与条件赋值"><a href="#If-Else-Unless-与条件赋值" class="headerlink" title="If,Else,Unless, 与条件赋值"></a>If,Else,Unless, 与条件赋值</h2><p>if/else 里可以不用写小括号和大括号，使用 python 式的缩进定界，用户也可以使用单行 if 和 unless。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mood = greatlyImproved <span class="keyword">if</span> singing</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> happy <span class="keyword">and</span> knowsIt</span><br><span class="line">  <span class="comment"># 用缩进来确定这一段代码是在条件块里的</span></span><br><span class="line">  clapsHands()</span><br><span class="line">  chaChaCha()</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  showIt()</span><br><span class="line"></span><br><span class="line">date = <span class="keyword">if</span> friday <span class="keyword">then</span> sue <span class="keyword">else</span> jill</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> date, mood;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (singing) &#123;</span><br><span class="line">  mood = greatlyImproved;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (happy &amp;&amp; knowsIt) &#123;</span><br><span class="line">  clapsHands();</span><br><span class="line">  chaChaCha();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  showIt();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">date = friday ? sue : jill;</span><br></pre></td></tr></table></figure>

<h2 id="不定参数语法"><a href="#不定参数语法" class="headerlink" title="不定参数语法"></a>不定参数语法</h2><p>Java 程序员里面可能都习惯了类似 … 语法的不定参数语法来了。在 CoffeeScript 中它被称为 Splats 参数。ES2015吸收了这一语法，做出了 rest 参数。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">gold = silver = rest = <span class="string">&quot;unknown&quot;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">awardMedals</span> = <span class="params">(first, second, others...)</span> -&gt;</span></span><br><span class="line">  gold   = first</span><br><span class="line">  silver = second</span><br><span class="line">  rest   = others</span><br><span class="line"></span><br><span class="line">contenders = [</span><br><span class="line">  <span class="string">&quot;Michael Phelps&quot;</span></span><br><span class="line">  <span class="string">&quot;Liu Xiang&quot;</span></span><br><span class="line">  <span class="string">&quot;Yao Ming&quot;</span></span><br><span class="line">  <span class="string">&quot;Allyson Felix&quot;</span></span><br><span class="line">  <span class="string">&quot;Shawn Johnson&quot;</span></span><br><span class="line">  <span class="string">&quot;Roman Sebrle&quot;</span></span><br><span class="line">  <span class="string">&quot;Guo Jingjing&quot;</span></span><br><span class="line">  <span class="string">&quot;Tyson Gay&quot;</span></span><br><span class="line">  <span class="string">&quot;Asafa Powell&quot;</span></span><br><span class="line">  <span class="string">&quot;Usain Bolt&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">awardMedals contenders...</span><br><span class="line"></span><br><span class="line">alert <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Gold: <span class="subst">#&#123;gold&#125;</span></span></span><br><span class="line"><span class="string">Silver: <span class="subst">#&#123;silver&#125;</span></span></span><br><span class="line"><span class="string">The Field: <span class="subst">#&#123;rest.join <span class="string">&#x27;, &#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 特殊的数组省略语法</span></span><br><span class="line">popular  = [<span class="string">&#x27;pepperoni&#x27;</span>, <span class="string">&#x27;sausage&#x27;</span>, <span class="string">&#x27;cheese&#x27;</span>]</span><br><span class="line">unwanted = [<span class="string">&#x27;anchovies&#x27;</span>, <span class="string">&#x27;olives&#x27;</span>]</span><br><span class="line"></span><br><span class="line">all = [popular..., unwanted..., <span class="string">&#x27;mushrooms&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对象属性语法</span></span><br><span class="line"></span><br><span class="line">user =</span><br><span class="line">  name: <span class="string">&#x27;Werner Heisenberg&#x27;</span></span><br><span class="line">  occupation: <span class="string">&#x27;theoretical physicist&#x27;</span></span><br><span class="line"></span><br><span class="line">currentUser = &#123; user..., status: <span class="string">&#x27;Uncertain&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> awardMedals, contenders, gold, rest, silver;</span><br><span class="line"></span><br><span class="line">gold = silver = rest = <span class="string">&quot;unknown&quot;</span>;</span><br><span class="line"></span><br><span class="line">awardMedals = <span class="function"><span class="keyword">function</span>(<span class="params">first, second, ...others</span>) </span>&#123;</span><br><span class="line">  gold = first;</span><br><span class="line">  silver = second;</span><br><span class="line">  <span class="keyword">return</span> rest = others;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">contenders = [<span class="string">&quot;Michael Phelps&quot;</span>, <span class="string">&quot;Liu Xiang&quot;</span>, <span class="string">&quot;Yao Ming&quot;</span>, <span class="string">&quot;Allyson Felix&quot;</span>, <span class="string">&quot;Shawn Johnson&quot;</span>, <span class="string">&quot;Roman Sebrle&quot;</span>, <span class="string">&quot;Guo Jingjing&quot;</span>, <span class="string">&quot;Tyson Gay&quot;</span>, <span class="string">&quot;Asafa Powell&quot;</span>, <span class="string">&quot;Usain Bolt&quot;</span>];</span><br><span class="line"></span><br><span class="line">awardMedals(...contenders);</span><br><span class="line"></span><br><span class="line">alert(<span class="string">`Gold: <span class="subst">$&#123;gold&#125;</span>\nSilver: <span class="subst">$&#123;silver&#125;</span>\nThe Field: <span class="subst">$&#123;rest.join(<span class="string">&#x27;, &#x27;</span>)&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"># 特殊的数组省略语法</span><br><span class="line"><span class="keyword">var</span> all, popular, unwanted;</span><br><span class="line"></span><br><span class="line">popular = [<span class="string">&#x27;pepperoni&#x27;</span>, <span class="string">&#x27;sausage&#x27;</span>, <span class="string">&#x27;cheese&#x27;</span>];</span><br><span class="line"></span><br><span class="line">unwanted = [<span class="string">&#x27;anchovies&#x27;</span>, <span class="string">&#x27;olives&#x27;</span>];</span><br><span class="line"></span><br><span class="line">all = [...popular, ...unwanted, <span class="string">&#x27;mushrooms&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 特殊的对象属性语法</span></span><br><span class="line"><span class="keyword">var</span> currentUser, user,</span><br><span class="line">  _extends = <span class="built_in">Object</span>.assign || <span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123; <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123; <span class="keyword">var</span> source = <span class="built_in">arguments</span>[i]; <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> source) &#123; <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(source, key)) &#123; target[key] = source[key]; &#125; &#125; &#125; <span class="keyword">return</span> target; &#125;;</span><br><span class="line"></span><br><span class="line">user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Werner Heisenberg&#x27;</span>,</span><br><span class="line">  <span class="attr">occupation</span>: <span class="string">&#x27;theoretical physicist&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">currentUser = _extends(&#123;&#125;, user, &#123;</span><br><span class="line">  <span class="attr">status</span>: <span class="string">&#x27;Uncertain&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="循环和表处理"><a href="#循环和表处理" class="headerlink" title="循环和表处理"></a>循环和表处理</h2><p>CoffeeScript 的 for 循环可以处理数组、对象和 range，有点类似 Python。而且，它的 for 循环是有返回值的。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Eat lunch.</span></span><br><span class="line"><span class="function"><span class="title">eat</span> = <span class="params">(food)</span> -&gt;</span> <span class="string">&quot;<span class="subst">#&#123;food&#125;</span> eaten.&quot;</span></span><br><span class="line">eat food <span class="keyword">for</span> food <span class="keyword">in</span> [<span class="string">&#x27;toast&#x27;</span>, <span class="string">&#x27;cheese&#x27;</span>, <span class="string">&#x27;wine&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fine five course dining.</span></span><br><span class="line">courses = [<span class="string">&#x27;greens&#x27;</span>, <span class="string">&#x27;caviar&#x27;</span>, <span class="string">&#x27;truffles&#x27;</span>, <span class="string">&#x27;roast&#x27;</span>, <span class="string">&#x27;cake&#x27;</span>]</span><br><span class="line"><span class="function"><span class="title">menu</span> = <span class="params">(i, dish)</span> -&gt;</span> <span class="string">&quot;Menu Item <span class="subst">#&#123;i&#125;</span>: <span class="subst">#&#123;dish&#125;</span>&quot;</span> </span><br><span class="line">menu i + <span class="number">1</span>, dish <span class="keyword">for</span> dish, i <span class="keyword">in</span> courses</span><br><span class="line"></span><br><span class="line"><span class="comment"># Health conscious meal.</span></span><br><span class="line">foods = [<span class="string">&#x27;broccoli&#x27;</span>, <span class="string">&#x27;spinach&#x27;</span>, <span class="string">&#x27;chocolate&#x27;</span>]</span><br><span class="line">eat food <span class="keyword">for</span> food <span class="keyword">in</span> foods <span class="keyword">when</span> food <span class="keyword">isnt</span> <span class="string">&#x27;chocolate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个使用返回值的例子</span></span><br><span class="line">countdown = (num <span class="keyword">for</span> num <span class="keyword">in</span> [<span class="number">10.</span><span class="number">.1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历对象的例子</span></span><br><span class="line">yearsOld = max: <span class="number">10</span>, ida: <span class="number">9</span>, tim: <span class="number">11</span></span><br><span class="line"></span><br><span class="line">ages = <span class="keyword">for</span> child, age <span class="keyword">of</span> yearsOld</span><br><span class="line">  <span class="string">&quot;<span class="subst">#&#123;child&#125;</span> is <span class="subst">#&#123;age&#125;</span>&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Eat lunch.</span></span><br><span class="line"><span class="keyword">var</span> courses, dish, eat, food, foods, i, j, k, l, len, len1, len2, menu, ref;</span><br><span class="line"></span><br><span class="line">eat = <span class="function"><span class="keyword">function</span>(<span class="params">food</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;food&#125;</span> eaten.`</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ref = [<span class="string">&#x27;toast&#x27;</span>, <span class="string">&#x27;cheese&#x27;</span>, <span class="string">&#x27;wine&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>, len = ref.length; j &lt; len; j++) &#123;</span><br><span class="line">  food = ref[j];</span><br><span class="line">  eat(food);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fine five course dining.</span></span><br><span class="line">courses = [<span class="string">&#x27;greens&#x27;</span>, <span class="string">&#x27;caviar&#x27;</span>, <span class="string">&#x27;truffles&#x27;</span>, <span class="string">&#x27;roast&#x27;</span>, <span class="string">&#x27;cake&#x27;</span>];</span><br><span class="line"></span><br><span class="line">menu = <span class="function"><span class="keyword">function</span>(<span class="params">i, dish</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`Menu Item <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;dish&#125;</span>`</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = k = <span class="number">0</span>, len1 = courses.length; k &lt; len1; i = ++k) &#123;</span><br><span class="line">  dish = courses[i];</span><br><span class="line">  menu(i + <span class="number">1</span>, dish);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Health conscious meal.</span></span><br><span class="line">foods = [<span class="string">&#x27;broccoli&#x27;</span>, <span class="string">&#x27;spinach&#x27;</span>, <span class="string">&#x27;chocolate&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (l = <span class="number">0</span>, len2 = foods.length; l &lt; len2; l++) &#123;</span><br><span class="line">  food = foods[l];</span><br><span class="line">  <span class="keyword">if</span> (food !== <span class="string">&#x27;chocolate&#x27;</span>) &#123;</span><br><span class="line">    eat(food);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回值的例子转化为 Javascript 变得如此之长，可以看到 CoffeeScript 的精炼</span></span><br><span class="line"><span class="keyword">var</span> countdown, num;</span><br><span class="line"></span><br><span class="line">countdown = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i, results;</span><br><span class="line">  results = [];</span><br><span class="line">  <span class="keyword">for</span> (num = i = <span class="number">10</span>; i &gt;= <span class="number">1</span>; num = --i) &#123;</span><br><span class="line">    results.push(num);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历对象的例子</span></span><br><span class="line"><span class="keyword">var</span> age, ages, child, yearsOld;</span><br><span class="line"></span><br><span class="line">yearsOld = &#123;</span><br><span class="line">  <span class="attr">max</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">ida</span>: <span class="number">9</span>,</span><br><span class="line">  <span class="attr">tim</span>: <span class="number">11</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ages = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> results;</span><br><span class="line">  results = [];</span><br><span class="line">  <span class="keyword">for</span> (child <span class="keyword">in</span> yearsOld) &#123;</span><br><span class="line">    age = yearsOld[child];</span><br><span class="line">    results.push(<span class="string">`<span class="subst">$&#123;child&#125;</span> is <span class="subst">$&#123;age&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>特别地，CoffeScript 提供一个低级的 while 循环，它同样是带有返回值的。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Econ 101</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">this</span>.studyingEconomics</span><br><span class="line">  buy()  <span class="keyword">while</span> supply &gt; demand</span><br><span class="line">  sell() <span class="keyword">until</span> supply &gt; demand</span><br><span class="line"></span><br><span class="line"><span class="comment"># Nursery Rhyme</span></span><br><span class="line">num = <span class="number">6</span></span><br><span class="line">lyrics = <span class="keyword">while</span> num -= <span class="number">1</span></span><br><span class="line">  <span class="string">&quot;<span class="subst">#&#123;num&#125;</span> little monkeys, jumping on the bed.</span></span><br><span class="line"><span class="string">    One fell out and bumped his head.&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Econ 101</span></span><br><span class="line"><span class="keyword">var</span> lyrics, num;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.studyingEconomics) &#123;</span><br><span class="line">  <span class="keyword">while</span> (supply &gt; demand) &#123;</span><br><span class="line">    buy();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (!(supply &gt; demand)) &#123;</span><br><span class="line">    sell();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Nursery Rhyme</span></span><br><span class="line">num = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">lyrics = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> results;</span><br><span class="line">  results = [];</span><br><span class="line">  <span class="keyword">while</span> (num -= <span class="number">1</span>) &#123;</span><br><span class="line">    results.push(<span class="string">`<span class="subst">$&#123;num&#125;</span> little monkeys, jumping on the bed. One fell out and bumped his head.`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>JavaScript 老手可能会很习惯匿名函数立即执行的用法，CoffeeScript 用 do 关键字支持把循环和匿名函数立即执行结合起来：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> list</span><br><span class="line">  <span class="keyword">do</span> (filename) -&gt;</span><br><span class="line">    <span class="keyword">if</span> filename <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&#x27;.DS_Store&#x27;</span>, <span class="string">&#x27;Thumbs.db&#x27;</span>, <span class="string">&#x27;ehthumbs.db&#x27;</span>]</span><br><span class="line">      fs.readFile filename, <span class="function"><span class="params">(err, contents)</span> -&gt;</span></span><br><span class="line">        compile filename, contents.toString()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> filename, fn, i, len;</span><br><span class="line"></span><br><span class="line">fn = <span class="function"><span class="keyword">function</span>(<span class="params">filename</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (filename !== <span class="string">&#x27;.DS_Store&#x27;</span> &amp;&amp; filename !== <span class="string">&#x27;Thumbs.db&#x27;</span> &amp;&amp; filename !== <span class="string">&#x27;ehthumbs.db&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fs.readFile(filename, <span class="function"><span class="keyword">function</span>(<span class="params">err, contents</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> compile(filename, contents.toString());</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>, len = list.length; i &lt; len; i++) &#123;</span><br><span class="line">  filename = list[i];</span><br><span class="line">  fn(filename);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="数组分片和-range-分片"><a href="#数组分片和-range-分片" class="headerlink" title="数组分片和 range 分片"></a>数组分片和 range 分片</h2><p>CoffeeScript 同样以索引操作符的形式（类 Python 和 C++）支持对数组的 slicing。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">start   = numbers[<span class="number">0.</span><span class="number">.2</span>]</span><br><span class="line"></span><br><span class="line">middle  = numbers[<span class="number">3.</span>..<span class="number">-2</span>]</span><br><span class="line"></span><br><span class="line">end     = numbers[<span class="number">-2.</span>.]</span><br><span class="line"></span><br><span class="line">copy    = numbers[..]</span><br><span class="line"></span><br><span class="line">numbers = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">numbers[<span class="number">3.</span><span class="number">.6</span>] = [<span class="number">-3</span>, <span class="number">-4</span>, <span class="number">-5</span>, <span class="number">-6</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> copy, end, middle, numbers, start;</span><br><span class="line"></span><br><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line"></span><br><span class="line">start = numbers.slice(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">middle = numbers.slice(<span class="number">3</span>, -<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">end = numbers.slice(-<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">copy = numbers.slice(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> numbers, ref,</span><br><span class="line">  splice = [].splice;</span><br><span class="line"></span><br><span class="line">numbers = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line"></span><br><span class="line">splice.apply(numbers, [<span class="number">3</span>, <span class="number">4</span>].concat(ref = [-<span class="number">3</span>, -<span class="number">4</span>, -<span class="number">5</span>, -<span class="number">6</span>])), ref;</span><br></pre></td></tr></table></figure>

<h2 id="一切皆表达式"><a href="#一切皆表达式" class="headerlink" title="一切皆表达式"></a>一切皆表达式</h2><p>表达式特别于普通语句的地方，就是它们总是可以求值的。<br>诸位读者可能已经注意到，CoffeeScript 中几乎没有 return。在函数中，最后一行表达式，就是整个块的表达式返回值，这点也是 CoffeeScript 从 Ruby 那里吸收来的特性。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">grade</span> = <span class="params">(student)</span> -&gt;</span></span><br><span class="line">  <span class="keyword">if</span> student.excellentWork</span><br><span class="line">    <span class="string">&quot;A+&quot;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> student.okayStuff</span><br><span class="line">    <span class="keyword">if</span> student.triedHard <span class="keyword">then</span> <span class="string">&quot;B&quot;</span> <span class="keyword">else</span> <span class="string">&quot;B-&quot;</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="string">&quot;C&quot;</span></span><br><span class="line"></span><br><span class="line">eldest = <span class="keyword">if</span> <span class="number">24</span> &gt; <span class="number">21</span> <span class="keyword">then</span> <span class="string">&quot;Liz&quot;</span> <span class="keyword">else</span> <span class="string">&quot;Ike&quot;</span></span><br><span class="line"></span><br><span class="line">six = (one = <span class="number">1</span>) + (two = <span class="number">2</span>) + (three = <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The first ten global properties.</span></span><br><span class="line"></span><br><span class="line">globals = (name <span class="keyword">for</span> name <span class="keyword">of</span> <span class="built_in">window</span>)[<span class="number">0.</span>.<span class="number">.10</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> eldest, grade;</span><br><span class="line"></span><br><span class="line">grade = <span class="function"><span class="keyword">function</span>(<span class="params">student</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (student.excellentWork) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;A+&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (student.okayStuff) &#123;</span><br><span class="line">    <span class="keyword">if</span> (student.triedHard) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;B&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;B-&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;C&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">eldest = <span class="number">24</span> &gt; <span class="number">21</span> ? <span class="string">&quot;Liz&quot;</span> : <span class="string">&quot;Ike&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> one, six, three, two;</span><br><span class="line"></span><br><span class="line">six = (one = <span class="number">1</span>) + (two = <span class="number">2</span>) + (three = <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// The first ten global properties.</span></span><br><span class="line"><span class="keyword">var</span> globals, name;</span><br><span class="line"></span><br><span class="line">globals = ((<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> results;</span><br><span class="line">  results = [];</span><br><span class="line">  <span class="keyword">for</span> (name <span class="keyword">in</span> <span class="built_in">window</span>) &#123;</span><br><span class="line">    results.push(name);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;)()).slice(<span class="number">0</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<p>比较有意思的是，try/catch 也是可以有返回值的：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">alert(</span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">    nonexistent / <span class="literal">undefined</span></span><br><span class="line">  <span class="keyword">catch</span> error</span><br><span class="line">    <span class="string">&quot;And the error is ... <span class="subst">#&#123;error&#125;</span>&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> error;</span><br><span class="line"></span><br><span class="line">alert((<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> nonexistent / <span class="keyword">void</span> <span class="number">0</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error1) &#123;</span><br><span class="line">    error = error1;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`And the error is ... <span class="subst">$&#123;error&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)());</span><br></pre></td></tr></table></figure>
<p>当然，有些语句在 JavaScript 中也是不能当做表达式的，比如<code>break</code>、<code>continue</code>和<code>return</code>，如果你在代码块中使用了它们，CoffeeScript不会试图进行转换。</p>
<h2 id="操作符与别名"><a href="#操作符与别名" class="headerlink" title="操作符与别名"></a>操作符与别名</h2><p><code>==</code>操作符经常引起出乎意料的、与其他语言中表现不一致的行为。所以 CoffeeScript 里没有<code>==</code>，而会试着进行再编译。把<code>==</code>编译成<code>===</code>，<code>!=</code>编译成<code>!==</code>。另外，它还提供了可读性更好的两个操作符，<code>is</code>会被编译为<code>===</code>，isnt 会被编译为<code>isnt</code>。</p>
<p>除此之外，还可以用<code>not</code>作取反操作符<code>!</code>的别名。</p>
<p>对于逻辑操作符，<code>and</code>会被编译为<code>&amp;&amp;</code>，<code>or</code>会被便以为<code>||</code>。</p>
<p>在 JavaScript 中，有时候条件语句需要另起一行或者在单行内用分号断句，但CoffeeScript 中的 then 就可以帮我们把条件语句（特别是 while、if、switch 的结构中）和被执行语句连起来。</p>
<p>同<code>YAML</code>中一样，<code>on</code>和<code>yes</code>是布尔值<code>true</code>的同义词，<code>off</code>和<code>no</code>是布尔值<code>false</code>的同义词。 </p>
<p>同其他脚本语言一样，<code>unless</code>是<code>if</code>的反写。</p>
<p>同 Ruby 一样，<code>@property</code>可以当做<code>this.property</code>来用（少写一个字符）。</p>
<p>可以用<code>in</code>来做数组元素的存在检查，用<code>of</code>来做 JavaScript 键值对的存在性检查。</p>
<p>在<code>for</code>循环中，<code>from</code>关键字会被编译成 ES2015 的<code>of</code>。</p>
<p>为了简化数学表达式，<code>**</code>代表幂运算，而<code>//</code>执行地板除法（同 Python 一样，去掉小数向下取整）</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-7</span> % <span class="number">5</span> == <span class="number">-2</span> <span class="comment"># The remainder of 7 / 5</span></span><br><span class="line"><span class="number">-7</span> %% <span class="number">5</span> == <span class="number">3</span> <span class="comment"># n %% 5 is always between 0 and 4</span></span><br><span class="line"></span><br><span class="line">tabs.selectTabAtIndex((tabs.currentIndex - count) %% tabs.length)</span><br><span class="line"></span><br><span class="line">launch() <span class="keyword">if</span> ignition <span class="keyword">is</span> <span class="literal">on</span></span><br><span class="line"></span><br><span class="line">volume = <span class="number">10</span> <span class="keyword">if</span> band <span class="keyword">isnt</span> SpinalTap</span><br><span class="line"></span><br><span class="line">letTheWildRumpusBegin() <span class="keyword">unless</span> answer <span class="keyword">is</span> <span class="literal">no</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> car.speed &lt; limit <span class="keyword">then</span> accelerate()</span><br><span class="line"></span><br><span class="line">winner = <span class="literal">yes</span> <span class="keyword">if</span> pick <span class="keyword">in</span> [<span class="number">47</span>, <span class="number">92</span>, <span class="number">13</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> inspect <span class="string">&quot;My name is <span class="subst">#&#123;@name&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> modulo = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123; <span class="keyword">return</span> (+a % (b = +b) + b) % b; &#125;;</span><br><span class="line"></span><br><span class="line">-<span class="number">7</span> % <span class="number">5</span> === -<span class="number">2</span>; <span class="comment">// The remainder of 7 / 5</span></span><br><span class="line"></span><br><span class="line">modulo(-<span class="number">7</span>, <span class="number">5</span>) === <span class="number">3</span>; <span class="comment">// n %% 5 is always between 0 and 4</span></span><br><span class="line"></span><br><span class="line">tabs.selectTabAtIndex(modulo(tabs.currentIndex - count, tabs.length));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> volume, winner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ignition === <span class="literal">true</span>) &#123;</span><br><span class="line">  launch();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (band !== SpinalTap) &#123;</span><br><span class="line">  volume = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (answer !== <span class="literal">false</span>) &#123;</span><br><span class="line">  letTheWildRumpusBegin();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (car.speed &lt; limit) &#123;</span><br><span class="line">  accelerate();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (pick === <span class="number">47</span> || pick === <span class="number">92</span> || pick === <span class="number">13</span>) &#123;</span><br><span class="line">  winner = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print(inspect(<span class="string">`My name is <span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span>`</span>));</span><br></pre></td></tr></table></figure>
<h2 id="存在操作符"><a href="#存在操作符" class="headerlink" title="存在操作符"></a>存在操作符</h2><p>在 JavaScript 中确认一个变量是否存在是很困难的。因为<code>if (variable)</code> 不仅会在变量不存在时生效，在变量为0值（0,空字符串，false）时也会生效。CoffeeScript 的<code>?</code>操作符只在变量为<code>null</code>和 <code>undefined</code>的时候返回<code>false</code>，这很像 Ruby 中的 <code>nil？</code>(实际上高版本的 ES 也会有一个叫 <code>Null Propagation Operator</code>的类似特性)。</p>
<p>这样我们就可以做更加安全的条件赋值了（比<code>a = a || value</code>安全）。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">solipsism = <span class="literal">true</span> <span class="keyword">if</span> mind? <span class="keyword">and</span> <span class="keyword">not</span> world?</span><br><span class="line"></span><br><span class="line">speed = <span class="number">0</span></span><br><span class="line">speed ?= <span class="number">15</span></span><br><span class="line"></span><br><span class="line">footprints = yeti ? <span class="string">&quot;bear&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> footprints, solipsism, speed;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">typeof</span> mind !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; mind !== <span class="literal">null</span>) &amp;&amp; (<span class="keyword">typeof</span> world === <span class="string">&quot;undefined&quot;</span> || world === <span class="literal">null</span>)) &#123;</span><br><span class="line">  solipsism = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">speed = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (speed == <span class="literal">null</span>) &#123;</span><br><span class="line">  speed = <span class="number">15</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意看，一个<code>?</code>被翻译成了对<code>undefined</code>和<code>null</code>的严格求不等<code>!==</code><br>。但是，<code>?</code>与<code>unless</code>搭配的时候，就会被翻译成<code>==</code>。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">major = <span class="string">&#x27;Computer Science&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unless</span> major?</span><br><span class="line">  signUpForClass <span class="string">&#x27;Introduction to Wines&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> major;</span><br><span class="line"></span><br><span class="line">major = <span class="string">&#x27;Computer Science&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (major == <span class="literal">null</span>) &#123;</span><br><span class="line">  signUpForClass(<span class="string">&#x27;Introduction to Wines&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以用存在操作符来达到其他语言中经常出现的流利调用，流利调用失败用户会得到<code>undefined</code>而不会出现烦人的空指针（在 JavaScript 中实际上是不能在<code>undefined</code>上调用特定成员的<code>TypeError</code>）异常：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip = lottery.drawWinner?().address?.zipcode</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ref, zip;</span><br><span class="line"></span><br><span class="line">zip = <span class="keyword">typeof</span> lottery.drawWinner === <span class="string">&quot;function&quot;</span> ? (ref = lottery.drawWinner().address) != <span class="literal">null</span> ? ref.zipcode : <span class="keyword">void</span> <span class="number">0</span> : <span class="keyword">void</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h2 id="无括号的链式调用"><a href="#无括号的链式调用" class="headerlink" title="无括号的链式调用"></a>无括号的链式调用</h2><p>用<code>.</code>和断行缩进可以像其他脚本语言一样进行无括号链式调用：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="string">&#x27;body&#x27;</span></span><br><span class="line">.click (e) -&gt;</span><br><span class="line">  $ <span class="string">&#x27;.box&#x27;</span></span><br><span class="line">  .fadeIn <span class="string">&#x27;fast&#x27;</span></span><br><span class="line">  .addClass <span class="string">&#x27;show&#x27;</span></span><br><span class="line">.css <span class="string">&#x27;background&#x27;</span>, <span class="string">&#x27;white&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;body&#x27;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> $(<span class="string">&#x27;.box&#x27;</span>).fadeIn(<span class="string">&#x27;fast&#x27;</span>).addClass(<span class="string">&#x27;show&#x27;</span>);</span><br><span class="line">&#125;).css(<span class="string">&#x27;background&#x27;</span>, <span class="string">&#x27;white&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h2><p>用过 ES2015 以后版本的读者应该能够理解什么是解构赋值了：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">theBait   = <span class="number">1000</span></span><br><span class="line">theSwitch = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">[theBait, theSwitch] = [theSwitch, theBait]</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> theBait, theSwitch;</span><br><span class="line"></span><br><span class="line">theBait = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">theSwitch = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">[theBait, theSwitch] = [theSwitch, theBait];</span><br></pre></td></tr></table></figure>

<p>解构赋值搭配上多返回值的函数调用也很有用：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">weatherReport</span> = <span class="params">(location)</span> -&gt;</span></span><br><span class="line">  <span class="comment"># Make an Ajax request to fetch the weather...</span></span><br><span class="line">  [location, <span class="number">72</span>, <span class="string">&quot;Mostly Sunny&quot;</span>]</span><br><span class="line"></span><br><span class="line">[city, temp, forecast] = weatherReport <span class="string">&quot;Berkeley, CA&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> city, forecast, temp, weatherReport;</span><br><span class="line"></span><br><span class="line">weatherReport = <span class="function"><span class="keyword">function</span>(<span class="params">location</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Make an Ajax request to fetch the weather...</span></span><br><span class="line">  <span class="keyword">return</span> [location, <span class="number">72</span>, <span class="string">&quot;Mostly Sunny&quot;</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[city, temp, forecast] = weatherReport(<span class="string">&quot;Berkeley, CA&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>解构赋值对任意深度嵌套的数组和对象也是一个有用的特性：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">futurists =</span><br><span class="line">  sculptor: <span class="string">&quot;Umberto Boccioni&quot;</span></span><br><span class="line">  painter:  <span class="string">&quot;Vladimir Burliuk&quot;</span></span><br><span class="line">  poet:</span><br><span class="line">    name:   <span class="string">&quot;F.T. Marinetti&quot;</span></span><br><span class="line">    address: [</span><br><span class="line">      <span class="string">&quot;Via Roma 42R&quot;</span></span><br><span class="line">      <span class="string">&quot;Bellagio, Italy 22021&quot;</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">&#123;sculptor&#125; = futurists</span><br><span class="line"></span><br><span class="line">&#123;poet: &#123;name, address: [street, city]&#125;&#125; = futurists</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> city, futurists, name, sculptor, street;</span><br><span class="line"></span><br><span class="line">futurists = &#123;</span><br><span class="line">  <span class="attr">sculptor</span>: <span class="string">&quot;Umberto Boccioni&quot;</span>,</span><br><span class="line">  <span class="attr">painter</span>: <span class="string">&quot;Vladimir Burliuk&quot;</span>,</span><br><span class="line">  <span class="attr">poet</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;F.T. Marinetti&quot;</span>,</span><br><span class="line">    <span class="attr">address</span>: [<span class="string">&quot;Via Roma 42R&quot;</span>, <span class="string">&quot;Bellagio, Italy 22021&quot;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">(&#123;sculptor&#125; = futurists);</span><br><span class="line"></span><br><span class="line">(&#123;</span><br><span class="line">  <span class="attr">poet</span>: &#123;</span><br><span class="line">    name,</span><br><span class="line">    <span class="attr">address</span>: [street, city]</span><br><span class="line">  &#125;</span><br><span class="line">&#125; = futurists);</span><br></pre></td></tr></table></figure>

<p>解构赋值也可以搭配 splats 不定参数使用：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tag = <span class="string">&quot;&lt;impossible&gt;&quot;</span></span><br><span class="line"></span><br><span class="line">[open, contents..., close] = tag.split(<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> close, contents, i, open, ref, tag,</span><br><span class="line">  slice = [].slice;</span><br><span class="line"></span><br><span class="line">tag = <span class="string">&quot;&lt;impossible&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">ref = tag.split(<span class="string">&quot;&quot;</span>), open = ref[<span class="number">0</span>], contents = <span class="number">3</span> &lt;= ref.length ? slice.call(ref, <span class="number">1</span>, i = ref.length - <span class="number">1</span>) : (i = <span class="number">1</span>, []), close = ref[i++];</span><br></pre></td></tr></table></figure>

<p>取数组末尾元素的例子：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">&quot;Every literary critic believes he will</span></span><br><span class="line"><span class="string">        outwit history and have the last word&quot;</span></span><br><span class="line"></span><br><span class="line">[first, ..., last] = text.split <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> first, last, ref, text;</span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;Every literary critic believes he will outwit history and have the last word&quot;</span>;</span><br><span class="line"></span><br><span class="line">ref = text.split(<span class="string">&quot; &quot;</span>), first = ref[<span class="number">0</span>], last = ref[ref.length - <span class="number">1</span>];</span><br></pre></td></tr></table></figure>

<p>与构造函数结合的例子：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line">  constructor: <span class="function"><span class="params">(options)</span> -&gt;</span></span><br><span class="line">    &#123;@name, @age, @height = <span class="string">&#x27;average&#x27;</span>&#125; = options</span><br><span class="line"></span><br><span class="line">tim = <span class="keyword">new</span> Person name: <span class="string">&#x27;Tim&#x27;</span>, age: <span class="number">4</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Person, tim;</span><br><span class="line"></span><br><span class="line">Person = <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">options</span>)</span> &#123;</span><br><span class="line">    (&#123;<span class="attr">name</span>: <span class="built_in">this</span>.name, <span class="attr">age</span>: <span class="built_in">this</span>.age, <span class="attr">height</span>: <span class="built_in">this</span>.height = <span class="string">&#x27;average&#x27;</span>&#125; = options);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">tim = <span class="keyword">new</span> Person(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Tim&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">4</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="绑定（胖）函数"><a href="#绑定（胖）函数" class="headerlink" title="绑定（胖）函数"></a>绑定（胖）函数</h2><p>用<code>-&gt;</code>定义的函数会直接转化为普通的<code>function</code>。</p>
<p>JavaScript 中<code>this</code>指向的值可以被动态绑定（这真是由来已久的弊病）。有经验的读者肯定能理解，我们在传递回调的时候， 原始<code>this</code>经常会丢失，变成新作用域里的<code>this</code>。</p>
<p>而使用胖箭头<code>=&gt;</code>定义的函数，可以把当前上下文的<code>this</code>绑定到函数里（好像调用了一个隐式的<code>bind</code>一样）。当我们在 Prototype 和 JQuery 之类的毁掉库里使用函数时，这回变得非常有用。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">Account</span> = <span class="params">(customer, cart)</span> -&gt;</span></span><br><span class="line">  @customer = customer</span><br><span class="line">  @cart = cart</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 如果我们这里使用-&gt;箭头，就会编译出 function，function 的 this 是不绑定在当前的 this 上的。</span></span><br><span class="line">  $(<span class="string">&#x27;.shopping_cart&#x27;</span>).<span class="literal">on</span> <span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="params">(event)</span> =&gt;</span></span><br><span class="line">    <span class="comment"># 此处的@customer和外部的@customer一致。</span></span><br><span class="line">    @customer.purchase @cart</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Account;</span><br><span class="line"></span><br><span class="line">Account = <span class="function"><span class="keyword">function</span>(<span class="params">customer, cart</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.customer = customer;</span><br><span class="line">  <span class="built_in">this</span>.cart = cart;</span><br><span class="line">  <span class="comment">// JavaScript 中的=&gt;实际上使 this 进入外部上下文的了词法作用域</span></span><br><span class="line">  <span class="keyword">return</span> $(<span class="string">&#x27;.shopping_cart&#x27;</span>).on(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.customer.purchase(<span class="built_in">this</span>.cart);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>如果我们在这里使用<code>-&gt;</code>，函数里的<code>@customer</code>实际上就会指向undefined。因为$(‘.shopping_cart’) 这个东西指向的是 dom 变量，很可能没有<code>customer</code>这个属性。</p>
<p>胖函数是 CoffeeScript 里最受欢迎的特性，也被 ES2015 吸收了，使用 CoffeeScript 中的<code>=&gt;</code>就会被编译成JavaScript 中的<code>=&gt;</code>。</p>
<h2 id="生成器函数"><a href="#生成器函数" class="headerlink" title="生成器函数"></a>生成器函数</h2><p>CoffeeScript 通过<code>yield</code>关键字支持 ES2015中的<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*">generator functions</a>。CoffeeScript 中没有<code>function*()&#123;&#125;</code>这样的无意义结构，只要有<code>yield</code>就够了。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">perfectSquares</span> = -&gt;</span></span><br><span class="line">  num = <span class="number">0</span></span><br><span class="line">  <span class="keyword">loop</span></span><br><span class="line">    num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">yield</span> num * num</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.ps <span class="keyword">or</span>= perfectSquares()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> perfectSquares;</span><br><span class="line"></span><br><span class="line">perfectSquares = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> num;</span><br><span class="line">  num = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    num += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> num * num;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>yield</code>当然也可以配合<code>for...from</code>使用：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">fibonacci</span> = -&gt;</span></span><br><span class="line">  [previous, current] = [<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">  <span class="keyword">loop</span></span><br><span class="line">    [previous, current] = [current, previous + current]</span><br><span class="line">    <span class="keyword">yield</span> current</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">getFibonacciNumbers</span> = <span class="params">(length)</span> -&gt;</span></span><br><span class="line">  results = [<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">for</span> n <span class="keyword">from</span> fibonacci()</span><br><span class="line">    results.push n</span><br><span class="line">    <span class="keyword">break</span> <span class="keyword">if</span> results.length <span class="keyword">is</span> length</span><br><span class="line">  results</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fibonacci, getFibonacciNumbers;</span><br><span class="line"></span><br><span class="line">fibonacci = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> current, previous;</span><br><span class="line">  [previous, current] = [<span class="number">1</span>, <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    [previous, current] = [current, previous + current];</span><br><span class="line">    <span class="keyword">yield</span> current;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">getFibonacciNumbers = <span class="function"><span class="keyword">function</span>(<span class="params">length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> n, ref, results;</span><br><span class="line">  results = [<span class="number">1</span>];</span><br><span class="line">  ref = fibonacci();</span><br><span class="line">  <span class="keyword">for</span> (n <span class="keyword">of</span> ref) &#123;</span><br><span class="line">    results.push(n);</span><br><span class="line">    <span class="keyword">if</span> (results.length === length) &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="异步函数"><a href="#异步函数" class="headerlink" title="异步函数"></a>异步函数</h2><p>ES2017 的<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">异步函数</a>是通过<code>await</code>支持的。同生成器函数一样，CoffeeScript 中的不需要<code>async</code>关键字，只要有<code>await</code>就行了。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Your browser must support async/await and speech synthesis</span></span><br><span class="line"><span class="comment"># to run this example.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">sleep</span> = <span class="params">(ms)</span> -&gt;</span></span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span> (resolve) -&gt;</span><br><span class="line">    <span class="built_in">window</span>.<span class="built_in">setTimeout</span> resolve, ms</span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">say</span> = <span class="params">(text)</span> -&gt;</span></span><br><span class="line">  <span class="built_in">window</span>.speechSynthesis.cancel()</span><br><span class="line">  <span class="built_in">window</span>.speechSynthesis.speak <span class="keyword">new</span> SpeechSynthesisUtterance text</span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">countdown</span> = <span class="params">(seconds)</span> -&gt;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> [seconds.<span class="number">.1</span>]</span><br><span class="line">    say i</span><br><span class="line">    <span class="keyword">await</span> sleep <span class="number">1000</span> <span class="comment"># wait one second</span></span><br><span class="line">  say <span class="string">&quot;Blastoff!&quot;</span></span><br><span class="line"></span><br><span class="line">countdown <span class="number">3</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Your browser must support async/await and speech synthesis</span></span><br><span class="line"><span class="comment">// to run this example.</span></span><br><span class="line"><span class="keyword">var</span> countdown, say, sleep;</span><br><span class="line"></span><br><span class="line">sleep = <span class="function"><span class="keyword">function</span>(<span class="params">ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.setTimeout(resolve, ms);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">say = <span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.speechSynthesis.cancel();</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">window</span>.speechSynthesis.speak(<span class="keyword">new</span> SpeechSynthesisUtterance(text));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">countdown = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params">seconds</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i, j, ref;</span><br><span class="line">  <span class="keyword">for</span> (i = j = ref = seconds; ref &lt;= <span class="number">1</span> ? j &lt;= <span class="number">1</span> : j &gt;= <span class="number">1</span>; i = ref &lt;= <span class="number">1</span> ? ++j : --j) &#123;</span><br><span class="line">    say(i);</span><br><span class="line">    <span class="keyword">await</span> sleep(<span class="number">1000</span>); <span class="comment">// wait one second</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> say(<span class="string">&quot;Blastoff!&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">countdown(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><p>CoffeeScript 1 就提供了<code>class</code>和<code>extends</code>关键字，作为原型相关函数的语法糖。ES2015吸收了这两个关键字，CoffeeScript 2 直接把这两个关键字编译成 ES2015的类。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span></span><br><span class="line">  constructor: <span class="function"><span class="params">(@name)</span> -&gt;</span></span><br><span class="line"></span><br><span class="line">  move: <span class="function"><span class="params">(meters)</span> -&gt;</span></span><br><span class="line">    alert @name + <span class="string">&quot; moved <span class="subst">#&#123;meters&#125;</span>m.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Snake</span> <span class="keyword">extends</span> <span class="title">Animal</span></span></span><br><span class="line">  move: <span class="function">-&gt;</span></span><br><span class="line">    alert <span class="string">&quot;Slithering...&quot;</span></span><br><span class="line">    <span class="built_in">super</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Horse</span> <span class="keyword">extends</span> <span class="title">Animal</span></span></span><br><span class="line">  move: <span class="function">-&gt;</span></span><br><span class="line">    alert <span class="string">&quot;Galloping...&quot;</span></span><br><span class="line">    <span class="built_in">super</span> <span class="number">45</span></span><br><span class="line"></span><br><span class="line">sam = <span class="keyword">new</span> Snake <span class="string">&quot;Sammy the Python&quot;</span></span><br><span class="line">tom = <span class="keyword">new</span> Horse <span class="string">&quot;Tommy the Palomino&quot;</span></span><br><span class="line"></span><br><span class="line">sam.move()</span><br><span class="line">tom.move()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Animal, Horse, Snake, sam, tom;</span><br><span class="line"></span><br><span class="line">Animal = <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">move</span>(<span class="params">meters</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> alert(<span class="built_in">this</span>.name + <span class="string">` moved <span class="subst">$&#123;meters&#125;</span>m.`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Snake = <span class="class"><span class="keyword">class</span> <span class="title">Snake</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">move</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    alert(<span class="string">&quot;Slithering...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.move(<span class="number">5</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Horse = <span class="class"><span class="keyword">class</span> <span class="title">Horse</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">move</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    alert(<span class="string">&quot;Galloping...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.move(<span class="number">45</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">sam = <span class="keyword">new</span> Snake(<span class="string">&quot;Sammy the Python&quot;</span>);</span><br><span class="line"></span><br><span class="line">tom = <span class="keyword">new</span> Horse(<span class="string">&quot;Tommy the Palomino&quot;</span>);</span><br><span class="line"></span><br><span class="line">sam.move();</span><br><span class="line"></span><br><span class="line">tom.move();</span><br></pre></td></tr></table></figure>

<p>可以用<code>@</code>开头的函数来定义静态方法：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teenager</span></span></span><br><span class="line">  @say: <span class="function"><span class="params">(speech)</span> -&gt;</span></span><br><span class="line">    words = speech.split <span class="string">&#x27; &#x27;</span></span><br><span class="line">    fillers = [<span class="string">&#x27;uh&#x27;</span>, <span class="string">&#x27;um&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="string">&#x27;actually&#x27;</span>, <span class="string">&#x27;so&#x27;</span>, <span class="string">&#x27;maybe&#x27;</span>]</span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">for</span> word, index <span class="keyword">in</span> words</span><br><span class="line">      output.push word</span><br><span class="line">      output.push fillers[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * fillers.length)] <span class="keyword">unless</span> index <span class="keyword">is</span> words.length - <span class="number">1</span></span><br><span class="line">    output.join <span class="string">&#x27;, &#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Teenager;</span><br><span class="line"></span><br><span class="line">Teenager = <span class="class"><span class="keyword">class</span> <span class="title">Teenager</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="title">say</span>(<span class="params">speech</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> fillers, i, index, len, output, word, words;</span><br><span class="line">    words = speech.split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    fillers = [<span class="string">&#x27;uh&#x27;</span>, <span class="string">&#x27;um&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="string">&#x27;actually&#x27;</span>, <span class="string">&#x27;so&#x27;</span>, <span class="string">&#x27;maybe&#x27;</span>];</span><br><span class="line">    output = [];</span><br><span class="line">    <span class="keyword">for</span> (index = i = <span class="number">0</span>, len = words.length; i &lt; len; index = ++i) &#123;</span><br><span class="line">      word = words[index];</span><br><span class="line">      output.push(word);</span><br><span class="line">      <span class="keyword">if</span> (index !== words.length - <span class="number">1</span>) &#123;</span><br><span class="line">        output.push(fillers[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * fillers.length)]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> output.join(<span class="string">&#x27;, &#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="原型式继承"><a href="#原型式继承" class="headerlink" title="原型式继承"></a>原型式继承</h2><p>ES2015提供了一个短路操作符给原型链相关的操作：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String::dasherize = <span class="function">-&gt;</span></span><br><span class="line">  <span class="built_in">this</span>.replace <span class="regexp">/_/g</span>, <span class="string">&quot;-&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.dasherize = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="regexp">/_/g</span>, <span class="string">&quot;-&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="Switch-When-Else"><a href="#Switch-When-Else" class="headerlink" title="Switch/When/Else"></a>Switch/When/Else</h2><p>CoffeeScript 中的<code>switch</code>不用担心忘记写<code>break</code>出现错误的跳转：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> day</span><br><span class="line">  <span class="keyword">when</span> <span class="string">&quot;Mon&quot;</span> <span class="keyword">then</span> go work</span><br><span class="line">  <span class="keyword">when</span> <span class="string">&quot;Tue&quot;</span> <span class="keyword">then</span> go relax</span><br><span class="line">  <span class="keyword">when</span> <span class="string">&quot;Thu&quot;</span> <span class="keyword">then</span> go iceFishing</span><br><span class="line">  <span class="keyword">when</span> <span class="string">&quot;Fri&quot;</span>, <span class="string">&quot;Sat&quot;</span></span><br><span class="line">    <span class="keyword">if</span> day <span class="keyword">is</span> bingoDay</span><br><span class="line">      go bingo</span><br><span class="line">      go dancing</span><br><span class="line">  <span class="keyword">when</span> <span class="string">&quot;Sun&quot;</span> <span class="keyword">then</span> go church</span><br><span class="line">  <span class="keyword">else</span> go work</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (day) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;Mon&quot;</span>:</span><br><span class="line">    go(work);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;Tue&quot;</span>:</span><br><span class="line">    go(relax);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;Thu&quot;</span>:</span><br><span class="line">    go(iceFishing);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;Fri&quot;</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;Sat&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> (day === bingoDay) &#123;</span><br><span class="line">      go(bingo);</span><br><span class="line">      go(dancing);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;Sun&quot;</span>:</span><br><span class="line">    go(church);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    go(work);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在之前读者已经看到了 CoffeeScript 中大量的语句都可以带有返回值，<code>switch</code>也不例外。以下的例子里面，switch 后面连表达式都没有：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">score = <span class="number">76</span></span><br><span class="line">grade = <span class="keyword">switch</span></span><br><span class="line">  <span class="keyword">when</span> score &lt; <span class="number">60</span> <span class="keyword">then</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">  <span class="keyword">when</span> score &lt; <span class="number">70</span> <span class="keyword">then</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line">  <span class="keyword">when</span> score &lt; <span class="number">80</span> <span class="keyword">then</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">  <span class="keyword">when</span> score &lt; <span class="number">90</span> <span class="keyword">then</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line"><span class="comment"># grade == &#x27;C&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> grade, score;</span><br><span class="line"></span><br><span class="line">score = <span class="number">76</span>;</span><br><span class="line"></span><br><span class="line">grade = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> !(score &lt; <span class="number">60</span>):</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;F&#x27;</span>;</span><br><span class="line">    <span class="keyword">case</span> !(score &lt; <span class="number">70</span>):</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">    <span class="keyword">case</span> !(score &lt; <span class="number">80</span>):</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">    <span class="keyword">case</span> !(score &lt; <span class="number">90</span>):</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">// grade == &#x27;C&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Try-Catch-Finally"><a href="#Try-Catch-Finally" class="headerlink" title="Try/Catch/Finally"></a>Try/Catch/Finally</h2><p>CoffeeScript 中的<code>try</code>/<code>catch</code>/<code>finally</code>块可以完全不带大括号：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">  allHellBreaksLoose()</span><br><span class="line">  catsAndDogsLivingTogether()</span><br><span class="line"><span class="keyword">catch</span> error</span><br><span class="line">  <span class="built_in">print</span> error</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">  cleanUp()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> error;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  allHellBreaksLoose();</span><br><span class="line">  catsAndDogsLivingTogether();</span><br><span class="line">&#125; <span class="keyword">catch</span> (error1) &#123;</span><br><span class="line">  error = error1;</span><br><span class="line">  print(error);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  cleanUp();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="链式比较"><a href="#链式比较" class="headerlink" title="链式比较"></a>链式比较</h2><p>CoffeeScript 从 Python 中借来了<a target="_blank" rel="noopener" href="https://docs.python.org/3/reference/expressions.html#not-in">链式比较</a>，这样范围比较的语句就变得更加简单了。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cholesterol = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">healthy = <span class="number">200</span> &gt; cholesterol &gt; <span class="number">60</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cholesterol, healthy;</span><br><span class="line"></span><br><span class="line">cholesterol = <span class="number">127</span>;</span><br><span class="line"></span><br><span class="line">healthy = (<span class="number">200</span> &gt; cholesterol &amp;&amp; cholesterol &gt; <span class="number">60</span>);</span><br></pre></td></tr></table></figure>

<h2 id="块状的正则表达式"><a href="#块状的正则表达式" class="headerlink" title="块状的正则表达式"></a>块状的正则表达式</h2><p>我们已经看到了块状（多行）字符串和注释，CoffeeScript 同样支持块状正则表达式。模仿自 Perl 的<code>/x</code>修饰符，CoffeeScript 使用<code>///</code>来对多行表达式定界，这样多行的正则比单行的正则就更加可读了：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NUMBER     = <span class="regexp">///</span></span><br><span class="line"><span class="regexp">  ^ 0b[01]+    |              <span class="comment"># binary</span></span></span><br><span class="line"><span class="regexp">  ^ 0o[0-7]+   |              <span class="comment"># octal</span></span></span><br><span class="line"><span class="regexp">  ^ 0x[\da-f]+ |              <span class="comment"># hex</span></span></span><br><span class="line"><span class="regexp">  ^ \d*\.?\d+ (?:e[+-]?\d+)?  <span class="comment"># decimal</span></span></span><br><span class="line"><span class="regexp">///</span>i</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> NUMBER;</span><br><span class="line"></span><br><span class="line">NUMBER = <span class="regexp">/^0b[01]+|^0o[0-7]+|^0x[\da-f]+|^\d*\.?\d+(?:e[+-]?\d+)?/i</span>; <span class="comment">// binary</span></span><br><span class="line"><span class="comment">// octal</span></span><br><span class="line"><span class="comment">// hex</span></span><br><span class="line"><span class="comment">// decimal</span></span><br></pre></td></tr></table></figure>

<h2 id="标签化的模板字面量"><a href="#标签化的模板字面量" class="headerlink" title="标签化的模板字面量"></a>标签化的模板字面量</h2><p>CoffeeScript 支持 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#Tagged_template_literals">ES2015中的标签化模板字面量</a>，提供了自定义的字符串内插的能力。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">upperCaseExpr</span> = <span class="params">(textParts, expressions...)</span> -&gt;</span></span><br><span class="line">  textParts.reduce (text, textPart, i) -&gt;</span><br><span class="line">    text + expressions[i - <span class="number">1</span>].toUpperCase() + textPart</span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">greet</span> = <span class="params">(name, adjective)</span> -&gt;</span></span><br><span class="line">  upperCaseExpr<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">               Hi <span class="subst">#&#123;name&#125;</span>. You look <span class="subst">#&#123;adjective&#125;</span>!</span></span><br><span class="line"><span class="string">               &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> greet, upperCaseExpr;</span><br><span class="line"></span><br><span class="line">upperCaseExpr = <span class="function"><span class="keyword">function</span>(<span class="params">textParts, ...expressions</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> textParts.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">text, textPart, i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> text + expressions[i - <span class="number">1</span>].toUpperCase() + textPart;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">greet = <span class="function"><span class="keyword">function</span>(<span class="params">name, adjective</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> upperCaseExpr<span class="string">`Hi <span class="subst">$&#123;name&#125;</span>. You look <span class="subst">$&#123;adjective&#125;</span>!`</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><p>CoffeeScript 中的模块和 ES2015中的模块很相似，都是<code>import</code>和<code>export</code>语法：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;local-file.coffee&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;coffeescript&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> underscore <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; now &#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; now <span class="keyword">as</span> currentTimestamp &#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; first, last &#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line"><span class="keyword">import</span> utilityBelt, &#123; each &#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">Math</span></span><br><span class="line"><span class="keyword">export</span> square = <span class="function"><span class="params">(x)</span> -&gt;</span> x * x</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Mathematics</span></span></span><br><span class="line">  least: <span class="function"><span class="params">(x, y)</span> -&gt;</span> <span class="keyword">if</span> x &lt; y <span class="keyword">then</span> x <span class="keyword">else</span> y</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; sqrt &#125;</span><br><span class="line"><span class="keyword">export</span> &#123; sqrt <span class="keyword">as</span> squareRoot &#125;</span><br><span class="line"><span class="keyword">export</span> &#123; Mathematics <span class="keyword">as</span> <span class="keyword">default</span>, sqrt <span class="keyword">as</span> squareRoot &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; max, min &#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;local-file.coffee&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;coffeescript&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> underscore <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  now</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  now <span class="keyword">as</span> currentTimestamp</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  first,</span><br><span class="line">  last</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> utilityBelt, &#123;</span><br><span class="line">  each</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">Math</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> square = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> Mathematics = <span class="class"><span class="keyword">class</span> <span class="title">Mathematics</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">least</span>(<span class="params">x, y</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; y) &#123;</span><br><span class="line">      <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  sqrt</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  sqrt <span class="keyword">as</span> squareRoot</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  Mathematics <span class="keyword">as</span> <span class="keyword">default</span>,</span><br><span class="line">  sqrt <span class="keyword">as</span> squareRoot</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  max,</span><br><span class="line">  min</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;underscore&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="嵌入式-JavaScript"><a href="#嵌入式-JavaScript" class="headerlink" title="嵌入式 JavaScript"></a>嵌入式 JavaScript</h2><p>在 CoffeeScript 中可以用倒引号（`）直接引用 JavaScript 代码：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hi = `<span class="javascript"><span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> [<span class="built_in">document</span>.title, <span class="string">&quot;Hello JavaScript&quot;</span>].join(<span class="string">&quot;: &quot;</span>);</span></span><br><span class="line"><span class="javascript">&#125;</span>`</span><br><span class="line"></span><br><span class="line"><span class="comment"># \`会被编译成`，\\\`会被编译成\`</span></span><br><span class="line">markdown = `<span class="javascript"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> \</span>`In Markdown, write code like \\\`<span class="javascript"><span class="built_in">this</span>\\\</span>`\`<span class="javascript">;</span></span><br><span class="line"><span class="javascript">&#125;</span>`</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hi;</span><br><span class="line"></span><br><span class="line">hi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="built_in">document</span>.title, <span class="string">&quot;Hello JavaScript&quot;</span>].join(<span class="string">&quot;: &quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> markdown;</span><br><span class="line"></span><br><span class="line">markdown = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`In Markdown, write code like \`this\``</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>用三个倒引号可以很轻松地引用一大块 JavaScript 代码：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\```<span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">time</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> <span class="string">`The time is <span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString()&#125;</span>`</span>;</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript">\</span>```</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">time</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`The time is <span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString()&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h2><p>CoffeeScript 不需要专门的插件或者设置，就可以理解 JSX。</p>
<p>同普通的 JSX 一样，<code>&lt;</code>和<code>&gt;</code>指明了XML 元素，由 <code>&#123;</code>和<code>&#125;</code>包围的代码会被内插替换。为了避免和大于、小于的比较混淆，类似<code>i &lt; len</code>的代码必须带空格，不能写作<code>i&lt;len</code>。编译器有时候能够在你忘记加空格的时候，猜到你的意图，但不要心怀侥幸，还是要尽量自己加空格。</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">renderStarRating</span> = <span class="params">(&#123; rating, maxStars &#125;)</span> -&gt;</span></span><br><span class="line">  &lt;aside title=&#123;<span class="string">&quot;Rating: <span class="subst">#&#123;rating&#125;</span> of <span class="subst">#&#123;maxStars&#125;</span> stars&quot;</span>&#125;&gt;</span><br><span class="line">    &#123;<span class="keyword">for</span> wholeStar <span class="keyword">in</span> [<span class="number">0.</span>..<span class="built_in">Math</span>.floor(rating)]</span><br><span class="line">      &lt;Star className=<span class="string">&quot;wholeStar&quot;</span> key=&#123;wholeStar&#125; /&gt;&#125;</span><br><span class="line">    &#123;<span class="keyword">if</span> rating % <span class="number">1</span> <span class="keyword">isnt</span> <span class="number">0</span></span><br><span class="line">      &lt;Star className=<span class="string">&quot;halfStar&quot;</span> /&gt;&#125;</span><br><span class="line">    &#123;<span class="keyword">for</span> emptyStar <span class="keyword">in</span> [<span class="built_in">Math</span>.ceil(rating)...maxStars]</span><br><span class="line">      &lt;Star className=<span class="string">&quot;emptyStar&quot;</span> key=&#123;emptyStar&#125; /&gt;&#125;</span><br><span class="line">  &lt;/aside&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> renderStarRating;</span><br><span class="line"></span><br><span class="line">renderStarRating = <span class="function"><span class="keyword">function</span>(<span class="params">&#123;rating, maxStars&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> emptyStar, wholeStar;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">aside</span> <span class="attr">title</span>=<span class="string">&#123;</span>`<span class="attr">Rating:</span> $&#123;<span class="attr">rating</span>&#125; <span class="attr">of</span> $&#123;<span class="attr">maxStars</span>&#125; <span class="attr">stars</span>`&#125;&gt;</span></span></span><br><span class="line"><span class="xml">    &#123;(function() &#123;</span></span><br><span class="line"><span class="xml">    var i, ref, results;</span></span><br><span class="line"><span class="xml">    results = [];</span></span><br><span class="line"><span class="xml">    for (wholeStar = i = 0, ref = Math.floor(rating); 0 &lt;= ref ? i &lt; ref : i &gt; ref; wholeStar = 0 &lt;= ref ? ++i : --i) &#123;</span></span><br><span class="line"><span class="xml">      results.push(<span class="tag">&lt;<span class="name">Star</span> <span class="attr">className</span>=<span class="string">&quot;wholeStar&quot;</span> <span class="attr">key</span>=<span class="string">&#123;wholeStar&#125;</span> /&gt;</span>);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    return results;</span></span><br><span class="line"><span class="xml">  &#125;)()&#125;</span></span><br><span class="line"><span class="xml">    &#123;(rating % 1 !== 0 ? <span class="tag">&lt;<span class="name">Star</span> <span class="attr">className</span>=<span class="string">&quot;halfStar&quot;</span> /&gt;</span> : void 0)&#125;</span></span><br><span class="line"><span class="xml">    &#123;(function() &#123;</span></span><br><span class="line"><span class="xml">    var i, ref, ref1, results;</span></span><br><span class="line"><span class="xml">    results = [];</span></span><br><span class="line"><span class="xml">    for (emptyStar = i = ref = Math.ceil(rating), ref1 = maxStars; ref &lt;= ref1 ? i &lt; ref1 : i &gt; ref1; emptyStar = ref &lt;= ref1 ? ++i : --i) &#123;</span></span><br><span class="line"><span class="xml">      results.push(<span class="tag">&lt;<span class="name">Star</span> <span class="attr">className</span>=<span class="string">&quot;emptyStar&quot;</span> <span class="attr">key</span>=<span class="string">&#123;emptyStar&#125;</span> /&gt;</span>);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    return results;</span></span><br><span class="line"><span class="xml">  &#125;)()&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="类型注解"><a href="#类型注解" class="headerlink" title="类型注解"></a>类型注解</h2><p>Flow 风格的注释式类型注解可以在 CoffeeScript 中提供静态类型检查的能力（TypeScript 的粉丝可能要头痛了）：</p>
<figure class="highlight coffee"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @flow</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###::</span></span><br><span class="line"><span class="comment">type Obj = &#123;</span></span><br><span class="line"><span class="comment">  num: number,</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"></span><br><span class="line">fn = (str <span class="comment">###: string ###</span>, obj <span class="comment">###: Obj ###</span>) <span class="comment">###: string ###</span> -&gt;</span><br><span class="line">  str + obj.num</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @flow</span></span><br><span class="line"><span class="comment">/*::</span></span><br><span class="line"><span class="comment">type Obj = &#123;</span></span><br><span class="line"><span class="comment">  num: number,</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> fn;</span><br><span class="line"></span><br><span class="line">fn = <span class="function"><span class="keyword">function</span>(<span class="params">str<span class="comment">/*: string */</span>, obj<span class="comment">/*: Obj */</span></span>)/*: <span class="title">string</span> */ </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str + obj.num;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>如果用户已经成功<a target="_blank" rel="noopener" href="https://flow.org/en/docs/install/">安装了 Flow</a> 和<a target="_blank" rel="noopener" href="http://coffeescript.org/#installation">最新的 CoffeeScript</a>，可以用如下命令进行类型检查：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">coffee --bare --no-header --compile app.coffee &amp;&amp; npm run flow</span><br></pre></td></tr></table></figure>

<p><code>--bare --no-header</code>非常重要，因为 Flow 要求文件中的第一行是<code>// @flow</code>注释。</p>

                    </article>
                    


    <blockquote id="date-expire-notification" class="post-expired-notify">This article was last updated on <span id="date-expire-num"></span> days ago, and the information described in the article may have changed.</blockquote>
    <script>
    (function() {
        var dateUpdate = Date.parse("2019-09-09");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    })();
    </script>


<p class="post-footer-info mb-0 pt-0">Published at&nbsp;<time datetime="2017-12-29T11:50:37.000Z" itemprop="datePublished">2017-12-29</time>

    , Updated at&nbsp;<time datetime="2019-09-09T13:35:42.000Z" itemprop="dateModified">2019-09-09</time>

</p>
<p class="post-footer-info mb-0 pt-2">



<span class="post-tags-list mt-2">

<a class="post-tags-list-item" href="/tags/CoffeeScript/" rel="tag">#&nbsp;CoffeeScript</a>

</span>


</p>

                </div>
                <div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/2018/01/04/%E4%B8%8D%E5%B8%B8%E8%A7%81%E7%9A%84-Java-%E9%9B%86%E5%90%88%E7%B1%BB%E7%9A%84%E7%94%A8%E6%B3%95/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">不常见的 Java 集合类的用法</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/2017/12/24/client-%E4%B8%8E-server/" rel="next">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">client 与 server</div>
            </a>
        </li>
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    
        <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span>
            <a class="footer-copyright-a" href="http://magicliang.github.io">守株阁</a>
        </p>

    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>




        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>


        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>

    
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};
document.getElementById('copyright-year').textContent = new Date().getFullYear();
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');

</script>

<script src="/lib/vanilla-lazyload/lazyload.min.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->




<!-- Comment -->


<!-- ### Custom Footer ### -->

    </body>

</html>