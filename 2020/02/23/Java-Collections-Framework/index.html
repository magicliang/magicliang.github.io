<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Java Collections Framework | 守株阁</title><meta name="author" content="magicliang"><meta name="copyright" content="magicliang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="UML 图 overview-of-java-collections-framework-api-uml-diagram Collection-Hierarchy.html  classDiagram     direction TB      %% 接口层级     Iterable &lt;|-- Collection     Collection  &lt;|-- List     Coll">
<meta property="og:type" content="article">
<meta property="og:title" content="Java Collections Framework">
<meta property="og:url" content="https://magicliang.github.io/2020/02/23/Java-Collections-Framework/index.html">
<meta property="og:site_name" content="守株阁">
<meta property="og:description" content="UML 图 overview-of-java-collections-framework-api-uml-diagram Collection-Hierarchy.html  classDiagram     direction TB      %% 接口层级     Iterable &lt;|-- Collection     Collection  &lt;|-- List     Coll">
<meta property="og:locale">
<meta property="og:image" content="https://magicliang.github.io/img/wall-paper-113.jpg">
<meta property="article:published_time" content="2020-02-23T10:47:18.000Z">
<meta property="article:modified_time" content="2025-10-22T08:01:32.157Z">
<meta property="article:author" content="magicliang">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://magicliang.github.io/img/wall-paper-113.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Java Collections Framework",
  "url": "https://magicliang.github.io/2020/02/23/Java-Collections-Framework/",
  "image": "https://magicliang.github.io/img/wall-paper-113.jpg",
  "datePublished": "2020-02-23T10:47:18.000Z",
  "dateModified": "2025-10-22T08:01:32.157Z",
  "author": [
    {
      "@type": "Person",
      "name": "magicliang",
      "url": "https://magicliang.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://magicliang.github.io/2020/02/23/Java-Collections-Framework/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: magicliang","link":"Link: ","source":"Source: 守株阁","info":"Copyright belongs to the author. For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source."}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Java Collections Framework',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="守株阁" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/wall-paper-113.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">守株阁</span></a><a class="nav-page-title" href="/"><span class="site-name">Java Collections Framework</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Java Collections Framework</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-02-23T10:47:18.000Z" title="Created 2020-02-23 18:47:18">2020-02-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-22T08:01:32.157Z" title="Updated 2025-10-22 16:01:32">2025-10-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>13mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>UML 图</h1>
<p><a target="_blank" rel="noopener" href="https://www.codejava.net/java-core/collections/overview-of-java-collections-framework-api-uml-diagram">overview-of-java-collections-framework-api-uml-diagram</a></p>
<p><a target="_blank" rel="noopener" href="http://www.falkhausen.de/Java-8/java.util/Collection-Hierarchy.html">Collection-Hierarchy.html</a></p>
<p><img src="Collection-Hierarchy.png" alt="Collection-Hierarchy.png"></p>
<pre><code class="hljs mermaid">classDiagram
    direction TB

    %% 接口层级
    Iterable &lt;|-- Collection
    Collection  &lt;|-- List
    Collection  &lt;|-- Set
    Collection  &lt;|-- Queue
    Set         &lt;|-- SortedSet
    Queue       &lt;|-- Deque
    Map         &lt;|-- SortedMap

    List        &lt;|-- ArrayList
    List        &lt;|-- LinkedList
    Set         &lt;|-- HashSet
    Set         &lt;|-- LinkedHashSet
    SortedSet   &lt;|-- TreeSet
    Queue       &lt;|-- PriorityQueue
    Deque       &lt;|-- ArrayDeque
    Deque       &lt;|-- LinkedList
    Map         &lt;|-- HashMap
    Map         &lt;|-- LinkedHashMap
    Map         &lt;|-- ConcurrentHashMap
    SortedMap   &lt;|-- TreeMap

    %% 接口定义
    class Iterable   &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Collection &#123; &lt;&lt;interface&gt;&gt; &#125;
    class List       &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Set        &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Queue      &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Deque      &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Map        &#123; &lt;&lt;interface&gt;&gt; &#125;

    %% 实现类 + 注释
    class ArrayList
    note for ArrayList &quot;随机访问高效，增删慢。适合频繁索引读取，如遍历数组数据。&quot;

    class LinkedList
    note for LinkedList &quot;增删高效，随机访问慢。适合频繁插入/删除，如实现栈/队列。&quot;

    class HashSet
    note for HashSet &quot;去重+快速查找，无序。适合黑名单过滤等场景。&quot;

    class LinkedHashSet
    note for LinkedHashSet &quot;去重+保持插入顺序。适合日志记录等需顺序场景。&quot;

    class TreeSet
    note for TreeSet &quot;有序存储，自动排序。适合排行榜等需排序场景。&quot;

    class PriorityQueue
    note for PriorityQueue &quot;优先级队列，按优先级出队。适合任务调度。&quot;

    class ArrayDeque
    note for ArrayDeque &quot;高效双端队列/栈。内存紧凑，适合事件系统。&quot;

    class HashMap
    note for HashMap &quot;键值对快速查找，无序。适合缓存实现。&quot;

    class LinkedHashMap
    note for LinkedHashMap &quot;保持插入或访问顺序。适合实现 LRU 缓存。&quot;

    class ConcurrentHashMap
    note for ConcurrentHashMap &quot;高并发安全映射。适合多线程共享配置。&quot;

    class TreeMap
    note for TreeMap &quot;按键自动排序。适合字典或范围查询。&quot;</code></pre>
<h1>队列的六个操作</h1>
<p>add(E e)<br>
Inserts the specified element at the tail of this queue if it is possible to do so immediately without exceeding the queue’s capacity, returning true upon success and throwing an IllegalStateException if this queue is full.</p>
<p>offer(E e)<br>
Inserts the specified element at the tail of this queue if it is possible to do so immediately without exceeding the queue’s capacity, returning true upon success and false if this queue is full.</p>
<p>put(E e)<br>
Inserts the specified element at the tail of this queue, waiting for space to become available if the queue is full.</p>
<p>peek()<br>
Retrieves, but does not remove, the head of this queue, or returns null if this queue is empty.</p>
<p>poll()<br>
Retrieves and removes the head of this queue, or returns null if this queue is empty.</p>
<p>take()<br>
Retrieves and removes the head of this queue, waiting if necessary until an element becomes available.</p>
<p>平时最常用的 put 和 take 是阻塞操作。<br>
非阻塞操作可以加一套限时参数变成部分阻塞操作。</p>
<h1>Code Examples</h1>
<h2 id="copyonwritearraylist">CopyOnWriteArrayList</h2>
<p>CopyOnWriteArrayList的读操作有最终一致性问题：</p>
<p>由于所有的写操作都是在新数组进行的，这个时候如果有线程并发的写，则通过锁来控制，如果有线程并发的读，则分几种情况：<br>
1、如果写操作未完成，那么直接读取原数组的数据；<br>
2、如果写操作完成，但是引用还未指向新数组，那么也是读取原数组数据；<br>
3、如果写操作完成，并且引用已经指向了新的数组，那么直接从新数组中读取数据。</p>
<p>普通的 list在迭代的时候用 list.remove 会失败，iterator.remove 在单线程下回成功。而 CopyOnWriteArrayList 实际上是在一个 immutable 的 snapshot 上进行迭代，所以连 iterator.remove 都会 fastfail。</p>
<p>它是 ArrayList 的一个并发替代品，通过读写分离提高性能，但一致性问题和复制问题是一个潜在的性能和业务问题。</p>
<h2 id="enumset">EnumSet</h2>
<p>enumset 的限制：</p>
<ul>
<li>It can contain only enum values and all the values have to belong to the same enum</li>
<li>It doesn’t allow to add null values, throwing a NullPointerException in an attempt to do so</li>
<li>It’s not thread-safe, so we need to synchronize it externally if required</li>
<li>The elements are stored following the order in which they are declared in the enum</li>
<li>It uses a fail-safe iterator that works on a copy, so it won’t throw a ConcurrentModificationException if the collection is modified when iterating over it - fail-safe 意味着不是 immutable 的，而且可能被并发修改。</li>
</ul>
<p>JDK 提供两个默认参考实现：</p>
<ul>
<li>RegularEnumSet</li>
<li>JumboEnumSet</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">EnumSet&lt;E <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Enum</span>&lt;E&gt;&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractSet</span>&lt;E&gt; <br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> EnumSet&lt;InsPayOrderStatusEnum&gt; BAD_FINAL_STATUSES = EnumSet.of(FAILED, CLOSED, BOUNCED);<br></code></pre></td></tr></table></figure>
<h2 id="enummap">EnumMap</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 构造器里必须有 class 类型</span><br>EnumMap&lt;DayOfWeek, String&gt; activityMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EnumMap</span>&lt;&gt;(DayOfWeek.class);<br>activityMap.put(DayOfWeek.MONDAY, <span class="hljs-string">&quot;Soccer&quot;</span>);<br><br><span class="hljs-comment">// 复制构造器</span><br>Map&lt;DayOfWeek, String&gt; ordinaryMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>ordinaryMap.put(DayOfWeek.MONDAY, <span class="hljs-string">&quot;Soccer&quot;</span>);<br> <br><span class="hljs-type">EnumMap</span> <span class="hljs-variable">enumMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EnumMap</span>(ordinaryMap);<br><br><span class="hljs-comment">// 双参数的 remove</span><br>activityMap.put(DayOfWeek.Monday, <span class="hljs-string">&quot;Soccer&quot;</span>);<br>assertThat(activityMap.remove(DayOfWeek.Monday, <span class="hljs-string">&quot;Hiking&quot;</span>)).isEqualTo(<span class="hljs-literal">false</span>);<br>assertThat(activityMap.remove(DayOfWeek.Monday, <span class="hljs-string">&quot;Soccer&quot;</span>)).isEqualTo(<span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure>
<p>Using Enum as key makes it possible to do some extra performance optimization, like a quicker hash computation since all possible keys are known in advance.</p>
<p>因为枚举的顺序已经被事先知道了，所以可以进行某些极致的优化。</p>
<p>EnumMap is an ordered map, in that its views will iterate in enum order.</p>
<p>EnumMap 是一个有序 map，但 LinkedHashMap 和 TreeMap 也可以提供类似的行为。</p>
<h2 id="identityhashmap">IdentityHashMap</h2>
<p>IdentityHashMap 的用法和HashMap的用法差不多，他们之间最大的区别就是IdentityHashMap判断两个key是否相等，是通过严格相等即（key1==key2）来判读的，而HashMap是通过equals()方法和hashCode（）这两个方法来判断key是否相等的。</p>
<p>用途：</p>
<ul>
<li>需要比对独一无二的的对象，如全局的 class，可以用 IdentityHashMap 来控制唯一性（注意这一点 Set 接口应该也做得到）。</li>
<li>深拷贝的时候需要容忍相同的值不同引用的对象。</li>
</ul>
<h2 id="sorted-接口">Sorted 接口</h2>
<p>since 1.2</p>
<p>SortedMap、SortedSet 都要求包含的元素实现了 Comparable 接口，这样它们可以被集合排序（当然只有迭代或者顺序查询的时候才能体现出这种顺序来），这被称为<code>provides a total ordering on its keys</code>。</p>
<p>这种 order 可能是 natural order，也可能是由创建集合时传入的 comparator 决定的，却绝不是 LinkedList 等数据结构保持的插入顺序。</p>
<p>Java 中提到 order，默认都是 ascending （类似于指定了 order by 的 MySQL）。</p>
<h3 id="sortedmap">SortedMap</h3>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">Comparator comparator <span class="hljs-operator">=</span> new MyComparator()<span class="hljs-comment">;</span><br>SortedMap sortedMap <span class="hljs-operator">=</span> new TreeMap(comparator)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>
<p>非有序 map 也可以转成有序 map：</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">Map</span> <span class="hljs-built_in">map</span> = <span class="hljs-keyword">new</span> HashMap();<br>SortedMap sortedMap = <span class="hljs-keyword">new</span> TreeMap(<span class="hljs-built_in">map</span>);<br></code></pre></td></tr></table></figure>
<ul>
<li>Range view — performs arbitrary range operations on the SortedMap</li>
<li>subMap(K fromKey, K toKey): Returns a view of the portion of this Map whose keys range from fromKey, inclusive, to toKey, exclusive.</li>
<li>headMap(K toKey): Returns a view of the portion of this Map whose keys are strictly less than toKey.</li>
<li>tailMap(K fromKey): Returns a view of the portion of this Map whose keys are greater than or equal to fromKey.</li>
<li>Endpoints — returns the first or the last key in the SortedMap</li>
<li>firstKey(): Returns the first (lowest) key currently in this Map.</li>
<li>lastKey(): Returns the last (highest) key currently in this Map.</li>
<li>Comparator access — returns the Comparator, if any, used to sort the map</li>
<li>comparator(): Returns the Comparator used to order the keys in this Map, or null if this Map uses the natural ordering of its keys.</li>
</ul>
<h3 id="sortedset">SortedSet</h3>
<p>近于 SortedMap，也能维护自己内部元素的顺序。<br>
可以提供各种基于大小比对得到视图（View）的 API。</p>
<h2 id="navigable-接口">Navigable 接口</h2>
<p>since 1.2</p>
<p>NavigableSet扩展了 SortedSet，具有了为给定搜索目标报告最接近匹配项的导航方法。方法 lower、floor、ceiling 和 higher 分别返回小于、小于等于、大于等于、大于给定元素的元素，如果不存在这样的元素，则返回 null。</p>
<p>类似地，方法 lowerKey、floorKey、ceilingKey 和 higherKey 只返回关联的键。所有这些方法是为查找条目而不是遍历条目而设计的。</p>
<p>可以按照键的升序或降序访问和遍历 NavigableMap。descendingMap 方法返回映射的一个视图，该视图表示的所有关系方法和方向方法都是逆向的。升序操作和视图的性能很可能比降序操作和视图的性能要好。subMap、headMap 和 tailMap 方法与名称相似的 SortedMap 方法的不同之处在于：可以接受用于描述是否包括（或不包括）下边界和上边界的附加参数。任何 NavigableMap 的 Submap 必须实现 NavigableMap 接口。</p>
<p>此外，此接口还定义了 firstEntry、pollFirstEntry、lastEntry 和 pollLastEntry 方法，它们返回和/或移除最小和最大的映射关系（如果存在），否则返回 null。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">NavigableSet</span> <span class="hljs-variable">reverse</span> <span class="hljs-operator">=</span> map.descendingKeySet();<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>original.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>original.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br>original.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br><br><span class="hljs-comment">//this headmap1 will contain &quot;1&quot; and &quot;2&quot;</span><br><span class="hljs-type">SortedMap</span> <span class="hljs-variable">headmap1</span> <span class="hljs-operator">=</span> original.headMap(<span class="hljs-string">&quot;3&quot;</span>);<br><br><span class="hljs-comment">//this headmap2 will contain &quot;1&quot;, &quot;2&quot;, and &quot;3&quot; because &quot;inclusive&quot;=true</span><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">headmap2</span> <span class="hljs-operator">=</span> original.headMap(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-literal">true</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">navigableMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br><br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-type">SortedMap</span> <span class="hljs-variable">tailMap</span> <span class="hljs-operator">=</span> navigableMap.tailMap(<span class="hljs-string">&quot;c&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>original.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>original.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br>original.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>original.put(<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>original.put(<span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br><br><span class="hljs-comment">//this submap1 will contain &quot;3&quot;, &quot;3&quot;</span><br><span class="hljs-type">SortedMap</span>    <span class="hljs-variable">submap1</span>  <span class="hljs-operator">=</span> original.subMap(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br><br><span class="hljs-comment">//this submap2 will contain (&quot;2&quot;, &quot;2&quot;) (&quot;3&quot;, &quot;3&quot;) and (&quot;4&quot;, &quot;4&quot;) because</span><br><span class="hljs-comment">//    fromInclusive=true, and toInclusive=true</span><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">submap2</span> <span class="hljs-operator">=</span> original.subMap(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-literal">true</span>)<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>original.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>original.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br>original.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br><br><br><span class="hljs-comment">//ceilingKey will be &quot;2&quot;.</span><br><span class="hljs-type">Object</span> <span class="hljs-variable">ceilingKey</span> <span class="hljs-operator">=</span> original.ceilingKey(<span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>original.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>original.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br>original.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br><br><span class="hljs-comment">//floorKey will be &quot;2&quot;.</span><br><span class="hljs-type">Object</span> <span class="hljs-variable">floorKey</span> <span class="hljs-operator">=</span> original.floorKey(<span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>original.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>original.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br>original.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br><br><br><span class="hljs-comment">//higherKey will be &quot;3&quot;.</span><br><span class="hljs-type">Object</span> <span class="hljs-variable">higherKey</span> <span class="hljs-operator">=</span> original.higherKey(<span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>original.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>original.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br>original.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br><br><span class="hljs-comment">//lowerKey will be &quot;1&quot;</span><br><span class="hljs-type">Object</span> <span class="hljs-variable">lowerKey</span> <span class="hljs-operator">=</span> original.lowerKey(<span class="hljs-string">&quot;2&quot;</span>);<br><br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-comment">//ceilingEntry will be (&quot;c&quot;, &quot;3&quot;).</span><br>Map.<span class="hljs-type">Entry</span> <span class="hljs-variable">ceilingEntry</span> <span class="hljs-operator">=</span> navigableMap.ceilingEntry(<span class="hljs-string">&quot;c&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-comment">//floorEntry will be (&quot;c, &quot;3&quot;).</span><br>Map.<span class="hljs-type">Entry</span> <span class="hljs-variable">floorEntry</span> <span class="hljs-operator">=</span> navigableMap.floorEntry(<span class="hljs-string">&quot;c&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-comment">//higherEntry will be (&quot;d&quot;, &quot;4&quot;).</span><br>Map.<span class="hljs-type">Entry</span> <span class="hljs-variable">higherEntry</span> <span class="hljs-operator">=</span> original.higherEntry(<span class="hljs-string">&quot;c&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-comment">//lowerEntry will be (&quot;a&quot;, &quot;1&quot;)</span><br>Map.<span class="hljs-type">Entry</span> <span class="hljs-variable">lowerEntry</span> <span class="hljs-operator">=</span> original.lowerEntry(<span class="hljs-string">&quot;b&quot;</span>);<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><br><span class="hljs-comment">//first is (&quot;a&quot;, &quot;1&quot;)</span><br>Map.<span class="hljs-type">Entry</span> <span class="hljs-variable">first</span> <span class="hljs-operator">=</span> original.pollFirstEntry();<br><br><span class="hljs-type">NavigableMap</span> <span class="hljs-variable">original</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>();<br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><br><span class="hljs-comment">//first is (&quot;e&quot;, &quot;5&quot;)</span><br>Map.<span class="hljs-type">Entry</span> <span class="hljs-variable">last</span> <span class="hljs-operator">=</span> original.pollLastEntry();<br></code></pre></td></tr></table></figure>
<h2 id="abstractlist">AbstractList</h2>
<p>它的迭代器是不可变的 ListIterator, 只有 hasNext()，hasPrevious()，next()， previous()， 还有几个获取位置的方法 - 没有增删改查的操作。</p>
<h2 id="abstractsequentiallist">AbstractSequentialList</h2>
<p>抽象线性表，就是数据结构里的线性表，是顺序表和链表的基类型，但在 Java 里只是 LinkedList。</p>
<p>它的迭代器在 ListIterator 基础上增加了，add、remove 等操作。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://magicliang.github.io">magicliang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://magicliang.github.io/2020/02/23/Java-Collections-Framework/">https://magicliang.github.io/2020/02/23/Java-Collections-Framework/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post-share"><div class="social-share" data-image="/img/wall-paper-113.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2017/10/23/%E6%98%82%E8%B4%B5%E7%9A%84%E5%BC%82%E5%B8%B8/" title="昂贵的异常"><img class="cover" src="/img/wall-paper-140.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-10-23</div><div class="info-item-2">昂贵的异常</div></div><div class="info-2"><div class="info-item-1">抛出问题   Joshua Bloch 在《Effective Java》的 Item 57 里明确地提到过，不要试图用 Exception 的跳转来代替正常的程序控制流。他列举了很多原因，但特别提到了抛出异常会使得整个程序运行变慢。抛出异常远比普通的 return , break 等操作对控制流、数据流的性能影响要大，它就只适合拿来作异常分支的控制语句，而不能拿来编写正常的逻辑。  Throwing exception is expensive.    这句话在 Java 的程序员世界里面已经成为老生常谈。却很少有人谈及，但到底抛出异常比正常的程序跳转返回慢在哪里，有多慢。“不要滥用异常”好像一个猴子定律，人们忘记了为什么不能这么做，却不明白为什么不能这么做。   这几天读了一位同事写的好文[《Java虚拟机是如何处理异常的》][2]，深入地分析了 JVM 对异常跳转的处理过程: JVM 会通过异常表的机制，优化异常抛出和正常返回之间的性能差异。仅从程序计数器的移动上来讲，抛出一个异常对栈帧的弹栈并不比直接返回更昂贵。写在前头的结论是：“try-catch语句块几乎不会影响程序...</div></div></div></a><a class="pagination-related" href="/2017/11/10/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E4%B8%8E%E9%94%81%E4%BC%98%E5%8C%96/" title="线程安全与锁优化"><img class="cover" src="/img/wall-paper-29.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-11-10</div><div class="info-item-2">线程安全与锁优化</div></div><div class="info-2"><div class="info-item-1">线程安全 什么是线程安全 “当多个线程访问一个对象时，如果不用考虑这些线程在运行时环境下的调度和交替执行，也不需要进行额外的同步，或者在调用方法进行任何其他的协调操作，调用这个对象的行为都可以获得正确的结果，那么这个对象就是线程安全的。” 相对的线程安全，可以分成五个等级： 线程安全的分类 不可变 不可变的数据，都是线程安全的。不可变的对象引用，加上所有field都是不可变的。如果有得选，尽量连方法都是final的。 绝对线程安全 Vector不是线程安全的。它也会出现并发修改时 Out of Range 的异常（注意，不是 ConcurrentModification 的异常）。 相对线程安全 需要保证对这个对象的单独操作是线程安全的，在调用的时候不需要加上额外的保障措施。对于特定顺序的连续操作，就需要额外的同步来保证调用的正确性了。 线程兼容 可以通过特殊手段做到线程安全的普通类，绝大部分类都属于相对线程安全的。 线程对立 线程对立，是不管调用端是否采取了同步措施，都无法在多线程环境中使用的代码。常见的线程对立的操作还有 suspend()，resume()， System....</div></div></div></a><a class="pagination-related" href="/2017/11/30/Java%E4%B8%AD%E7%9A%84%E5%B9%BD%E7%81%B5%E7%B1%BB%E5%9E%8B/" title="Java中的幽灵类型"><img class="cover" src="/img/wall-paper-153.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-11-30</div><div class="info-item-2">Java中的幽灵类型</div></div><div class="info-2"><div class="info-item-1">先上结论：幽灵类型（Phantom Type）顾名思义，就是幽灵般的类型，这种类型往往在运行时可以消失，因为在运行时没有任何作用，它们最大的特点就是没有任何实例（Java 的 Void 就是幽灵类型的例子）。是一种可以把有些运行时才能检测到的错误，在编译时检测出来的技巧。按照有些老外的观点，就是“Making Wrong Code Look Wrong”。在面向对象的编程语言之中，幽灵类型的实现，往往与状态模式较为接近，但比状态模式提供了更强的纠错功能。在Java 5 以后的版本里，程序员可以使用泛型。通过泛型的类型参数，Java 中也拥有了幽灵类型的能力。 上面的阐述是不是很难看懂？我也觉得拗口，让我们直接进入具体的例子。假设我们要写一个飞机控制程序，操作飞机起飞或者落地。这个程序有一个非常强的业务约束，就是必须保证飞机一开始必须出现在的地上，只有在地上的飞机可以起飞，只有起飞的飞机可以落地，那么我们应该怎样设计我们的程序（主要是类型关系），来保证这个约束必然成立呢？ 让我们先来定义一组状态接口: 123456789101112131415161718192021/** * F...</div></div></div></a><a class="pagination-related" href="/2018/01/04/%E4%B8%8D%E5%B8%B8%E8%A7%81%E7%9A%84-Java-%E9%9B%86%E5%90%88%E7%B1%BB%E7%9A%84%E7%94%A8%E6%B3%95/" title="不常见的 Java 集合类的用法"><img class="cover" src="/img/wall-paper-145.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-01-04</div><div class="info-item-2">不常见的 Java 集合类的用法</div></div><div class="info-2"><div class="info-item-1">Sorted 集合## Sorted集合 Navigable 集合 Navigable Priority集合 Priority Identity 集合## Identity SkipList 集合 跳表系列。 DelayQueue 延迟队列 </div></div></div></a><a class="pagination-related" href="/2018/05/29/JPA-%E7%9A%84-id-%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5/" title="JPA 的 id 生成策略"><img class="cover" src="/img/wall-paper-66.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-05-29</div><div class="info-item-2">JPA 的 id 生成策略</div></div><div class="info-2"><div class="info-item-1">JPA 有一个@GeneratedValue注解，有一个strategy attribute，如 @GeneratedValue(strategy = GenerationType.IDENTITY)。 常见的可选策略主要有IDENTITY和SEQUENCE。 GenerationType.IDENTITY 要求底层有一个 integer 或者 bigint 类型的自增列（ auto-incremented column)。自增列的赋值必须在插入操作之后发生，因为这个原因，Hibernate 无法进行各种优化（特别是 JDBC 的 batch 处理，一次 flush 操作会产生很多条insert 语句，分别执行）。如果事务回滚，自增列的值就会被丢弃。数据库在这个自增操作上有个高度优化的轻量级锁机制，性能非常棒。 MySQL 支持这种 id 生成策略， 使用 MySQL 应该尽量使用这个策略，即使它无法优化。 JPA 用它生成 id，会一条一条地插入新的 entity。 GenerationType.SEQUENCE 数据库有一个所谓的 sequence 对象，可以通过 selec...</div></div></div></a><a class="pagination-related" href="/2018/06/19/%E5%A6%82%E4%BD%95%E5%81%9A%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8B%E7%9A%84%E7%AD%94%E6%A1%88/" title="如何做性能测试的问题下的答案"><img class="cover" src="/img/wall-paper-58.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-19</div><div class="info-item-2">如何做性能测试的问题下的答案</div></div><div class="info-2"><div class="info-item-1">试着回答一下这个问题。 首先要划分系统类型：有状态还是无状态，业务系统还是存储系统。根据不同的业务场景，设立性能测试的目标：是要测 QPS，还是 TPS 还是 TPS，还是任何其他【性能】-从广义来讲，一个存储系统到底能够以多高的平均时延来管理大多的存储空间，可能也是性能的一种。 有了性能测试的目标，接下来就是拆解用例。如果把性能测试归为测试的话，测试就需要测试用例，测试用例只是用例的形式化表达。把用户的使用场景勾勒出来，把每一步拆解成的流程图或者时序图–我们已经得到了一个纸上的集成测试计划，只是没有跟性能挂上钩。 接下来就进入真正写测试用例的环节了。 我们的测试报告如果要涵盖足够立体的信息，则既要了解每一个环节/接口/API 的性能指标，又要了解整体的性能指标。 这个时候测试工具的覆盖面就很重要了。如果我们选择偏黑盒的测试工具，apache ab /JMeter，则我们的测试用例就要围绕着对外交互的 API写，也只能测到外围接口的性能。这样的测试用例写起来最简单，无需侵入任何内部代码中。 如果我们使用了 JMH 一类的工具，则可以自由编写对任何方法的测试用例。但需要对系统有非常...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">UML 图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">队列的六个操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">Code Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#copyonwritearraylist"><span class="toc-number">3.1.</span> <span class="toc-text">CopyOnWriteArrayList</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enumset"><span class="toc-number">3.2.</span> <span class="toc-text">EnumSet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enummap"><span class="toc-number">3.3.</span> <span class="toc-text">EnumMap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#identityhashmap"><span class="toc-number">3.4.</span> <span class="toc-text">IdentityHashMap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sorted-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.5.</span> <span class="toc-text">Sorted 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sortedmap"><span class="toc-number">3.5.1.</span> <span class="toc-text">SortedMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sortedset"><span class="toc-number">3.5.2.</span> <span class="toc-text">SortedSet</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#navigable-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.6.</span> <span class="toc-text">Navigable 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#abstractlist"><span class="toc-number">3.7.</span> <span class="toc-text">AbstractList</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#abstractsequentiallist"><span class="toc-number">3.8.</span> <span class="toc-text">AbstractSequentialList</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2017 - 2025 By magicliang</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">簡</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>