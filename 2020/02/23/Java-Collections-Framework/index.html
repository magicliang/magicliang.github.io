<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Java Collections Framework | å®ˆæ ªé˜</title><meta name="author" content="magicliang"><meta name="copyright" content="magicliang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Java Collections Framework UML å›¾ overview-of-java-collections-framework-api-uml-diagram Collection-Hierarchy.html  classDiagram     direction TB      %% æ¥å£å±‚çº§     Iterable &lt;|-- Collection     Collec">
<meta property="og:type" content="article">
<meta property="og:title" content="Java Collections Framework">
<meta property="og:url" content="https://magicliang.github.io/2020/02/23/Java-Collections-Framework/index.html">
<meta property="og:site_name" content="å®ˆæ ªé˜">
<meta property="og:description" content="Java Collections Framework UML å›¾ overview-of-java-collections-framework-api-uml-diagram Collection-Hierarchy.html  classDiagram     direction TB      %% æ¥å£å±‚çº§     Iterable &lt;|-- Collection     Collec">
<meta property="og:locale">
<meta property="og:image" content="https://magicliang.github.io/img/wall-paper-111.jpg">
<meta property="article:published_time" content="2020-02-23T10:47:18.000Z">
<meta property="article:modified_time" content="2026-02-07T16:34:38.969Z">
<meta property="article:author" content="magicliang">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://magicliang.github.io/img/wall-paper-111.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Java Collections Framework",
  "url": "https://magicliang.github.io/2020/02/23/Java-Collections-Framework/",
  "image": "https://magicliang.github.io/img/wall-paper-111.jpg",
  "datePublished": "2020-02-23T10:47:18.000Z",
  "dateModified": "2026-02-07T16:34:38.969Z",
  "author": [
    {
      "@type": "Person",
      "name": "magicliang",
      "url": "https://magicliang.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://magicliang.github.io/2020/02/23/Java-Collections-Framework/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: magicliang","link":"Link: ","source":"Source: å®ˆæ ªé˜","info":"Copyright belongs to the author. For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source."}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Java Collections Framework',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="å®ˆæ ªé˜" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/wall-paper-111.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">å®ˆæ ªé˜</span></a><a class="nav-page-title" href="/"><span class="site-name">Java Collections Framework</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Java Collections Framework</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-02-23T10:47:18.000Z" title="Created 2020-02-23 18:47:18">2020-02-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-07T16:34:38.969Z" title="Updated 2026-02-08 00:34:38">2026-02-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">7.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>31mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>Java Collections Framework</h1>
<h2 id="uml-å›¾">UML å›¾</h2>
<p><a target="_blank" rel="noopener" href="https://www.codejava.net/java-core/collections/overview-of-java-collections-framework-api-uml-diagram">overview-of-java-collections-framework-api-uml-diagram</a></p>
<p><a target="_blank" rel="noopener" href="http://www.falkhausen.de/Java-8/java.util/Collection-Hierarchy.html">Collection-Hierarchy.html</a></p>
<p><img src="Collection-Hierarchy.png" alt="Collection-Hierarchy.png"></p>
<pre><code class="hljs mermaid">classDiagram
    direction TB

    %% æ¥å£å±‚çº§
    Iterable &lt;|-- Collection
    Collection  &lt;|-- List
    Collection  &lt;|-- Set
    Collection  &lt;|-- Queue
    Set         &lt;|-- SortedSet
    Queue       &lt;|-- Deque
    Map         &lt;|-- SortedMap

    List        &lt;|-- ArrayList
    List        &lt;|-- LinkedList
    Set         &lt;|-- HashSet
    Set         &lt;|-- LinkedHashSet
    SortedSet   &lt;|-- TreeSet
    Queue       &lt;|-- PriorityQueue
    Deque       &lt;|-- ArrayDeque
    Deque       &lt;|-- LinkedList
    Map         &lt;|-- HashMap
    Map         &lt;|-- LinkedHashMap
    Map         &lt;|-- ConcurrentHashMap
    SortedMap   &lt;|-- TreeMap

    %% æ¥å£å®šä¹‰
    class Iterable   &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Collection &#123; &lt;&lt;interface&gt;&gt; &#125;
    class List       &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Set        &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Queue      &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Deque      &#123; &lt;&lt;interface&gt;&gt; &#125;
    class Map        &#123; &lt;&lt;interface&gt;&gt; &#125;

    %% å®ç°ç±» + æ³¨é‡Š
    class ArrayList
    note for ArrayList &quot;éšæœºè®¿é—®é«˜æ•ˆï¼Œå¢åˆ æ…¢ã€‚é€‚åˆé¢‘ç¹ç´¢å¼•è¯»å–ï¼Œå¦‚éå†æ•°ç»„æ•°æ®ã€‚&quot;

    class LinkedList
    note for LinkedList &quot;å¢åˆ é«˜æ•ˆï¼Œéšæœºè®¿é—®æ…¢ã€‚é€‚åˆé¢‘ç¹æ’å…¥/åˆ é™¤ï¼Œå¦‚å®ç°æ ˆ/é˜Ÿåˆ—ã€‚&quot;

    class HashSet
    note for HashSet &quot;å»é‡+å¿«é€ŸæŸ¥æ‰¾ï¼Œæ— åºã€‚é€‚åˆé»‘åå•è¿‡æ»¤ç­‰åœºæ™¯ã€‚&quot;

    class LinkedHashSet
    note for LinkedHashSet &quot;å»é‡+ä¿æŒæ’å…¥é¡ºåºã€‚é€‚åˆæ—¥å¿—è®°å½•ç­‰éœ€é¡ºåºåœºæ™¯ã€‚&quot;

    class TreeSet
    note for TreeSet &quot;æœ‰åºå­˜å‚¨ï¼Œè‡ªåŠ¨æ’åºã€‚é€‚åˆæ’è¡Œæ¦œç­‰éœ€æ’åºåœºæ™¯ã€‚&quot;

    class PriorityQueue
    note for PriorityQueue &quot;ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ŒæŒ‰ä¼˜å…ˆçº§å‡ºé˜Ÿã€‚é€‚åˆä»»åŠ¡è°ƒåº¦ã€‚&quot;

    class ArrayDeque
    note for ArrayDeque &quot;é«˜æ•ˆåŒç«¯é˜Ÿåˆ—/æ ˆã€‚å†…å­˜ç´§å‡‘ï¼Œé€‚åˆäº‹ä»¶ç³»ç»Ÿã€‚&quot;

    class HashMap
    note for HashMap &quot;é”®å€¼å¯¹å¿«é€ŸæŸ¥æ‰¾ï¼Œæ— åºã€‚é€‚åˆç¼“å­˜å®ç°ã€‚&quot;

    class LinkedHashMap
    note for LinkedHashMap &quot;ä¿æŒæ’å…¥æˆ–è®¿é—®é¡ºåºã€‚é€‚åˆå®ç° LRU ç¼“å­˜ã€‚&quot;

    class ConcurrentHashMap
    note for ConcurrentHashMap &quot;é«˜å¹¶å‘å®‰å…¨æ˜ å°„ã€‚é€‚åˆå¤šçº¿ç¨‹å…±äº«é…ç½®ã€‚&quot;

    class TreeMap
    note for TreeMap &quot;æŒ‰é”®è‡ªåŠ¨æ’åºã€‚é€‚åˆå­—å…¸æˆ–èŒƒå›´æŸ¥è¯¢ã€‚&quot;</code></pre>
<h2 id="æ ¸å¿ƒæ¥å£ä¸æŠ½è±¡ç±»">æ ¸å¿ƒæ¥å£ä¸æŠ½è±¡ç±»</h2>
<h3 id="sorted-æ¥å£">Sorted æ¥å£</h3>
<p>since 1.2</p>
<p>SortedMapã€SortedSet éƒ½è¦æ±‚åŒ…å«çš„å…ƒç´ å®ç°äº† Comparable æ¥å£ï¼Œè¿™æ ·å®ƒä»¬å¯ä»¥è¢«é›†åˆæ’åºï¼ˆå½“ç„¶åªæœ‰è¿­ä»£æˆ–è€…é¡ºåºæŸ¥è¯¢çš„æ—¶å€™æ‰èƒ½ä½“ç°å‡ºè¿™ç§é¡ºåºæ¥ï¼‰ï¼Œè¿™è¢«ç§°ä¸º <code>provides a total ordering on its keys</code>ã€‚</p>
<p>è¿™ç§ order å¯èƒ½æ˜¯ natural orderï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±åˆ›å»ºé›†åˆæ—¶ä¼ å…¥çš„ comparator å†³å®šçš„ï¼Œå´ç»ä¸æ˜¯ LinkedList ç­‰æ•°æ®ç»“æ„ä¿æŒçš„æ’å…¥é¡ºåºã€‚</p>
<p>Java ä¸­æåˆ° orderï¼Œé»˜è®¤éƒ½æ˜¯ ascendingï¼ˆç±»ä¼¼äºæŒ‡å®šäº† order by çš„ MySQLï¼‰ã€‚</p>
<h4 id="sortedmap">SortedMap</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Comparator</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyComparator</span>();<br><span class="hljs-type">SortedMap</span> <span class="hljs-variable">sortedMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>(comparator);<br></code></pre></td></tr></table></figure>
<p>éæœ‰åº map ä¹Ÿå¯ä»¥è½¬æˆæœ‰åº mapï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Map</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br><span class="hljs-type">SortedMap</span> <span class="hljs-variable">sortedMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>(map);<br></code></pre></td></tr></table></figure>
<p>SortedMap æä¾›ä¸‰ç±»æ“ä½œï¼š</p>
<ul>
<li>
<p><strong>Range view</strong> â€” å¯¹ SortedMap æ‰§è¡Œä»»æ„èŒƒå›´æ“ä½œ</p>
<ul>
<li><code>subMap(K fromKey, K toKey)</code>ï¼šè¿”å›é”®èŒƒå›´ä» fromKeyï¼ˆåŒ…å«ï¼‰åˆ° toKeyï¼ˆä¸åŒ…å«ï¼‰çš„ Map è§†å›¾</li>
<li><code>headMap(K toKey)</code>ï¼šè¿”å›é”®ä¸¥æ ¼å°äº toKey çš„ Map è§†å›¾</li>
<li><code>tailMap(K fromKey)</code>ï¼šè¿”å›é”®å¤§äºç­‰äº fromKey çš„ Map è§†å›¾</li>
</ul>
</li>
<li>
<p><strong>Endpoints</strong> â€” è¿”å› SortedMap ä¸­çš„ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªé”®</p>
<ul>
<li><code>firstKey()</code>ï¼šè¿”å›å½“å‰ Map ä¸­çš„ç¬¬ä¸€ä¸ªï¼ˆæœ€å°ï¼‰é”®</li>
<li><code>lastKey()</code>ï¼šè¿”å›å½“å‰ Map ä¸­çš„æœ€åä¸€ä¸ªï¼ˆæœ€å¤§ï¼‰é”®</li>
</ul>
</li>
<li>
<p><strong>Comparator access</strong> â€” è¿”å›ç”¨äºæ’åºçš„ Comparatorï¼ˆå¦‚æœæœ‰ï¼‰</p>
<ul>
<li><code>comparator()</code>ï¼šè¿”å›ç”¨äºå¯¹é”®è¿›è¡Œæ’åºçš„ Comparatorï¼Œå¦‚æœæ­¤ Map ä½¿ç”¨é”®çš„è‡ªç„¶æ’åºåˆ™è¿”å› null</li>
</ul>
</li>
</ul>
<h4 id="sortedset">SortedSet</h4>
<p>SortedSet è¿‘äº SortedMapï¼Œä¹Ÿèƒ½ç»´æŠ¤è‡ªå·±å†…éƒ¨å…ƒç´ çš„é¡ºåºã€‚å¯ä»¥æä¾›å„ç§åŸºäºå¤§å°æ¯”å¯¹å¾—åˆ°è§†å›¾ï¼ˆViewï¼‰çš„ APIã€‚</p>
<h3 id="navigable-æ¥å£">Navigable æ¥å£</h3>
<p>since 1.6</p>
<p>NavigableSet æ‰©å±•äº† SortedSetï¼Œå…·æœ‰äº†ä¸ºç»™å®šæœç´¢ç›®æ ‡æŠ¥å‘Šæœ€æ¥è¿‘åŒ¹é…é¡¹çš„å¯¼èˆªæ–¹æ³•ã€‚æ–¹æ³• <code>lower</code>ã€<code>floor</code>ã€<code>ceiling</code> å’Œ <code>higher</code> åˆ†åˆ«è¿”å›å°äºã€å°äºç­‰äºã€å¤§äºç­‰äºã€å¤§äºç»™å®šå…ƒç´ çš„å…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å…ƒç´ ï¼Œåˆ™è¿”å› nullã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œæ–¹æ³• <code>lowerKey</code>ã€<code>floorKey</code>ã€<code>ceilingKey</code> å’Œ <code>higherKey</code> åªè¿”å›å…³è”çš„é”®ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•æ˜¯ä¸ºæŸ¥æ‰¾æ¡ç›®è€Œä¸æ˜¯éå†æ¡ç›®è€Œè®¾è®¡çš„ã€‚</p>
<p>å¯ä»¥æŒ‰ç…§é”®çš„å‡åºæˆ–é™åºè®¿é—®å’Œéå† NavigableMapã€‚<code>descendingMap</code> æ–¹æ³•è¿”å›æ˜ å°„çš„ä¸€ä¸ªè§†å›¾ï¼Œè¯¥è§†å›¾è¡¨ç¤ºçš„æ‰€æœ‰å…³ç³»æ–¹æ³•å’Œæ–¹å‘æ–¹æ³•éƒ½æ˜¯é€†å‘çš„ã€‚å‡åºæ“ä½œå’Œè§†å›¾çš„æ€§èƒ½å¾ˆå¯èƒ½æ¯”é™åºæ“ä½œå’Œè§†å›¾çš„æ€§èƒ½è¦å¥½ã€‚</p>
<p><code>subMap</code>ã€<code>headMap</code> å’Œ <code>tailMap</code> æ–¹æ³•ä¸åç§°ç›¸ä¼¼çš„ SortedMap æ–¹æ³•çš„ä¸åŒä¹‹å¤„åœ¨äºï¼šå¯ä»¥æ¥å—ç”¨äºæè¿°æ˜¯å¦åŒ…æ‹¬ï¼ˆæˆ–ä¸åŒ…æ‹¬ï¼‰ä¸‹è¾¹ç•Œå’Œä¸Šè¾¹ç•Œçš„é™„åŠ å‚æ•°ã€‚ä»»ä½• NavigableMap çš„ Submap å¿…é¡»å®ç° NavigableMap æ¥å£ã€‚</p>
<p>æ­¤å¤–ï¼Œæ­¤æ¥å£è¿˜å®šä¹‰äº† <code>firstEntry</code>ã€<code>pollFirstEntry</code>ã€<code>lastEntry</code> å’Œ <code>pollLastEntry</code> æ–¹æ³•ï¼Œå®ƒä»¬è¿”å›å’Œ/æˆ–ç§»é™¤æœ€å°å’Œæœ€å¤§çš„æ˜ å°„å…³ç³»ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œå¦åˆ™è¿”å› nullã€‚</p>
<h4 id="å¯¼èˆªæ–¹æ³•ç¤ºä¾‹">å¯¼èˆªæ–¹æ³•ç¤ºä¾‹</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">NavigableMap&lt;String, String&gt; navigableMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;();<br>navigableMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>navigableMap.put(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br><br><span class="hljs-comment">// ceilingEntry: è¿”å›å¤§äºç­‰äºæŒ‡å®šé”®çš„æœ€å°æ¡ç›®</span><br>Map.Entry&lt;String, String&gt; ceilingEntry = navigableMap.ceilingEntry(<span class="hljs-string">&quot;c&quot;</span>); <span class="hljs-comment">// (&quot;c&quot;, &quot;3&quot;)</span><br><br><span class="hljs-comment">// floorEntry: è¿”å›å°äºç­‰äºæŒ‡å®šé”®çš„æœ€å¤§æ¡ç›®</span><br>Map.Entry&lt;String, String&gt; floorEntry = navigableMap.floorEntry(<span class="hljs-string">&quot;c&quot;</span>); <span class="hljs-comment">// (&quot;c&quot;, &quot;3&quot;)</span><br><br><span class="hljs-comment">// higherEntry: è¿”å›å¤§äºæŒ‡å®šé”®çš„æœ€å°æ¡ç›®</span><br>Map.Entry&lt;String, String&gt; higherEntry = navigableMap.higherEntry(<span class="hljs-string">&quot;c&quot;</span>); <span class="hljs-comment">// (&quot;d&quot;, &quot;4&quot;)</span><br><br><span class="hljs-comment">// lowerEntry: è¿”å›å°äºæŒ‡å®šé”®çš„æœ€å¤§æ¡ç›®</span><br>Map.Entry&lt;String, String&gt; lowerEntry = navigableMap.lowerEntry(<span class="hljs-string">&quot;c&quot;</span>); <span class="hljs-comment">// (&quot;b&quot;, &quot;2&quot;)</span><br></code></pre></td></tr></table></figure>
<h4 id="èŒƒå›´è§†å›¾ç¤ºä¾‹">èŒƒå›´è§†å›¾ç¤ºä¾‹</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">NavigableMap&lt;String, String&gt; original = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;();<br>original.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br>original.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>);<br>original.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>);<br>original.put(<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>);<br>original.put(<span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>);<br><br><span class="hljs-comment">// headMap: è¿”å›ä¸¥æ ¼å°äºæŒ‡å®šé”®çš„è§†å›¾</span><br>SortedMap&lt;String, String&gt; headmap1 = original.headMap(<span class="hljs-string">&quot;3&quot;</span>); <span class="hljs-comment">// åŒ…å« &quot;1&quot;, &quot;2&quot;</span><br><br><span class="hljs-comment">// headMap å¸¦ inclusive å‚æ•°</span><br>NavigableMap&lt;String, String&gt; headmap2 = original.headMap(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// åŒ…å« &quot;1&quot;, &quot;2&quot;, &quot;3&quot;</span><br><br><span class="hljs-comment">// subMap: è¿”å›æŒ‡å®šèŒƒå›´çš„è§†å›¾</span><br>NavigableMap&lt;String, String&gt; submap2 = original.subMap(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// åŒ…å« &quot;2&quot;, &quot;3&quot;, &quot;4&quot;</span><br><br><span class="hljs-comment">// tailMap: è¿”å›å¤§äºç­‰äºæŒ‡å®šé”®çš„è§†å›¾</span><br>NavigableMap&lt;String, String&gt; tailMap = original.tailMap(<span class="hljs-string">&quot;3&quot;</span>); <span class="hljs-comment">// åŒ…å« &quot;3&quot;, &quot;4&quot;, &quot;5&quot;</span><br></code></pre></td></tr></table></figure>
<h4 id="é™åºè§†å›¾ä¸è¾¹ç•Œæ“ä½œ">é™åºè§†å›¾ä¸è¾¹ç•Œæ“ä½œ</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é™åºéå†</span><br>NavigableSet&lt;String&gt; reverse = navigableMap.descendingKeySet();<br><br><span class="hljs-comment">// pollFirstEntry: ç§»é™¤å¹¶è¿”å›ç¬¬ä¸€ä¸ªæ¡ç›®</span><br>Map.Entry&lt;String, String&gt; first = navigableMap.pollFirstEntry(); <span class="hljs-comment">// (&quot;a&quot;, &quot;1&quot;)</span><br><br><span class="hljs-comment">// pollLastEntry: ç§»é™¤å¹¶è¿”å›æœ€åä¸€ä¸ªæ¡ç›®</span><br>Map.Entry&lt;String, String&gt; last = navigableMap.pollLastEntry(); <span class="hljs-comment">// (&quot;e&quot;, &quot;5&quot;)</span><br></code></pre></td></tr></table></figure>
<h3 id="abstractlist-ä¸-abstractsequentiallist">AbstractList ä¸ AbstractSequentialList</h3>
<h4 id="abstractlist">AbstractList</h4>
<p>AbstractList çš„è¿­ä»£å™¨æ˜¯ä¸å¯å˜çš„ ListIteratorï¼Œåªæœ‰ <code>hasNext()</code>ã€<code>hasPrevious()</code>ã€<code>next()</code>ã€<code>previous()</code>ï¼Œè¿˜æœ‰å‡ ä¸ªè·å–ä½ç½®çš„æ–¹æ³•â€”â€”æ²¡æœ‰å¢åˆ æ”¹æŸ¥çš„æ“ä½œã€‚</p>
<h4 id="abstractsequentiallist">AbstractSequentialList</h4>
<p>AbstractSequentialList æ˜¯æŠ½è±¡çº¿æ€§è¡¨ï¼Œå°±æ˜¯æ•°æ®ç»“æ„é‡Œçš„çº¿æ€§è¡¨ï¼Œæ˜¯é¡ºåºè¡¨å’Œé“¾è¡¨çš„åŸºç±»å‹ï¼Œä½†åœ¨ Java é‡Œåªæ˜¯ LinkedListã€‚</p>
<p>å®ƒçš„è¿­ä»£å™¨åœ¨ ListIterator åŸºç¡€ä¸Šå¢åŠ äº† <code>add</code>ã€<code>remove</code> ç­‰æ“ä½œã€‚</p>
<h2 id="é˜Ÿåˆ—ä½“ç³»">é˜Ÿåˆ—ä½“ç³»</h2>
<h3 id="é˜Ÿåˆ—çš„å…­ä¸ªæ“ä½œ">é˜Ÿåˆ—çš„å…­ä¸ªæ“ä½œ</h3>
<p>Queue æ¥å£å®šä¹‰äº†å…­ä¸ªæ ¸å¿ƒæ“ä½œï¼Œåˆ†ä¸ºä¸‰ç±»ï¼š</p>
<h4 id="æ·»åŠ æ“ä½œ">æ·»åŠ æ“ä½œ</h4>
<ul>
<li><code>add(E e)</code>ï¼šå°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚å¦‚æœå¯ä»¥ç«‹å³æ’å…¥è€Œä¸è¶…è¿‡é˜Ÿåˆ—çš„å®¹é‡ï¼Œåˆ™è¿”å› trueï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡åˆ™æŠ›å‡º IllegalStateException</li>
<li><code>offer(E e)</code>ï¼šå°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚å¦‚æœå¯ä»¥ç«‹å³æ’å…¥è€Œä¸è¶…è¿‡é˜Ÿåˆ—çš„å®¹é‡ï¼Œåˆ™è¿”å› trueï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡åˆ™è¿”å› false</li>
<li><code>put(E e)</code>ï¼šå°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡åˆ™ç­‰å¾…ç©ºé—´å˜ä¸ºå¯ç”¨</li>
</ul>
<h4 id="æŸ¥è¯¢æ“ä½œ">æŸ¥è¯¢æ“ä½œ</h4>
<ul>
<li><code>peek()</code>ï¼šæ£€ç´¢ä½†ä¸ç§»é™¤æ­¤é˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œå¦‚æœæ­¤é˜Ÿåˆ—ä¸ºç©ºåˆ™è¿”å› null</li>
</ul>
<h4 id="ç§»é™¤æ“ä½œ">ç§»é™¤æ“ä½œ</h4>
<ul>
<li><code>poll()</code>ï¼šæ£€ç´¢å¹¶ç§»é™¤æ­¤é˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œå¦‚æœæ­¤é˜Ÿåˆ—ä¸ºç©ºåˆ™è¿”å› null</li>
<li><code>take()</code>ï¼šæ£€ç´¢å¹¶ç§»é™¤æ­¤é˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œå¦‚æœ‰å¿…è¦åˆ™ç­‰å¾…ç›´åˆ°å…ƒç´ å˜ä¸ºå¯ç”¨</li>
</ul>
<p>å¹³æ—¶æœ€å¸¸ç”¨çš„æ˜¯ <code>put</code> å’Œ <code>take</code>ï¼Œå®ƒä»¬æ˜¯é˜»å¡æ“ä½œã€‚éé˜»å¡æ“ä½œå¯ä»¥åŠ ä¸€å¥—é™æ—¶å‚æ•°å˜æˆéƒ¨åˆ†é˜»å¡æ“ä½œã€‚</p>
<h3 id="priorityqueue">PriorityQueue</h3>
<p>PriorityQueue æ˜¯ä¸€ä¸ªåŸºäºä¼˜å…ˆçº§å †çš„æ— ç•Œä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚å…ƒç´ çš„ä¼˜å…ˆçº§é€šè¿‡è‡ªç„¶é¡ºåºï¼ˆå®ç° Comparableï¼‰æˆ–æ„é€ æ—¶æä¾›çš„ Comparator å†³å®šã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è‡ªç„¶é¡ºåº</span><br>PriorityQueue&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();<br>queue.offer(<span class="hljs-number">5</span>);<br>queue.offer(<span class="hljs-number">1</span>);<br>queue.offer(<span class="hljs-number">3</span>);<br><br><span class="hljs-comment">// å‡ºé˜Ÿé¡ºåºï¼š1, 3, 5</span><br><span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;<br>    System.out.println(queue.poll());<br>&#125;<br><br><span class="hljs-comment">// è‡ªå®šä¹‰ Comparator</span><br>PriorityQueue&lt;String&gt; customQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; b.compareTo(a));<br>customQueue.offer(<span class="hljs-string">&quot;A&quot;</span>);<br>customQueue.offer(<span class="hljs-string">&quot;C&quot;</span>);<br>customQueue.offer(<span class="hljs-string">&quot;B&quot;</span>);<br><br><span class="hljs-comment">// å‡ºé˜Ÿé¡ºåºï¼šC, B, Aï¼ˆé™åºï¼‰</span><br><span class="hljs-keyword">while</span> (!customQueue.isEmpty()) &#123;<br>    System.out.println(customQueue.poll());<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="top-k-é—®é¢˜">Top-K é—®é¢˜</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ‰¾å‡ºæœ€å¤§çš„ K ä¸ªå…ƒç´ </span><br><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">topK</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> k)</span> &#123;<br>    PriorityQueue&lt;Integer&gt; minHeap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>        minHeap.offer(num);<br>        <span class="hljs-keyword">if</span> (minHeap.size() &gt; k) &#123;<br>            minHeap.poll(); <span class="hljs-comment">// ç§»é™¤æœ€å°çš„ï¼Œä¿ç•™æœ€å¤§çš„ K ä¸ª</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(minHeap);<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡è°ƒåº¦">ä»»åŠ¡è°ƒåº¦</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Task&gt; &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> priority;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Task</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> priority)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.priority = priority;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Task other)</span> &#123;<br>        <span class="hljs-keyword">return</span> Integer.compare(other.priority, <span class="hljs-built_in">this</span>.priority); <span class="hljs-comment">// ä¼˜å…ˆçº§é«˜çš„å…ˆæ‰§è¡Œ</span><br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name + <span class="hljs-string">&quot; (priority: &quot;</span> + priority + <span class="hljs-string">&quot;)&quot;</span>;<br>    &#125;<br>&#125;<br><br>PriorityQueue&lt;Task&gt; scheduler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();<br>scheduler.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Task</span>(<span class="hljs-string">&quot;Task A&quot;</span>, <span class="hljs-number">3</span>));<br>scheduler.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Task</span>(<span class="hljs-string">&quot;Task B&quot;</span>, <span class="hljs-number">1</span>));<br>scheduler.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Task</span>(<span class="hljs-string">&quot;Task C&quot;</span>, <span class="hljs-number">2</span>));<br><br><span class="hljs-comment">// æ‰§è¡Œé¡ºåºï¼šTask B (priority: 1), Task C (priority: 2), Task A (priority: 3)</span><br><span class="hljs-keyword">while</span> (!scheduler.isEmpty()) &#123;<br>    System.out.println(scheduler.poll());<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šä¼˜å…ˆçº§å †</strong></p>
<p>å½“éœ€è¦æŒ‰ä¼˜å…ˆçº§å¤„ç†å…ƒç´ æ—¶ï¼ŒPriorityQueue æä¾›äº†åŸºäºå †çš„é«˜æ•ˆå®ç°ã€‚é€‚ç”¨äº Top-K é—®é¢˜ã€ä»»åŠ¡è°ƒåº¦ã€äº‹ä»¶å¤„ç†ç­‰åœºæ™¯ã€‚</p>
<h3 id="delayqueue">DelayQueue</h3>
<p>DelayQueue æ˜¯ä¸€ä¸ªæ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œåªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»ä¸­æå–å…ƒç´ ã€‚å…ƒç´ å¿…é¡»å®ç° <code>Delayed</code> æ¥å£ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DelayedElement</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Delayed</span> &#123;<br>    <span class="hljs-keyword">private</span> String data;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> delayTime; <span class="hljs-comment">// åˆ°æœŸæ—¶é—´</span><br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DelayedElement</span><span class="hljs-params">(<span class="hljs-type">long</span> delay, String data)</span> &#123;<br>        <span class="hljs-built_in">this</span>.delayTime = System.currentTimeMillis() + delay;<br>        <span class="hljs-built_in">this</span>.data = data;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getDelay</span><span class="hljs-params">(TimeUnit unit)</span> &#123;<br>        <span class="hljs-keyword">return</span> unit.convert(delayTime - System.currentTimeMillis(), TimeUnit.MILLISECONDS);<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Delayed other)</span> &#123;<br>        <span class="hljs-keyword">return</span> Long.compare(<span class="hljs-built_in">this</span>.delayTime, ((DelayedElement) other).delayTime);<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> data;<br>    &#125;<br>&#125;<br><br>DelayQueue&lt;DelayedElement&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayQueue</span>&lt;&gt;();<br>queue.put(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayedElement</span>(<span class="hljs-number">3000</span>, <span class="hljs-string">&quot;Task 1&quot;</span>)); <span class="hljs-comment">// 3ç§’ååˆ°æœŸ</span><br>queue.put(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayedElement</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">&quot;Task 2&quot;</span>)); <span class="hljs-comment">// 1ç§’ååˆ°æœŸ</span><br>queue.put(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayedElement</span>(<span class="hljs-number">2000</span>, <span class="hljs-string">&quot;Task 3&quot;</span>)); <span class="hljs-comment">// 2ç§’ååˆ°æœŸ</span><br><br><span class="hljs-comment">// take() ä¼šé˜»å¡ç›´åˆ°æœ‰å…ƒç´ åˆ°æœŸ</span><br><span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;<br>    <span class="hljs-type">DelayedElement</span> <span class="hljs-variable">element</span> <span class="hljs-operator">=</span> queue.take();<br>    System.out.println(<span class="hljs-string">&quot;Processed: &quot;</span> + element + <span class="hljs-string">&quot; at &quot;</span> + System.currentTimeMillis());<br>&#125;<br><span class="hljs-comment">// è¾“å‡ºé¡ºåºï¼šTask 2 (1ç§’å), Task 3 (2ç§’å), Task 1 (3ç§’å)</span><br></code></pre></td></tr></table></figure>
<h4 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h4>
<p><strong>ç¼“å­˜è¿‡æœŸ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheEntry</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Delayed</span> &#123;<br>    <span class="hljs-keyword">private</span> String key;<br>    <span class="hljs-keyword">private</span> Object value;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> expireTime;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CacheEntry</span><span class="hljs-params">(String key, Object value, <span class="hljs-type">long</span> ttl)</span> &#123;<br>        <span class="hljs-built_in">this</span>.key = key;<br>        <span class="hljs-built_in">this</span>.value = value;<br>        <span class="hljs-built_in">this</span>.expireTime = System.currentTimeMillis() + ttl;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getDelay</span><span class="hljs-params">(TimeUnit unit)</span> &#123;<br>        <span class="hljs-keyword">return</span> unit.convert(expireTime - System.currentTimeMillis(), TimeUnit.MILLISECONDS);<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Delayed other)</span> &#123;<br>        <span class="hljs-keyword">return</span> Long.compare(<span class="hljs-built_in">this</span>.expireTime, ((CacheEntry) other).expireTime);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExpiringCache</span> &#123;<br>    <span class="hljs-keyword">private</span> DelayQueue&lt;CacheEntry&gt; expireQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayQueue</span>&lt;&gt;();<br>    <span class="hljs-keyword">private</span> Map&lt;String, CacheEntry&gt; cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(String key, Object value, <span class="hljs-type">long</span> ttl)</span> &#123;<br>        <span class="hljs-type">CacheEntry</span> <span class="hljs-variable">entry</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CacheEntry</span>(key, value, ttl);<br>        cache.put(key, entry);<br>        expireQueue.put(entry);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">get</span><span class="hljs-params">(String key)</span> &#123;<br>        <span class="hljs-type">CacheEntry</span> <span class="hljs-variable">entry</span> <span class="hljs-operator">=</span> cache.get(key);<br>        <span class="hljs-keyword">return</span> entry != <span class="hljs-literal">null</span> ? entry.value : <span class="hljs-literal">null</span>;<br>    &#125;<br>    <br>    <span class="hljs-comment">// åå°çº¿ç¨‹æ¸…ç†è¿‡æœŸæ¡ç›®</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startCleanup</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-type">CacheEntry</span> <span class="hljs-variable">expired</span> <span class="hljs-operator">=</span> expireQueue.take();<br>                    cache.remove(expired.key);<br>                    System.out.println(<span class="hljs-string">&quot;Expired: &quot;</span> + expired.key);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;).start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>è®¢å•è¶…æ—¶å–æ¶ˆ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Delayed</span> &#123;<br>    <span class="hljs-keyword">private</span> String orderId;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> createTime;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> timeout; <span class="hljs-comment">// è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span><br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Order</span><span class="hljs-params">(String orderId, <span class="hljs-type">long</span> timeout)</span> &#123;<br>        <span class="hljs-built_in">this</span>.orderId = orderId;<br>        <span class="hljs-built_in">this</span>.createTime = System.currentTimeMillis();<br>        <span class="hljs-built_in">this</span>.timeout = timeout;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getDelay</span><span class="hljs-params">(TimeUnit unit)</span> &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">remaining</span> <span class="hljs-operator">=</span> (createTime + timeout) - System.currentTimeMillis();<br>        <span class="hljs-keyword">return</span> unit.convert(remaining, TimeUnit.MILLISECONDS);<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Delayed other)</span> &#123;<br>        <span class="hljs-keyword">return</span> Long.compare(<br>            <span class="hljs-built_in">this</span>.createTime + <span class="hljs-built_in">this</span>.timeout,<br>            ((Order) other).createTime + ((Order) other).timeout<br>        );<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancel</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Order cancelled: &quot;</span> + orderId);<br>        <span class="hljs-comment">// å–æ¶ˆè®¢å•é€»è¾‘</span><br>    &#125;<br>&#125;<br><br>DelayQueue&lt;Order&gt; orderQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayQueue</span>&lt;&gt;();<br><br><span class="hljs-comment">// åˆ›å»ºè®¢å•ï¼Œ30åˆ†é’Ÿæœªæ”¯ä»˜è‡ªåŠ¨å–æ¶ˆ</span><br><span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>(<span class="hljs-string">&quot;ORD-001&quot;</span>, <span class="hljs-number">30</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>);<br>orderQueue.put(order);<br><br><span class="hljs-comment">// åå°çº¿ç¨‹å¤„ç†è¶…æ—¶è®¢å•</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Order</span> <span class="hljs-variable">expiredOrder</span> <span class="hljs-operator">=</span> orderQueue.take();<br>            expiredOrder.cancel();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;).start();<br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šæ—¶é—´é©±åŠ¨çš„ä»»åŠ¡è°ƒåº¦</strong></p>
<p>å½“éœ€è¦åœ¨æŒ‡å®šæ—¶é—´ç‚¹æ‰§è¡Œä»»åŠ¡æ—¶ï¼ŒDelayQueue æä¾›äº†åŸºäºä¼˜å…ˆçº§çš„é˜»å¡é˜Ÿåˆ—å®ç°ï¼Œé¿å…äº†å®šæ—¶è½®è¯¢çš„æ€§èƒ½å¼€é”€ã€‚é€‚ç”¨äºç¼“å­˜è¿‡æœŸã€è®¢å•è¶…æ—¶ã€å®šæ—¶ä»»åŠ¡ç­‰æ—¶é—´æ•æ„Ÿåœºæ™¯ã€‚</p>
<h2 id="æœ‰åºé›†åˆ">æœ‰åºé›†åˆ</h2>
<h3 id="treeset-ä¸-treemap">TreeSet ä¸ TreeMap</h3>
<p>TreeSet å’Œ TreeMap æ˜¯åŸºäºçº¢é»‘æ ‘å®ç°çš„æœ‰åºé›†åˆï¼Œèƒ½å¤Ÿè‡ªåŠ¨ç»´æŠ¤å…ƒç´ çš„æ’åºé¡ºåºï¼Œå¹¶æä¾›èŒƒå›´æŸ¥è¯¢åŠŸèƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// TreeSet: è‡ªåŠ¨æ’åº</span><br>TreeSet&lt;Integer&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeSet</span>&lt;&gt;();<br>set.add(<span class="hljs-number">5</span>);<br>set.add(<span class="hljs-number">2</span>);<br>set.add(<span class="hljs-number">8</span>);<br>set.add(<span class="hljs-number">1</span>);<br><br>System.out.println(set); <span class="hljs-comment">// [1, 2, 5, 8]</span><br><br><span class="hljs-comment">// èŒƒå›´æŸ¥è¯¢</span><br>System.out.println(set.subSet(<span class="hljs-number">2</span>, <span class="hljs-number">8</span>)); <span class="hljs-comment">// [2, 5]</span><br>System.out.println(set.headSet(<span class="hljs-number">5</span>)); <span class="hljs-comment">// [1, 2]</span><br>System.out.println(set.tailSet(<span class="hljs-number">5</span>)); <span class="hljs-comment">// [5, 8]</span><br><br><span class="hljs-comment">// TreeMap: æŒ‰é”®æ’åº</span><br>TreeMap&lt;String, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;();<br>map.put(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">3</span>);<br>map.put(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">1</span>);<br>map.put(<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-number">2</span>);<br><br>System.out.println(map.keySet()); <span class="hljs-comment">// [A, B, C]</span><br><br><span class="hljs-comment">// èŒƒå›´æŸ¥è¯¢</span><br>System.out.println(map.subMap(<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;D&quot;</span>)); <span class="hljs-comment">// &#123;B=2, C=3&#125;</span><br></code></pre></td></tr></table></figure>
<h4 id="è‡ªå®šä¹‰æ’åº">è‡ªå®šä¹‰æ’åº</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é™åºæ’åº</span><br>TreeSet&lt;Integer&gt; reverseSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeSet</span>&lt;&gt;((a, b) -&gt; b - a);<br>reverseSet.add(<span class="hljs-number">1</span>);<br>reverseSet.add(<span class="hljs-number">3</span>);<br>reverseSet.add(<span class="hljs-number">2</span>);<br>System.out.println(reverseSet); <span class="hljs-comment">// [3, 2, 1]</span><br><br><span class="hljs-comment">// TreeMap è‡ªå®šä¹‰ Comparator</span><br>TreeMap&lt;String, Integer&gt; customMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;(String.CASE_INSENSITIVE_ORDER);<br>customMap.put(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-number">1</span>);<br>customMap.put(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">2</span>);<br>System.out.println(customMap); <span class="hljs-comment">// &#123;a=2&#125;ï¼ˆ&quot;A&quot; è¦†ç›–äº† &quot;a&quot;ï¼‰</span><br></code></pre></td></tr></table></figure>
<h4 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h4>
<p><strong>æ’è¡Œæ¦œ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Player</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Player&gt; &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> score;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Player</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> score)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.score = score;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Player other)</span> &#123;<br>        <span class="hljs-keyword">return</span> Integer.compare(other.score, <span class="hljs-built_in">this</span>.score); <span class="hljs-comment">// åˆ†æ•°é«˜çš„åœ¨å‰</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> name; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getScore</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> score; &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name + <span class="hljs-string">&quot;: &quot;</span> + score;<br>    &#125;<br>&#125;<br><br>TreeSet&lt;Player&gt; leaderboard = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeSet</span>&lt;&gt;();<br>leaderboard.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Player</span>(<span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-number">100</span>));<br>leaderboard.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Player</span>(<span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-number">150</span>));<br>leaderboard.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Player</span>(<span class="hljs-string">&quot;Charlie&quot;</span>, <span class="hljs-number">120</span>));<br><br><span class="hljs-comment">// è·å–å‰ 3 å</span><br><span class="hljs-type">int</span> <span class="hljs-variable">rank</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">for</span> (Player player : leaderboard) &#123;<br>    System.out.println(rank++ + <span class="hljs-string">&quot;. &quot;</span> + player);<br>    <span class="hljs-keyword">if</span> (rank &gt; <span class="hljs-number">3</span>) <span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-comment">// è¾“å‡ºï¼š</span><br><span class="hljs-comment">// 1. Bob: 150</span><br><span class="hljs-comment">// 2. Charlie: 120</span><br><span class="hljs-comment">// 3. Alice: 100</span><br></code></pre></td></tr></table></figure>
<p><strong>åŒºé—´æŸ¥è¯¢</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä»·æ ¼åŒºé—´æŸ¥è¯¢</span><br>TreeMap&lt;Double, String&gt; priceMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;();<br>priceMap.put(<span class="hljs-number">10.0</span>, <span class="hljs-string">&quot;Product A&quot;</span>);<br>priceMap.put(<span class="hljs-number">25.0</span>, <span class="hljs-string">&quot;Product B&quot;</span>);<br>priceMap.put(<span class="hljs-number">50.0</span>, <span class="hljs-string">&quot;Product C&quot;</span>);<br>priceMap.put(<span class="hljs-number">75.0</span>, <span class="hljs-string">&quot;Product D&quot;</span>);<br><br><span class="hljs-comment">// æŸ¥è¯¢ä»·æ ¼åœ¨ 20-60 ä¹‹é—´çš„äº§å“</span><br>NavigableMap&lt;Double, String&gt; range = priceMap.subMap(<span class="hljs-number">20.0</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">60.0</span>, <span class="hljs-literal">true</span>);<br>System.out.println(range); <span class="hljs-comment">// &#123;25.0=Product B, 50.0=Product C&#125;</span><br><br><span class="hljs-comment">// æŸ¥è¯¢ä»·æ ¼ä½äº 30 çš„äº§å“</span><br>System.out.println(priceMap.headMap(<span class="hljs-number">30.0</span>, <span class="hljs-literal">true</span>)); <span class="hljs-comment">// &#123;10.0=Product A, 25.0=Product B&#125;</span><br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šè‡ªåŠ¨æ’åºä¸èŒƒå›´æŸ¥è¯¢</strong></p>
<p>å½“éœ€è¦ç»´æŠ¤æœ‰åºæ•°æ®æˆ–æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢æ—¶ï¼ŒTreeSet/TreeMap æä¾›äº†é«˜æ•ˆçš„å®ç°ã€‚é€‚ç”¨äºæ’è¡Œæ¦œã€åŒºé—´æŸ¥è¯¢ã€å­—å…¸ç­‰åœºæ™¯ã€‚</p>
<h3 id="linkedhashmap-ä¸-linkedhashset">LinkedHashMap ä¸ LinkedHashSet</h3>
<p>LinkedHashMap å’Œ LinkedHashSet åœ¨ HashMap/HashSet çš„åŸºç¡€ä¸Šå¢åŠ äº†<strong>é¡ºåºä¿æŒ</strong>åŠŸèƒ½ï¼Œå¯ä»¥æŒ‰ç…§æ’å…¥é¡ºåºæˆ–è®¿é—®é¡ºåºéå†å…ƒç´ ã€‚</p>
<h4 id="ä¿æŒæ’å…¥é¡ºåº">ä¿æŒæ’å…¥é¡ºåº</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// LinkedHashMap é»˜è®¤æŒ‰æ’å…¥é¡ºåºéå†</span><br>LinkedHashMap&lt;String, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();<br>map.put(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">1</span>);<br>map.put(<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-number">2</span>);<br>map.put(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">3</span>);<br><br><span class="hljs-comment">// éå†é¡ºåºï¼šA -&gt; B -&gt; C</span><br><span class="hljs-keyword">for</span> (Map.Entry&lt;String, Integer&gt; entry : map.entrySet()) &#123;<br>    System.out.println(entry.getKey() + <span class="hljs-string">&quot;: &quot;</span> + entry.getValue());<br>&#125;<br><br><span class="hljs-comment">// LinkedHashSet åŒç†</span><br>LinkedHashSet&lt;String&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashSet</span>&lt;&gt;();<br>set.add(<span class="hljs-string">&quot;A&quot;</span>);<br>set.add(<span class="hljs-string">&quot;B&quot;</span>);<br>set.add(<span class="hljs-string">&quot;C&quot;</span>);<br>System.out.println(set); <span class="hljs-comment">// [A, B, C]</span><br></code></pre></td></tr></table></figure>
<h4 id="ä¿æŒè®¿é—®é¡ºåº-lru-ç¼“å­˜">ä¿æŒè®¿é—®é¡ºåºï¼ˆLRU ç¼“å­˜ï¼‰</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// accessOrder=trueï¼šæŒ‰è®¿é—®é¡ºåºéå†</span><br>LinkedHashMap&lt;String, Integer&gt; lruCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;(<span class="hljs-number">16</span>, <span class="hljs-number">0.75f</span>, <span class="hljs-literal">true</span>) &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">removeEldestEntry</span><span class="hljs-params">(Map.Entry&lt;String, Integer&gt; eldest)</span> &#123;<br>        <span class="hljs-keyword">return</span> size() &gt; <span class="hljs-number">3</span>; <span class="hljs-comment">// ç¼“å­˜å¤§å°é™åˆ¶ä¸º 3</span><br>    &#125;<br>&#125;;<br><br>lruCache.put(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">1</span>);<br>lruCache.put(<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-number">2</span>);<br>lruCache.put(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">3</span>);<br><br><span class="hljs-comment">// è®¿é—® &quot;A&quot;ï¼Œå°†å…¶ç§»åˆ°æœ«å°¾</span><br>lruCache.get(<span class="hljs-string">&quot;A&quot;</span>);<br><br><span class="hljs-comment">// æ·»åŠ  &quot;D&quot;ï¼Œè§¦å‘ eldest ç§»é™¤ï¼ˆ&quot;B&quot; æ˜¯æœ€ä¹…æœªè®¿é—®çš„ï¼‰</span><br>lruCache.put(<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-number">4</span>);<br><br><span class="hljs-comment">// å½“å‰é¡ºåºï¼šC -&gt; A -&gt; D</span><br>System.out.println(lruCache.keySet()); <span class="hljs-comment">// [C, A, D]</span><br></code></pre></td></tr></table></figure>
<h4 id="lru-ç¼“å­˜å®ç°">LRU ç¼“å­˜å®ç°</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LRUCache</span>&lt;K, V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;K, V&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> maxSize;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">LRUCache</span><span class="hljs-params">(<span class="hljs-type">int</span> maxSize)</span> &#123;<br>        <span class="hljs-built_in">super</span>(<span class="hljs-number">16</span>, <span class="hljs-number">0.75f</span>, <span class="hljs-literal">true</span>);<br>        <span class="hljs-built_in">this</span>.maxSize = maxSize;<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">removeEldestEntry</span><span class="hljs-params">(Map.Entry&lt;K, V&gt; eldest)</span> &#123;<br>        <span class="hljs-keyword">return</span> size() &gt; maxSize;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span><br>LRUCache&lt;String, String&gt; cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LRUCache</span>&lt;&gt;(<span class="hljs-number">3</span>);<br>cache.put(<span class="hljs-string">&quot;key1&quot;</span>, <span class="hljs-string">&quot;value1&quot;</span>);<br>cache.put(<span class="hljs-string">&quot;key2&quot;</span>, <span class="hljs-string">&quot;value2&quot;</span>);<br>cache.put(<span class="hljs-string">&quot;key3&quot;</span>, <span class="hljs-string">&quot;value3&quot;</span>);<br><br>cache.get(<span class="hljs-string">&quot;key1&quot;</span>); <span class="hljs-comment">// è®¿é—® key1</span><br>cache.put(<span class="hljs-string">&quot;key4&quot;</span>, <span class="hljs-string">&quot;value4&quot;</span>); <span class="hljs-comment">// æ·»åŠ  key4ï¼Œç§»é™¤ key2ï¼ˆæœ€ä¹…æœªè®¿é—®ï¼‰</span><br><br>System.out.println(cache.keySet()); <span class="hljs-comment">// [key3, key1, key4]</span><br></code></pre></td></tr></table></figure>
<h4 id="æ€§èƒ½å¯¹æ¯”">æ€§èƒ½å¯¹æ¯”</h4>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>HashMap</th>
<th>LinkedHashMap</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ’å…¥/åˆ é™¤</td>
<td>O(1)</td>
<td>O(1)</td>
</tr>
<tr>
<td>æŸ¥æ‰¾</td>
<td>O(1)</td>
<td>O(1)</td>
</tr>
<tr>
<td>éå†é¡ºåº</td>
<td>æ— åº</td>
<td>æ’å…¥é¡ºåº/è®¿é—®é¡ºåº</td>
</tr>
<tr>
<td>å†…å­˜å¼€é”€</td>
<td>è¾ƒå°</td>
<td>è¾ƒå¤§ï¼ˆç»´æŠ¤åŒå‘é“¾è¡¨ï¼‰</td>
</tr>
</tbody>
</table>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šæœ‰åºé›†åˆä¸ LRU ç¼“å­˜</strong></p>
<p>å½“éœ€è¦ä¿æŒå…ƒç´ é¡ºåºæˆ–å®ç° LRU ç¼“å­˜æ—¶ï¼ŒLinkedHashMap/LinkedHashSet æä¾›äº†æ¯”æ‰‹åŠ¨ç»´æŠ¤é¡ºåºæ›´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚é€‚ç”¨äºå†å²è®°å½•ã€æœ€è¿‘è®¿é—®åˆ—è¡¨ã€ç¼“å­˜æ·˜æ±°ç­‰åœºæ™¯ã€‚</p>
<h2 id="æšä¸¾ä¸“ç”¨é›†åˆ">æšä¸¾ä¸“ç”¨é›†åˆ</h2>
<h3 id="enumset">EnumSet</h3>
<p>EnumSet æ˜¯ä¸“ä¸ºæšä¸¾ç±»å‹è®¾è®¡çš„é«˜æ€§èƒ½ Setï¼Œä½¿ç”¨ä½å‘é‡ï¼ˆBit Vectorï¼‰å­˜å‚¨ï¼Œç©ºé—´å’Œæ—¶é—´æ•ˆç‡æé«˜ã€‚</p>
<h4 id="enumset-çš„é™åˆ¶">EnumSet çš„é™åˆ¶</h4>
<ul>
<li>åªèƒ½åŒ…å«æšä¸¾å€¼ï¼Œä¸”æ‰€æœ‰å€¼å¿…é¡»å±äºåŒä¸€ä¸ªæšä¸¾</li>
<li>ä¸å…è®¸æ·»åŠ  null å€¼ï¼Œå°è¯•æ·»åŠ ä¼šæŠ›å‡º NullPointerException</li>
<li>ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚æœéœ€è¦åˆ™éœ€å¤–éƒ¨åŒæ­¥</li>
<li>å…ƒç´ æŒ‰ç…§æšä¸¾ä¸­å£°æ˜çš„é¡ºåºå­˜å‚¨</li>
<li>ä½¿ç”¨ fail-safe è¿­ä»£å™¨ï¼Œåœ¨è¿­ä»£æ—¶ä¿®æ”¹é›†åˆä¸ä¼šæŠ›å‡º ConcurrentModificationException</li>
</ul>
<h4 id="åˆ›å»ºä¸ä½¿ç”¨">åˆ›å»ºä¸ä½¿ç”¨</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Day</span> &#123;<br>    MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY<br>&#125;<br><br><span class="hljs-comment">// åˆ›å»º EnumSet</span><br>EnumSet&lt;Day&gt; weekdays = EnumSet.of(Day.MONDAY, Day.TUESDAY, Day.WEDNESDAY, <br>                                   Day.THURSDAY, Day.FRIDAY);<br>EnumSet&lt;Day&gt; weekend = EnumSet.of(Day.SATURDAY, Day.SUNDAY);<br><br><span class="hljs-comment">// èŒƒå›´åˆ›å»º</span><br>EnumSet&lt;Day&gt; allDays = EnumSet.allOf(Day.class);<br>EnumSet&lt;Day&gt; noDays = EnumSet.noneOf(Day.class);<br><br><span class="hljs-comment">// è¡¥é›†æ“ä½œ</span><br>EnumSet&lt;Day&gt; complement = EnumSet.complementOf(weekdays); <span class="hljs-comment">// weekend</span><br><br><span class="hljs-comment">// é›†åˆæ“ä½œ</span><br>EnumSet&lt;Day&gt; workDays = EnumSet.range(Day.MONDAY, Day.FRIDAY);<br>System.out.println(workDays.add(Day.SATURDAY)); <span class="hljs-comment">// false (å·²æ»¡)</span><br>System.out.println(workDays.remove(Day.SUNDAY)); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure>
<h4 id="jdk-å®ç°ç»†èŠ‚">JDK å®ç°ç»†èŠ‚</h4>
<p>JDK æä¾›ä¸¤ä¸ªé»˜è®¤å‚è€ƒå®ç°ï¼š</p>
<ul>
<li><strong>RegularEnumSet</strong>ï¼šå½“æšä¸¾å€¼æ•°é‡ â‰¤ 64 æ—¶ï¼Œä½¿ç”¨å•ä¸ª long å€¼ä½œä¸ºä½å‘é‡</li>
<li><strong>JumboEnumSet</strong>ï¼šå½“æšä¸¾å€¼æ•°é‡ &gt; 64 æ—¶ï¼Œä½¿ç”¨ long æ•°ç»„ä½œä¸ºä½å‘é‡</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">EnumSet&lt;InsPayOrderStatusEnum&gt; BAD_FINAL_STATUSES = EnumSet.of(FAILED, CLOSED, BOUNCED);<br></code></pre></td></tr></table></figure>
<h4 id="æ€§èƒ½ä¼˜åŠ¿">æ€§èƒ½ä¼˜åŠ¿</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// EnumSet vs HashSet</span><br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123; RED, GREEN, BLUE, YELLOW &#125;<br><br><span class="hljs-comment">// EnumSet: ä½¿ç”¨å•ä¸ª long å€¼å­˜å‚¨ï¼ˆ64ä½å¯å­˜å‚¨64ä¸ªæšä¸¾ï¼‰</span><br>EnumSet&lt;Color&gt; enumSet = EnumSet.of(Color.RED, Color.GREEN);<br><span class="hljs-comment">// å†…éƒ¨ç»“æ„ï¼šlong = 0b0011 (ä½å‘é‡)</span><br><br><span class="hljs-comment">// HashSet: ä½¿ç”¨æ•°ç»„+é“¾è¡¨å­˜å‚¨</span><br>HashSet&lt;Color&gt; hashSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();<br>hashSet.add(Color.RED);<br>hashSet.add(Color.GREEN);<br><span class="hljs-comment">// å†…éƒ¨ç»“æ„ï¼šNode[] æ•°ç»„ + é“¾è¡¨èŠ‚ç‚¹</span><br><br><span class="hljs-comment">// æ€§èƒ½æµ‹è¯•</span><br>EnumSet&lt;Color&gt; es = EnumSet.allOf(Color.class);<br>HashSet&lt;Color&gt; hs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(Arrays.asList(Color.values()));<br><br><span class="hljs-comment">// EnumSet çš„ contains æ“ä½œï¼šä½è¿ç®— O(1)</span><br><span class="hljs-comment">// HashSet çš„ contains æ“ä½œï¼šå“ˆå¸Œè®¡ç®— + é“¾è¡¨éå† O(1) å¹³å‡</span><br></code></pre></td></tr></table></figure>
<h3 id="enummap">EnumMap</h3>
<p>EnumMap æ˜¯ä¸“ä¸ºæšä¸¾ç±»å‹è®¾è®¡çš„é«˜æ€§èƒ½ Mapï¼Œä½¿ç”¨æ•°ç»„å­˜å‚¨ï¼Œé”®å¿…é¡»æ˜¯æšä¸¾ç±»å‹ã€‚</p>
<h4 id="åˆ›å»ºä¸ä½¿ç”¨">åˆ›å»ºä¸ä½¿ç”¨</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Operation</span> &#123;<br>    ADD, SUBTRACT, MULTIPLY, DIVIDE<br>&#125;<br><br>EnumMap&lt;Operation, String&gt; descriptions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EnumMap</span>&lt;&gt;(Operation.class);<br>descriptions.put(Operation.ADD, <span class="hljs-string">&quot;åŠ æ³•&quot;</span>);<br>descriptions.put(Operation.SUBTRACT, <span class="hljs-string">&quot;å‡æ³•&quot;</span>);<br>descriptions.put(Operation.MULTIPLY, <span class="hljs-string">&quot;ä¹˜æ³•&quot;</span>);<br>descriptions.put(Operation.DIVIDE, <span class="hljs-string">&quot;é™¤æ³•&quot;</span>);<br><br><span class="hljs-comment">// éå†ï¼ˆä¿è¯æŒ‰æšä¸¾å£°æ˜é¡ºåºï¼‰</span><br><span class="hljs-keyword">for</span> (Map.Entry&lt;Operation, String&gt; entry : descriptions.entrySet()) &#123;<br>    System.out.println(entry.getKey() + <span class="hljs-string">&quot;: &quot;</span> + entry.getValue());<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="é«˜çº§ç”¨æ³•">é«˜çº§ç”¨æ³•</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å¤åˆ¶æ„é€ å™¨</span><br>Map&lt;DayOfWeek, String&gt; ordinaryMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>ordinaryMap.put(DayOfWeek.MONDAY, <span class="hljs-string">&quot;Soccer&quot;</span>);<br>EnumMap&lt;DayOfWeek, String&gt; enumMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EnumMap</span>&lt;&gt;(ordinaryMap);<br><br><span class="hljs-comment">// åŒå‚æ•°çš„ remove</span><br>activityMap.put(DayOfWeek.MONDAY, <span class="hljs-string">&quot;Soccer&quot;</span>);<br>assertThat(activityMap.remove(DayOfWeek.MONDAY, <span class="hljs-string">&quot;Hiking&quot;</span>)).isEqualTo(<span class="hljs-literal">false</span>);<br>assertThat(activityMap.remove(DayOfWeek.MONDAY, <span class="hljs-string">&quot;Soccer&quot;</span>)).isEqualTo(<span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure>
<h4 id="æ€§èƒ½ä¼˜åŠ¿">æ€§èƒ½ä¼˜åŠ¿</h4>
<p>ä½¿ç”¨ Enum ä½œä¸º key ä½¿å¾—å¯ä»¥åšä¸€äº›é¢å¤–çš„æ€§èƒ½ä¼˜åŒ–ï¼Œæ¯”å¦‚æ›´å¿«çš„å“ˆå¸Œè®¡ç®—ï¼Œå› ä¸ºæ‰€æœ‰å¯èƒ½çš„é”®éƒ½æ˜¯é¢„å…ˆçŸ¥é“çš„ã€‚</p>
<p>å› ä¸ºæšä¸¾çš„é¡ºåºå·²ç»è¢«äº‹å…ˆçŸ¥é“äº†ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡ŒæŸäº›æè‡´çš„ä¼˜åŒ–ã€‚</p>
<p>EnumMap æ˜¯ä¸€ä¸ªæœ‰åº mapï¼Œå®ƒçš„è§†å›¾ä¼šæŒ‰ç…§æšä¸¾é¡ºåºè¿­ä»£ã€‚è™½ç„¶ LinkedHashMap å’Œ TreeMap ä¹Ÿå¯ä»¥æä¾›ç±»ä¼¼çš„è¡Œä¸ºï¼Œä½† EnumMap çš„æ€§èƒ½æ›´ä¼˜ã€‚</p>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šæšä¸¾ä¸“ç”¨é›†åˆ</strong></p>
<p>å½“é›†åˆå…ƒç´ ç±»å‹æ˜¯æšä¸¾æ—¶ï¼ŒEnumSet/EnumMap æä¾›äº†æ¯”é€šç”¨é›†åˆæ›´å¥½çš„æ€§èƒ½å’Œæ›´ç´§å‡‘çš„å†…å­˜å ç”¨ã€‚é€‚ç”¨äºæ ‡å¿—ä½é›†åˆã€çŠ¶æ€æœºã€é…ç½®ç®¡ç†ç­‰åœºæ™¯ã€‚</p>
<h2 id="ç‰¹æ®Šç”¨é€”é›†åˆ">ç‰¹æ®Šç”¨é€”é›†åˆ</h2>
<h3 id="identityhashmap">IdentityHashMap</h3>
<p>IdentityHashMap çš„ç”¨æ³•å’Œ HashMap çš„ç”¨æ³•å·®ä¸å¤šï¼Œå®ƒä»¬ä¹‹é—´æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ IdentityHashMap åˆ¤æ–­ä¸¤ä¸ª key æ˜¯å¦ç›¸ç­‰ï¼Œæ˜¯é€šè¿‡ä¸¥æ ¼ç›¸ç­‰å³ï¼ˆkey1 == key2ï¼‰æ¥åˆ¤æ–­çš„ï¼Œè€Œ HashMap æ˜¯é€šè¿‡ equals() æ–¹æ³•å’Œ hashCode() è¿™ä¸¤ä¸ªæ–¹æ³•æ¥åˆ¤æ–­ key æ˜¯å¦ç›¸ç­‰çš„ã€‚</p>
<h4 id="ç”¨é€”">ç”¨é€”</h4>
<ul>
<li>éœ€è¦æ¯”å¯¹ç‹¬ä¸€æ— äºŒçš„å¯¹è±¡ï¼Œå¦‚å…¨å±€çš„ classï¼Œå¯ä»¥ç”¨ IdentityHashMap æ¥æ§åˆ¶å”¯ä¸€æ€§</li>
<li>æ·±æ‹·è´çš„æ—¶å€™éœ€è¦å®¹å¿ç›¸åŒçš„å€¼ä¸åŒå¼•ç”¨çš„å¯¹è±¡</li>
</ul>
<h4 id="ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ™®é€š HashMapï¼šåŸºäº equals() å’Œ hashCode()</span><br>HashMap&lt;String, String&gt; hashMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><span class="hljs-type">String</span> <span class="hljs-variable">key1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-type">String</span> <span class="hljs-variable">key2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;test&quot;</span>);<br>hashMap.put(key1, <span class="hljs-string">&quot;value1&quot;</span>);<br>hashMap.put(key2, <span class="hljs-string">&quot;value2&quot;</span>);<br>System.out.println(hashMap.size()); <span class="hljs-comment">// 1ï¼ˆkey1.equals(key2) è¿”å› trueï¼‰</span><br><br><span class="hljs-comment">// IdentityHashMapï¼šåŸºäºå¼•ç”¨ç›¸ç­‰</span><br>IdentityHashMap&lt;String, String&gt; identityMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdentityHashMap</span>&lt;&gt;();<br>identityMap.put(key1, <span class="hljs-string">&quot;value1&quot;</span>);<br>identityMap.put(key2, <span class="hljs-string">&quot;value2&quot;</span>);<br>System.out.println(identityMap.size()); <span class="hljs-comment">// 2ï¼ˆkey1 != key2ï¼‰</span><br></code></pre></td></tr></table></figure>
<h4 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h4>
<p><strong>æ·±æ‹·è´åœºæ™¯</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ·±æ‹·è´æ—¶éœ€è¦åŒºåˆ†ç›¸åŒå€¼çš„ä¸åŒå¼•ç”¨</span><br>IdentityHashMap&lt;Object, Object&gt; visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdentityHashMap</span>&lt;&gt;();<br><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">deepCopy</span><span class="hljs-params">(Object obj)</span> &#123;<br>    <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    <br>    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ç»å¤åˆ¶è¿‡ï¼ˆåŸºäºå¼•ç”¨ï¼‰</span><br>    <span class="hljs-keyword">if</span> (visited.containsKey(obj)) &#123;<br>        <span class="hljs-keyword">return</span> visited.get(obj);<br>    &#125;<br>    <br>    <span class="hljs-type">Object</span> <span class="hljs-variable">copy</span> <span class="hljs-operator">=</span> createCopy(obj);<br>    visited.put(obj, copy); <span class="hljs-comment">// è®°å½•å·²å¤åˆ¶çš„å¯¹è±¡</span><br>    <br>    <span class="hljs-comment">// é€’å½’å¤åˆ¶å¼•ç”¨</span><br>    <span class="hljs-keyword">for</span> (Object ref : getReferences(obj)) &#123;<br>        copyReference(copy, deepCopy(ref));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> copy;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>åºåˆ—åŒ–åœºæ™¯</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åºåˆ—åŒ–æ—¶éœ€è¦ç»´æŠ¤å¯¹è±¡å¼•ç”¨å…³ç³»</span><br>IdentityHashMap&lt;Object, Integer&gt; objectMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdentityHashMap</span>&lt;&gt;();<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj, ObjectOutputStream out)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// ä¸ºæ¯ä¸ªå¯¹è±¡åˆ†é…å”¯ä¸€ IDï¼ˆåŸºäºå¼•ç”¨ï¼‰</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> objectMap.size();<br>    objectMap.put(obj, id);<br>    <br>    out.writeObject(id);<br>    <span class="hljs-comment">// åºåˆ—åŒ–å¯¹è±¡å†…å®¹...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">deserialize</span><span class="hljs-params">(ObjectInputStream in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> in.readInt();<br>    <span class="hljs-comment">// æ ¹æ® ID ååºåˆ—åŒ–å¯¹è±¡...</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šå¼•ç”¨è¯­ä¹‰æ˜ å°„</strong></p>
<p>å½“éœ€è¦åŸºäºå¯¹è±¡å¼•ç”¨è€Œéå¯¹è±¡ç›¸ç­‰æ€§è¿›è¡Œæ˜ å°„æ—¶ï¼ŒIdentityHashMap æä¾›äº†ç²¾ç¡®çš„å¼•ç”¨è¯­ä¹‰ã€‚é€‚ç”¨äºæ·±æ‹·è´ã€åºåˆ—åŒ–ã€å¯¹è±¡è·Ÿè¸ªç­‰åœºæ™¯ã€‚</p>
<h3 id="weakhashmap">WeakHashMap</h3>
<p>WeakHashMap æ˜¯ä¸€ä¸ªä½¿ç”¨å¼±å¼•ç”¨ä½œä¸ºé”®çš„ HashMapã€‚å½“é”®ä¸å†è¢«å¤–éƒ¨å¼•ç”¨æ—¶ï¼Œå®ƒå¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼Œå¯¹åº”çš„é”®å€¼å¯¹ä¹Ÿä¼šè‡ªåŠ¨ä» Map ä¸­ç§»é™¤ã€‚</p>
<h4 id="å¼±å¼•ç”¨æœºåˆ¶">å¼±å¼•ç”¨æœºåˆ¶</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ™®é€š HashMapï¼šé”®è¢«å¼ºå¼•ç”¨</span><br>HashMap&lt;String, String&gt; strongMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;test&quot;</span>);<br>strongMap.put(key, <span class="hljs-string">&quot;value&quot;</span>);<br>key = <span class="hljs-literal">null</span>; <span class="hljs-comment">// key ä»è¢« Map å¼•ç”¨ï¼Œä¸ä¼šè¢« GC</span><br><br><span class="hljs-comment">// WeakHashMapï¼šé”®è¢«å¼±å¼•ç”¨</span><br>WeakHashMap&lt;String, String&gt; weakMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakHashMap</span>&lt;&gt;();<br>key = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;test&quot;</span>);<br>weakMap.put(key, <span class="hljs-string">&quot;value&quot;</span>);<br>key = <span class="hljs-literal">null</span>; <span class="hljs-comment">// key ä¸å†è¢«å¼ºå¼•ç”¨ï¼ŒGC æ—¶ä¼šè¢«å›æ”¶</span><br><br>System.gc(); <span class="hljs-comment">// è§¦å‘ GC</span><br>System.out.println(weakMap.size()); <span class="hljs-comment">// å¯èƒ½è¾“å‡º 0</span><br></code></pre></td></tr></table></figure>
<h4 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h4>
<p><strong>ç¼“å­˜å®ç°</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeakCache</span>&lt;K, V&gt; &#123;<br>    <span class="hljs-keyword">private</span> WeakHashMap&lt;K, V&gt; cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakHashMap</span>&lt;&gt;();<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(K key, V value)</span> &#123;<br>        cache.put(key, value);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> V <span class="hljs-title function_">get</span><span class="hljs-params">(K key)</span> &#123;<br>        <span class="hljs-keyword">return</span> cache.get(key);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> cache.size();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨åœºæ™¯ï¼šç¼“å­˜å¤§å¯¹è±¡ï¼Œå½“å†…å­˜ä¸è¶³æ—¶è‡ªåŠ¨é‡Šæ”¾</span><br>WeakCache&lt;String, <span class="hljs-type">byte</span>[]&gt; imageCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakCache</span>&lt;&gt;();<br>imageCache.put(<span class="hljs-string">&quot;image1&quot;</span>, loadLargeImage(<span class="hljs-string">&quot;image1.jpg&quot;</span>));<br><span class="hljs-comment">// å½“å†…å­˜ç´§å¼ æ—¶ï¼Œè¿™äº›å¤§å¯¹è±¡ä¼šè¢«è‡ªåŠ¨å›æ”¶</span><br></code></pre></td></tr></table></figure>
<p><strong>å¯¹è±¡å…ƒæ•°æ®å…³è”</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä¸ºå¯¹è±¡é™„åŠ å…ƒæ•°æ®ï¼Œä¸é˜»æ­¢å¯¹è±¡è¢«å›æ”¶</span><br>WeakHashMap&lt;Object, Map&lt;String, Object&gt;&gt; metadataMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakHashMap</span>&lt;&gt;();<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attachMetadata</span><span class="hljs-params">(Object obj, String key, Object value)</span> &#123;<br>    metadataMap.computeIfAbsent(obj, k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;()).put(key, value);<br>&#125;<br><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getMetadata</span><span class="hljs-params">(Object obj, String key)</span> &#123;<br>    Map&lt;String, Object&gt; metadata = metadataMap.get(obj);<br>    <span class="hljs-keyword">return</span> metadata != <span class="hljs-literal">null</span> ? metadata.get(key) : <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">// å½“ obj ä¸å†è¢«ä½¿ç”¨æ—¶ï¼Œå…¶å…ƒæ•°æ®ä¹Ÿä¼šè‡ªåŠ¨æ¸…ç†</span><br></code></pre></td></tr></table></figure>
<h4 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šä½¿ç”¨å­—ç¬¦ä¸²å­—é¢é‡ä½œä¸ºé”®</span><br>WeakHashMap&lt;String, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakHashMap</span>&lt;&gt;();<br>map.put(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>); <span class="hljs-comment">// &quot;test&quot; æ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œä¸ä¼šè¢« GC</span><br>System.gc();<br>System.out.println(map.size()); <span class="hljs-comment">// ä»ç„¶æ˜¯ 1</span><br><br><span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šä½¿ç”¨æ–°åˆ›å»ºçš„å¯¹è±¡ä½œä¸ºé”®</span><br>map.put(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;test&quot;</span>), <span class="hljs-string">&quot;value&quot;</span>);<br>System.gc();<br>System.out.println(map.size()); <span class="hljs-comment">// å¯èƒ½æ˜¯ 0</span><br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šè‡ªåŠ¨æ¸…ç†ç¼“å­˜</strong></p>
<p>å½“éœ€è¦ç¼“å­˜æ•°æ®ä½†ä¸å¸Œæœ›ç¼“å­˜é˜»æ­¢å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶ï¼ŒWeakHashMap æä¾›äº†è‡ªåŠ¨æ¸…ç†æœºåˆ¶ã€‚é€‚ç”¨äºå¯¹è±¡å…ƒæ•°æ®ã€ä¸´æ—¶ç¼“å­˜ã€ç›‘å¬å™¨æ³¨å†Œç­‰åœºæ™¯ã€‚</p>
<h3 id="copyonwritearraylist">CopyOnWriteArrayList</h3>
<p>CopyOnWriteArrayList æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ ArrayList å˜ä½“ï¼Œé€šè¿‡å†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Writeï¼‰ç­–ç•¥å®ç°å¹¶å‘å®‰å…¨ã€‚</p>
<h4 id="è¯»æ“ä½œçš„ä¸€è‡´æ€§é—®é¢˜">è¯»æ“ä½œçš„ä¸€è‡´æ€§é—®é¢˜</h4>
<p>ç”±äºæ‰€æœ‰çš„å†™æ“ä½œéƒ½æ˜¯åœ¨æ–°æ•°ç»„è¿›è¡Œçš„ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæœ‰çº¿ç¨‹å¹¶å‘çš„å†™ï¼Œåˆ™é€šè¿‡é”æ¥æ§åˆ¶ï¼Œå¦‚æœæœ‰çº¿ç¨‹å¹¶å‘çš„è¯»ï¼Œåˆ™åˆ†å‡ ç§æƒ…å†µï¼š</p>
<ol>
<li>å¦‚æœå†™æ“ä½œæœªå®Œæˆï¼Œé‚£ä¹ˆç›´æ¥è¯»å–åŸæ•°ç»„çš„æ•°æ®</li>
<li>å¦‚æœå†™æ“ä½œå®Œæˆï¼Œä½†æ˜¯å¼•ç”¨è¿˜æœªæŒ‡å‘æ–°æ•°ç»„ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯è¯»å–åŸæ•°ç»„æ•°æ®</li>
<li>å¦‚æœå†™æ“ä½œå®Œæˆï¼Œå¹¶ä¸”å¼•ç”¨å·²ç»æŒ‡å‘äº†æ–°çš„æ•°ç»„ï¼Œé‚£ä¹ˆç›´æ¥ä»æ–°æ•°ç»„ä¸­è¯»å–æ•°æ®</li>
</ol>
<p>æ™®é€šçš„ list åœ¨è¿­ä»£çš„æ—¶å€™ç”¨ list.remove ä¼šå¤±è´¥ï¼Œiterator.remove åœ¨å•çº¿ç¨‹ä¸‹ä¼šæˆåŠŸã€‚è€Œ CopyOnWriteArrayList å®é™…ä¸Šæ˜¯åœ¨ä¸€ä¸ª immutable çš„ snapshot ä¸Šè¿›è¡Œè¿­ä»£ï¼Œæ‰€ä»¥è¿ iterator.remove éƒ½ä¼š fastfailã€‚</p>
<p>å®ƒæ˜¯ ArrayList çš„ä¸€ä¸ªå¹¶å‘æ›¿ä»£å“ï¼Œé€šè¿‡è¯»å†™åˆ†ç¦»æé«˜æ€§èƒ½ï¼Œä½†ä¸€è‡´æ€§é—®é¢˜å’Œå¤åˆ¶é—®é¢˜æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ€§èƒ½å’Œä¸šåŠ¡é—®é¢˜ã€‚</p>
<h4 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">CopyOnWriteArrayList&lt;String&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyOnWriteArrayList</span>&lt;&gt;();<br>list.add(<span class="hljs-string">&quot;A&quot;</span>);<br>list.add(<span class="hljs-string">&quot;B&quot;</span>);<br>list.add(<span class="hljs-string">&quot;C&quot;</span>);<br><br><span class="hljs-comment">// è¿­ä»£å™¨ä¸ä¼šæŠ›å‡º ConcurrentModificationException</span><br><span class="hljs-keyword">for</span> (String item : list) &#123;<br>    System.out.println(item);<br>    list.add(<span class="hljs-string">&quot;D&quot;</span>); <span class="hljs-comment">// å…è®¸åœ¨è¿­ä»£æ—¶ä¿®æ”¹</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="é€‚ç”¨åœºæ™¯">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>è¯»æ“ä½œè¿œå¤šäºå†™æ“ä½œçš„åœºæ™¯</li>
<li>éœ€è¦ä¿è¯è¿­ä»£æœŸé—´æ•°æ®ä¸€è‡´æ€§çš„åœºæ™¯</li>
<li>ä¸å®¹å¿è¿­ä»£æ—¶æŠ›å‡º ConcurrentModificationException çš„åœºæ™¯</li>
</ul>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šå†™æ—¶å¤åˆ¶</strong></p>
<p>å½“è¯»å¤šå†™å°‘ä¸”éœ€è¦ä¿è¯è¿­ä»£ä¸€è‡´æ€§æ—¶ï¼ŒCopyOnWriteArrayList æä¾›äº†ä¼˜é›…çš„å¹¶å‘è§£å†³æ–¹æ¡ˆã€‚é€‚ç”¨äºäº‹ä»¶ç›‘å¬å™¨ã€é…ç½®ç¼“å­˜ç­‰åœºæ™¯ã€‚</p>
<h2 id="å¹¶å‘é›†åˆ">å¹¶å‘é›†åˆ</h2>
<h3 id="concurrentskiplistset-ä¸-concurrentskiplistmap">ConcurrentSkipListSet ä¸ ConcurrentSkipListMap</h3>
<p>ConcurrentSkipListSet å’Œ ConcurrentSkipListMap æ˜¯åŸºäºè·³è¡¨ï¼ˆSkip Listï¼‰å®ç°çš„å¹¶å‘æœ‰åºé›†åˆï¼Œæä¾›äº†é«˜æ•ˆçš„å¹¶å‘è®¿é—®å’Œæ’åºåŠŸèƒ½ã€‚</p>
<h4 id="è·³è¡¨ç»“æ„">è·³è¡¨ç»“æ„</h4>
<p>è·³è¡¨æ˜¯ä¸€ç§æ¦‚ç‡æ•°æ®ç»“æ„ï¼Œé€šè¿‡å¤šå±‚é“¾è¡¨å®ç°å¿«é€ŸæŸ¥æ‰¾ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º O(log n)ï¼Œæœ€åæƒ…å†µä¸‹ä¸º O(n)ã€‚</p>
<h4 id="ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ConcurrentSkipListMap</span><br>ConcurrentSkipListMap&lt;Integer, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentSkipListMap</span>&lt;&gt;();<br>map.put(<span class="hljs-number">3</span>, <span class="hljs-string">&quot;C&quot;</span>);<br>map.put(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;A&quot;</span>);<br>map.put(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;B&quot;</span>);<br>map.put(<span class="hljs-number">5</span>, <span class="hljs-string">&quot;E&quot;</span>);<br>map.put(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;D&quot;</span>);<br><br><span class="hljs-comment">// è‡ªåŠ¨æ’åº</span><br>System.out.println(map.keySet()); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span><br><br><span class="hljs-comment">// å¹¶å‘å®‰å…¨çš„èŒƒå›´æŸ¥è¯¢</span><br>ConcurrentNavigableMap&lt;Integer, String&gt; range = map.subMap(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>);<br>System.out.println(range); <span class="hljs-comment">// &#123;2=B, 3=C&#125;</span><br><br><span class="hljs-comment">// ConcurrentSkipListSet</span><br>ConcurrentSkipListSet&lt;Integer&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentSkipListSet</span>&lt;&gt;();<br>set.add(<span class="hljs-number">3</span>);<br>set.add(<span class="hljs-number">1</span>);<br>set.add(<span class="hljs-number">2</span>);<br><br>System.out.println(set); <span class="hljs-comment">// [1, 2, 3]</span><br></code></pre></td></tr></table></figure>
<h4 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h4>
<p><strong>é«˜å¹¶å‘æ’è¡Œæ¦œ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Leaderboard</span> &#123;<br>    <span class="hljs-keyword">private</span> ConcurrentSkipListMap&lt;Integer, Set&lt;String&gt;&gt; ranking = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentSkipListMap</span>&lt;&gt;(Collections.reverseOrder());<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateScore</span><span class="hljs-params">(String player, <span class="hljs-type">int</span> score)</span> &#123;<br>        ranking.computeIfAbsent(score, k -&gt; ConcurrentHashMap.newKeySet()).add(player);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getTopN</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>        List&lt;String&gt; topPlayers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;Integer, Set&lt;String&gt;&gt; entry : ranking.entrySet()) &#123;<br>            <span class="hljs-keyword">for</span> (String player : entry.getValue()) &#123;<br>                topPlayers.add(player + <span class="hljs-string">&quot;: &quot;</span> + entry.getKey());<br>                <span class="hljs-keyword">if</span> (topPlayers.size() &gt;= n) <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (topPlayers.size() &gt;= n) <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> topPlayers;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>æ—¶é—´çª—å£æŸ¥è¯¢</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åŸºäºæ—¶é—´æˆ³çš„å¹¶å‘æœ‰åºæ˜ å°„</span><br>ConcurrentSkipListMap&lt;Long, Event&gt; eventTimeline = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentSkipListMap</span>&lt;&gt;();<br><br><span class="hljs-comment">// æ·»åŠ äº‹ä»¶</span><br>eventTimeline.put(System.currentTimeMillis(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&quot;Event A&quot;</span>));<br>eventTimeline.put(System.currentTimeMillis() + <span class="hljs-number">1000</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&quot;Event B&quot;</span>));<br>eventTimeline.put(System.currentTimeMillis() + <span class="hljs-number">2000</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&quot;Event C&quot;</span>));<br><br><span class="hljs-comment">// æŸ¥è¯¢æœ€è¿‘ 1.5 ç§’çš„äº‹ä»¶</span><br><span class="hljs-type">long</span> <span class="hljs-variable">now</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>ConcurrentNavigableMap&lt;Long, Event&gt; recentEvents = <br>    eventTimeline.subMap(now - <span class="hljs-number">1500</span>, <span class="hljs-literal">true</span>, now, <span class="hljs-literal">true</span>);<br><br>System.out.println(recentEvents.values());<br></code></pre></td></tr></table></figure>
<h4 id="æ€§èƒ½ç‰¹ç‚¹">æ€§èƒ½ç‰¹ç‚¹</h4>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æ—¶é—´å¤æ‚åº¦</th>
<th>çº¿ç¨‹å®‰å…¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ’å…¥</td>
<td>O(log n)</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>åˆ é™¤</td>
<td>O(log n)</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>æŸ¥æ‰¾</td>
<td>O(log n)</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>èŒƒå›´æŸ¥è¯¢</td>
<td>O(log n + k)</td>
<td>æ˜¯</td>
</tr>
</tbody>
</table>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šå¹¶å‘æœ‰åºé›†åˆ</strong></p>
<p>å½“éœ€è¦åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ç»´æŠ¤æœ‰åºæ•°æ®æ—¶ï¼ŒConcurrentSkipListSet/Map æä¾›äº†é«˜æ•ˆçš„å®ç°ã€‚é€‚ç”¨äºé«˜å¹¶å‘æ’è¡Œæ¦œã€æ—¶é—´çª—å£æŸ¥è¯¢ã€å¹¶å‘èŒƒå›´æ“ä½œç­‰åœºæ™¯ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº† Java é›†åˆæ¡†æ¶ä¸­æ ¸å¿ƒæ¥å£ã€æŠ½è±¡ç±»ä»¥åŠä¸å¸¸è§ä½†åŠŸèƒ½å¼ºå¤§çš„é›†åˆç±»ï¼Œå®ƒä»¬åœ¨ç‰¹å®šåœºæ™¯ä¸‹èƒ½æä¾›æ›´ä¼˜é›…ã€é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼š</p>
<table>
<thead>
<tr>
<th>é›†åˆç±»</th>
<th>æ ¸å¿ƒç‰¹æ€§</th>
<th>å…¸å‹åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>TreeSet/TreeMap</td>
<td>è‡ªåŠ¨æ’åºã€èŒƒå›´æŸ¥è¯¢</td>
<td>èŒƒå›´æŸ¥è¯¢ã€æ’åºå­˜å‚¨</td>
</tr>
<tr>
<td>NavigableSet/Map</td>
<td>é‚»è¿‘æŸ¥æ‰¾</td>
<td>ä»·æ ¼åŒ¹é…ã€æ—¶é—´çª—å£</td>
</tr>
<tr>
<td>PriorityQueue</td>
<td>ä¼˜å…ˆçº§å †</td>
<td>Top-Kã€ä»»åŠ¡è°ƒåº¦</td>
</tr>
<tr>
<td>IdentityHashMap</td>
<td>å¼•ç”¨è¯­ä¹‰</td>
<td>æ·±æ‹·è´ã€åºåˆ—åŒ–</td>
</tr>
<tr>
<td>ConcurrentSkipListSet/Map</td>
<td>å¹¶å‘æœ‰åºé›†åˆ</td>
<td>é«˜å¹¶å‘æ’è¡Œæ¦œ</td>
</tr>
<tr>
<td>DelayQueue</td>
<td>å»¶è¿Ÿé˜Ÿåˆ—</td>
<td>ç¼“å­˜è¿‡æœŸã€è®¢å•è¶…æ—¶</td>
</tr>
<tr>
<td>EnumSet/EnumMap</td>
<td>æšä¸¾ä¸“ç”¨</td>
<td>æ ‡å¿—ä½ã€çŠ¶æ€æœº</td>
</tr>
<tr>
<td>WeakHashMap</td>
<td>å¼±å¼•ç”¨</td>
<td>è‡ªåŠ¨æ¸…ç†ç¼“å­˜</td>
</tr>
<tr>
<td>LinkedHashMap/HashSet</td>
<td>é¡ºåºä¿æŒ</td>
<td>LRU ç¼“å­˜ã€å†å²è®°å½•</td>
</tr>
<tr>
<td>SortedSet/Map</td>
<td>æ’åºæ¥å£</td>
<td>æœ‰åºæ•°æ®ç»´æŠ¤</td>
</tr>
<tr>
<td>AbstractList/SequentialList</td>
<td>æŠ½è±¡åŸºç±»</td>
<td>è‡ªå®šä¹‰åˆ—è¡¨å®ç°</td>
</tr>
<tr>
<td>CopyOnWriteArrayList</td>
<td>å†™æ—¶å¤åˆ¶</td>
<td>è¯»å¤šå†™å°‘åœºæ™¯</td>
</tr>
<tr>
<td>é˜Ÿåˆ—æ“ä½œ</td>
<td>å…­ä¸ªæ ¸å¿ƒæ–¹æ³•</td>
<td>é˜Ÿåˆ—åŸºç¡€æ“ä½œ</td>
</tr>
</tbody>
</table>
<p>æŒæ¡è¿™äº›é›†åˆç±»ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ åœ¨ç‰¹å®šåœºæ™¯ä¸‹é€‰æ‹©æœ€åˆé€‚çš„æ•°æ®ç»“æ„ï¼Œç¼–å†™å‡ºæ›´é«˜æ•ˆã€æ›´ä¼˜é›…çš„ä»£ç ã€‚</p>
<hr>
<p>å®ƒçš„è¿­ä»£å™¨åœ¨ ListIterator åŸºç¡€ä¸Šå¢åŠ äº†ï¼Œaddã€remove ç­‰æ“ä½œã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://magicliang.github.io">magicliang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://magicliang.github.io/2020/02/23/Java-Collections-Framework/">https://magicliang.github.io/2020/02/23/Java-Collections-Framework/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post-share"><div class="social-share" data-image="/img/wall-paper-111.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2017/10/23/%E6%98%82%E8%B4%B5%E7%9A%84%E5%BC%82%E5%B8%B8/" title="æ˜‚è´µçš„å¼‚å¸¸"><img class="cover" src="/img/wall-paper-40.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-10-23</div><div class="info-item-2">æ˜‚è´µçš„å¼‚å¸¸</div></div><div class="info-2"><div class="info-item-1">æŠ›å‡ºé—®é¢˜ Joshua Bloch åœ¨ã€ŠEffective Javaã€‹çš„ Item 57 é‡Œæ˜ç¡®åœ°æåˆ°è¿‡ï¼Œä¸è¦è¯•å›¾ç”¨ Exception çš„è·³è½¬æ¥ä»£æ›¿æ­£å¸¸çš„ç¨‹åºæ§åˆ¶æµã€‚ä»–åˆ—ä¸¾äº†å¾ˆå¤šåŸå› ï¼Œä½†ç‰¹åˆ«æåˆ°äº†æŠ›å‡ºå¼‚å¸¸ä¼šä½¿å¾—æ•´ä¸ªç¨‹åºè¿è¡Œå˜æ…¢ã€‚æŠ›å‡ºå¼‚å¸¸è¿œæ¯”æ™®é€šçš„ returnã€break ç­‰æ“ä½œå¯¹æ§åˆ¶æµã€æ•°æ®æµçš„æ€§èƒ½å½±å“è¦å¤§ï¼Œå®ƒå°±åªé€‚åˆæ‹¿æ¥ä½œå¼‚å¸¸åˆ†æ”¯çš„æ§åˆ¶è¯­å¥ï¼Œè€Œä¸èƒ½æ‹¿æ¥ç¼–å†™æ­£å¸¸çš„é€»è¾‘ã€‚  Throwing exception is expensive.  è¿™å¥è¯åœ¨ Java çš„ç¨‹åºå‘˜ä¸–ç•Œé‡Œé¢å·²ç»æˆä¸ºè€ç”Ÿå¸¸è°ˆï¼Œå´å¾ˆå°‘æœ‰äººè°ˆåŠåˆ°åº•æŠ›å‡ºå¼‚å¸¸æ¯”æ­£å¸¸çš„ç¨‹åºè·³è½¬è¿”å›æ…¢åœ¨å“ªé‡Œï¼Œæœ‰å¤šæ…¢ã€‚&quot;ä¸è¦æ»¥ç”¨å¼‚å¸¸&quot;å¥½åƒä¸€ä¸ªçŒ´å­å®šå¾‹ï¼Œäººä»¬çŸ¥é“ä¸èƒ½è¿™ä¹ˆåšï¼Œå´ä¸æ˜ç™½ä¸ºä»€ä¹ˆä¸èƒ½è¿™ä¹ˆåšã€‚ æ­¤å‰è¯»äº†ä¸€ä½åŒäº‹å†™çš„å¥½æ–‡ã€ŠJavaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ã€‹ï¼Œæ·±å…¥åœ°åˆ†æäº† JVM å¯¹å¼‚å¸¸è·³è½¬çš„å¤„ç†è¿‡ç¨‹ï¼šJVM ä¼šé€šè¿‡å¼‚å¸¸è¡¨çš„æœºåˆ¶ï¼Œä¼˜åŒ–å¼‚å¸¸æŠ›å‡ºå’Œæ­£å¸¸è¿”å›ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ã€‚ä»…ä»ç¨‹åºè®¡æ•°å™¨çš„ç§»åŠ¨ä¸Šæ¥è®²ï¼ŒæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¯¹æ ˆå¸§çš„å¼¹æ ˆå¹¶ä¸æ¯”ç›´æ¥è¿”å›æ›´æ˜‚è´µã€‚å†™åœ¨å‰å¤´çš„ç»“è®ºæ˜¯ï¼š&quot;try-catch è¯­å¥å—å‡ ä¹ä¸ä¼šå½±å“ç¨‹åºè¿è¡Œæ€§èƒ½ï¼...</div></div></div></a><a class="pagination-related" href="/2017/11/30/Java%E4%B8%AD%E7%9A%84%E5%B9%BD%E7%81%B5%E7%B1%BB%E5%9E%8B/" title="Javaä¸­çš„å¹½çµç±»å‹"><img class="cover" src="/img/wall-paper-23.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-11-30</div><div class="info-item-2">Javaä¸­çš„å¹½çµç±»å‹</div></div><div class="info-2"><div class="info-item-1">ä»€ä¹ˆæ˜¯å¹½çµç±»å‹ å…ˆä¸Šç»“è®ºï¼šå¹½çµç±»å‹ï¼ˆPhantom Typeï¼‰é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¹½çµèˆ¬çš„ç±»å‹ï¼Œè¿™ç§ç±»å‹å¾€å¾€åœ¨è¿è¡Œæ—¶å¯ä»¥æ¶ˆå¤±ï¼Œå› ä¸ºåœ¨è¿è¡Œæ—¶æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œå®ƒä»¬æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æ²¡æœ‰ä»»ä½•å®ä¾‹ï¼ˆJava çš„ Void å°±æ˜¯ä¸€ä¸ªä¸å¯å®ä¾‹åŒ–ç±»å‹çš„ä¾‹å­ï¼Œå¸¸è¢«ç”¨ä½œå¹½çµç±»å‹çš„ç±»å‹å‚æ•°ï¼Œå¦‚ Future&lt;Void&gt;ï¼‰ã€‚å¹½çµç±»å‹æ˜¯ä¸€ç§å¯ä»¥æŠŠæœ‰äº›è¿è¡Œæ—¶æ‰èƒ½æ£€æµ‹åˆ°çš„é”™è¯¯ï¼Œåœ¨ç¼–è¯‘æ—¶æ£€æµ‹å‡ºæ¥çš„æŠ€å·§ã€‚æŒ‰ç…§æœ‰äº›è€å¤–çš„è§‚ç‚¹ï¼Œå°±æ˜¯&quot;Making Wrong Code Look Wrong&quot;ã€‚åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸­ï¼Œå¹½çµç±»å‹çš„å®ç°ï¼Œå¾€å¾€ä¸çŠ¶æ€æ¨¡å¼è¾ƒä¸ºæ¥è¿‘ï¼Œä½†æ¯”çŠ¶æ€æ¨¡å¼æä¾›äº†æ›´å¼ºçš„çº é”™åŠŸèƒ½ã€‚åœ¨ Java 5 ä»¥åçš„ç‰ˆæœ¬é‡Œï¼Œç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨æ³›å‹ã€‚é€šè¿‡æ³›å‹çš„ç±»å‹å‚æ•°ï¼ŒJava ä¸­ä¹Ÿæ‹¥æœ‰äº†å¹½çµç±»å‹çš„èƒ½åŠ›ã€‚ ä¸Šé¢çš„é˜è¿°æ˜¯ä¸æ˜¯å¾ˆéš¾çœ‹æ‡‚ï¼Ÿç›´æ¥è¿›å…¥å…·ä½“çš„ä¾‹å­ã€‚å‡è®¾æœ‰ä¸€ä¸ªé£æœºæ§åˆ¶ç¨‹åºï¼Œæ“ä½œé£æœºèµ·é£æˆ–è€…è½åœ°ã€‚è¿™ä¸ªç¨‹åºæœ‰ä¸€ä¸ªéå¸¸å¼ºçš„ä¸šåŠ¡çº¦æŸï¼Œå°±æ˜¯å¿…é¡»ä¿è¯é£æœºä¸€å¼€å§‹å¿…é¡»å‡ºç°åœ¨åœ°ä¸Šï¼Œåªæœ‰åœ¨åœ°ä¸Šçš„é£æœºå¯ä»¥èµ·é£ï¼Œåªæœ‰èµ·é£çš„é£æœºå¯ä»¥è½åœ°ï¼Œé‚£ä¹ˆåº”è¯¥æ€æ ·è®¾è®¡ç¨‹åºï¼ˆä¸»è¦æ˜¯ç±»å‹å…³ç³»ï¼‰ï¼Œæ¥ä¿è¯è¿™ä¸ªçº¦æŸå¿…ç„¶æˆç«‹å‘¢ï¼Ÿ å®šä¹‰çŠ¶æ€æ¥å£ å…ˆæ¥å®šä¹‰...</div></div></div></a><a class="pagination-related" href="/2018/05/29/JPA-%E7%9A%84-id-%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5/" title="JPA çš„ id ç”Ÿæˆç­–ç•¥"><img class="cover" src="/img/wall-paper-86.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-05-29</div><div class="info-item-2">JPA çš„ id ç”Ÿæˆç­–ç•¥</div></div><div class="info-2"><div class="info-item-1">JPA æœ‰ä¸€ä¸ª@GeneratedValueæ³¨è§£ï¼Œæœ‰ä¸€ä¸ªstrategy attributeï¼Œå¦‚ @GeneratedValue(strategy = GenerationType.IDENTITY)ã€‚ å¸¸è§çš„å¯é€‰ç­–ç•¥ä¸»è¦æœ‰IDENTITYå’ŒSEQUENCEã€‚ GenerationType.IDENTITY è¦æ±‚åº•å±‚æœ‰ä¸€ä¸ª integer æˆ–è€… bigint ç±»å‹çš„è‡ªå¢åˆ—ï¼ˆ auto-incremented column)ã€‚è‡ªå¢åˆ—çš„èµ‹å€¼å¿…é¡»åœ¨æ’å…¥æ“ä½œä¹‹åå‘ç”Ÿï¼Œå› ä¸ºè¿™ä¸ªåŸå› ï¼ŒHibernate æ— æ³•è¿›è¡Œå„ç§ä¼˜åŒ–ï¼ˆç‰¹åˆ«æ˜¯ JDBC çš„ batch å¤„ç†ï¼Œä¸€æ¬¡ flush æ“ä½œä¼šäº§ç”Ÿå¾ˆå¤šæ¡insert è¯­å¥ï¼Œåˆ†åˆ«æ‰§è¡Œï¼‰ã€‚å¦‚æœäº‹åŠ¡å›æ»šï¼Œè‡ªå¢åˆ—çš„å€¼å°±ä¼šè¢«ä¸¢å¼ƒã€‚æ•°æ®åº“åœ¨è¿™ä¸ªè‡ªå¢æ“ä½œä¸Šæœ‰ä¸ªé«˜åº¦ä¼˜åŒ–çš„è½»é‡çº§é”æœºåˆ¶ï¼Œæ€§èƒ½éå¸¸æ£’ã€‚ MySQL æ”¯æŒè¿™ç§ id ç”Ÿæˆç­–ç•¥ï¼Œ ä½¿ç”¨ MySQL åº”è¯¥å°½é‡ä½¿ç”¨è¿™ä¸ªç­–ç•¥ï¼Œå³ä½¿å®ƒæ— æ³•ä¼˜åŒ–ã€‚ JPA ç”¨å®ƒç”Ÿæˆ idï¼Œä¼šä¸€æ¡ä¸€æ¡åœ°æ’å…¥æ–°çš„ entityã€‚ GenerationType.SEQUENCE æ•°æ®åº“æœ‰ä¸€ä¸ªæ‰€è°“çš„ sequence å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ selec...</div></div></div></a><a class="pagination-related" href="/2018/06/19/%E5%A6%82%E4%BD%95%E5%81%9A%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8B%E7%9A%84%E7%AD%94%E6%A1%88/" title="å¦‚ä½•åšæ€§èƒ½æµ‹è¯•çš„é—®é¢˜ä¸‹çš„ç­”æ¡ˆ"><img class="cover" src="/img/wall-paper-37.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-19</div><div class="info-item-2">å¦‚ä½•åšæ€§èƒ½æµ‹è¯•çš„é—®é¢˜ä¸‹çš„ç­”æ¡ˆ</div></div><div class="info-2"><div class="info-item-1">è¯•ç€å›ç­”ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚ é¦–å…ˆè¦åˆ’åˆ†ç³»ç»Ÿç±»å‹ï¼šæœ‰çŠ¶æ€è¿˜æ˜¯æ— çŠ¶æ€ï¼Œä¸šåŠ¡ç³»ç»Ÿè¿˜æ˜¯å­˜å‚¨ç³»ç»Ÿã€‚æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œè®¾ç«‹æ€§èƒ½æµ‹è¯•çš„ç›®æ ‡ï¼šæ˜¯è¦æµ‹ QPSï¼Œè¿˜æ˜¯ TPS è¿˜æ˜¯ TPSï¼Œè¿˜æ˜¯ä»»ä½•å…¶ä»–ã€æ€§èƒ½ã€‘-ä»å¹¿ä¹‰æ¥è®²ï¼Œä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿåˆ°åº•èƒ½å¤Ÿä»¥å¤šé«˜çš„å¹³å‡æ—¶å»¶æ¥ç®¡ç†å¤§å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œå¯èƒ½ä¹Ÿæ˜¯æ€§èƒ½çš„ä¸€ç§ã€‚ æœ‰äº†æ€§èƒ½æµ‹è¯•çš„ç›®æ ‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‹†è§£ç”¨ä¾‹ã€‚å¦‚æœæŠŠæ€§èƒ½æµ‹è¯•å½’ä¸ºæµ‹è¯•çš„è¯ï¼Œæµ‹è¯•å°±éœ€è¦æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ç”¨ä¾‹åªæ˜¯ç”¨ä¾‹çš„å½¢å¼åŒ–è¡¨è¾¾ã€‚æŠŠç”¨æˆ·çš„ä½¿ç”¨åœºæ™¯å‹¾å‹’å‡ºæ¥ï¼ŒæŠŠæ¯ä¸€æ­¥æ‹†è§£æˆçš„æµç¨‹å›¾æˆ–è€…æ—¶åºå›¾â€“æˆ‘ä»¬å·²ç»å¾—åˆ°äº†ä¸€ä¸ªçº¸ä¸Šçš„é›†æˆæµ‹è¯•è®¡åˆ’ï¼Œåªæ˜¯æ²¡æœ‰è·Ÿæ€§èƒ½æŒ‚ä¸Šé’©ã€‚ æ¥ä¸‹æ¥å°±è¿›å…¥çœŸæ­£å†™æµ‹è¯•ç”¨ä¾‹çš„ç¯èŠ‚äº†ã€‚ æˆ‘ä»¬çš„æµ‹è¯•æŠ¥å‘Šå¦‚æœè¦æ¶µç›–è¶³å¤Ÿç«‹ä½“çš„ä¿¡æ¯ï¼Œåˆ™æ—¢è¦äº†è§£æ¯ä¸€ä¸ªç¯èŠ‚/æ¥å£/API çš„æ€§èƒ½æŒ‡æ ‡ï¼Œåˆè¦äº†è§£æ•´ä½“çš„æ€§èƒ½æŒ‡æ ‡ã€‚ è¿™ä¸ªæ—¶å€™æµ‹è¯•å·¥å…·çš„è¦†ç›–é¢å°±å¾ˆé‡è¦äº†ã€‚å¦‚æœæˆ‘ä»¬é€‰æ‹©åé»‘ç›’çš„æµ‹è¯•å·¥å…·ï¼Œapache ab /JMeterï¼Œåˆ™æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹å°±è¦å›´ç»•ç€å¯¹å¤–äº¤äº’çš„ APIå†™ï¼Œä¹Ÿåªèƒ½æµ‹åˆ°å¤–å›´æ¥å£çš„æ€§èƒ½ã€‚è¿™æ ·çš„æµ‹è¯•ç”¨ä¾‹å†™èµ·æ¥æœ€ç®€å•ï¼Œæ— éœ€ä¾µå…¥ä»»ä½•å†…éƒ¨ä»£ç ä¸­ã€‚ å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº† JMH ä¸€ç±»çš„å·¥å…·ï¼Œåˆ™å¯ä»¥è‡ªç”±ç¼–å†™å¯¹ä»»ä½•æ–¹æ³•çš„æµ‹è¯•ç”¨ä¾‹ã€‚ä½†éœ€è¦å¯¹ç³»ç»Ÿæœ‰éå¸¸...</div></div></div></a><a class="pagination-related" href="/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/" title="æ—¥æœŸä¸æ—¶é—´"><img class="cover" src="/img/wall-paper-130.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-09-07</div><div class="info-item-2">æ—¥æœŸä¸æ—¶é—´</div></div><div class="info-2"><div class="info-item-1">JSR 310 Java Dateä¸Time API æ–°æ—§ API çš„æ›´è¿­ æ—§çš„ Java API ä¸»è¦åŒ…æ‹¬java.util.Dateå’Œjava.util.Calendar ä¸¤ä¸ªåŒ…çš„å†…å®¹ã€‚è¿™ä¸¤ä¸ªåŒ…çš„æ—¶é—´ç±»å‹æ˜¯å¯å˜çš„ã€‚å¦‚ Date çš„å®ä¾‹å¯ä»¥é€šè¿‡ setYear æ¥äº§ç”Ÿå˜åŒ–ã€‚ JSR 310 ä¸­åŒ…æ‹¬çš„æ—¥æœŸç±»å‹ä¸»è¦æœ‰ï¼š  è®¡ç®—æœºæ—¶é—´ï¼šInstantï¼Œå¯¹åº” java.util.Dateï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªç¡®å®šçš„æ—¶é—´ç‚¹ï¼Œå³ç›¸å¯¹äºæ ‡å‡†Javaçºªå…ƒï¼ˆ1970å¹´1æœˆ1æ—¥ï¼‰çš„åç§»é‡ï¼›ä½†ä¸java.util.Dateç±»ä¸åŒçš„æ˜¯å…¶ç²¾ç¡®åˆ°äº†çº³ç§’çº§åˆ«ã€‚ äººç±»æ—¶é—´ï¼šå¯¹åº”äºäººç±»è‡ªèº«çš„è§‚å¿µï¼Œæ¯”å¦‚LocalDateå’ŒLocalTimeã€‚ä»–ä»¬ä»£è¡¨äº†ä¸€èˆ¬çš„æ—¶åŒºæ¦‚å¿µï¼Œè¦ä¹ˆæ˜¯æ—¥æœŸï¼ˆä¸åŒ…å«æ—¶é—´ï¼‰ï¼Œè¦ä¹ˆæ˜¯æ—¶é—´ï¼ˆä¸åŒ…å«æ—¥æœŸï¼‰ï¼Œç±»ä¼¼äºjava.sqlçš„è¡¨ç¤ºæ–¹å¼ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªMonthDayï¼Œå®ƒå¯ä»¥å­˜å‚¨æŸäººçš„ç”Ÿæ—¥ï¼ˆä¸åŒ…å«å¹´ä»½ï¼‰ã€‚æ¯ä¸ªç±»éƒ½åœ¨å†…éƒ¨å­˜å‚¨æ­£ç¡®çš„æ•°æ®è€Œä¸æ˜¯åƒjava.util.Dateé‚£æ ·åˆ©ç”¨åˆå¤œ12ç‚¹æ¥åŒºåˆ†æ—¥æœŸï¼Œåˆ©ç”¨1970-01-01æ¥è¡¨ç¤ºæ—¶é—´ã€‚è¿™äº›ç±»å‹çš„å®ä¾‹æ˜¯ immutable çš„ï¼Œè€Œä¸”åªèƒ½é€šè¿‡å·¥å‚æ–¹æ³•åˆ›å»ºã€‚  æ—¶åŒº...</div></div></div></a><a class="pagination-related" href="/2018/10/13/%E5%8D%A1%E8%A1%A8%E5%92%8C-RSet/" title="å¡è¡¨å’Œ RSet"><img class="cover" src="/img/wall-paper-134.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-10-13</div><div class="info-item-2">å¡è¡¨å’Œ RSet</div></div><div class="info-2"><div class="info-item-1">ä¸Šä¸‹æ–‡ å¡è¡¨å’Œ RSetï¼ˆRemember Setï¼‰ï¼Œæ˜¯ JVM ä¸ºäº†è§£å†³åˆ†ä»£æ”¶é›†æ—¶ï¼Œlive set æ‰«æéœ€è¦ç©¿æ¢­åˆ°ä¸åŒçš„ä»£çš„æ—¶å€™çš„æ•ˆç‡é—®é¢˜ã€‚ ä½¿ç”¨ç¼“å­˜è¡¨æ¥æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œæ˜¯åŒ–é¡ºåºæŸ¥æ‰¾ä¸ºéƒ¨åˆ†éšæœºæŸ¥æ‰¾çš„ä¸€ç§å¸¸ç”¨çš„è®¾è®¡æ€è·¯ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¼ ç»Ÿçš„è®¡ç®—æœºä½“ç³»ç»“æ„ä¸­ï¼Œå½“æˆ‘ä»¬æŠŠå†…å­˜åˆ†æˆé¡µä»¥åï¼Œä¼šæœ‰ä¸€ä¸ªé¡µè¡¨ï¼Œé¡µè¡¨åˆä¼šæœ‰ä¸€ä¸ªå¿«è¡¨ï¼Œä½œä¸ºä¸€ä¸ªä¸­é—´ç¼“å­˜é¡¹ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„é¡µè¡¨é¡¹ï¼ˆtable entryï¼‰ã€‚ JVM åœ¨è¿›è¡Œåƒåœ¾æ”¶é›†çš„æ—¶å€™ï¼Œæœ‰ä¸€é¡¹éå¸¸é‡è¦çš„å·¥ä½œå°±æ˜¯ç¡®å®šè¿™ä¸€æ¬¡åƒåœ¾æ”¶é›†çš„å¯¹è±¡åˆ°åº•æœ‰å¤šå°‘ä¸ªï¼Œå³ç¡®å®š live set çš„èŒƒå›´ã€‚ å¯¹äºæ–°ç”Ÿä»£åƒåœ¾æ”¶é›†å™¨è€Œè¨€ï¼Œè¿™ä¸ªé—®é¢˜åˆæœ‰å…¶ç‰¹æ®Šä¹‹å¤„ã€‚æ ¹æ® JVM çš„å¼±åˆ†ä»£æ”¶é›†å‡è®¾ï¼ˆweak generational hypothesisï¼‰çš„å­˜åœ¨ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†çš„æ—¶å€™ï¼Œæ–°ç”Ÿä»£çš„æ‰«æèŒƒå›´å¯èƒ½å¾ˆå¤§ï¼Œä½†æ–°ç”Ÿä»£çš„ live set ä¸åº”è¯¥å¤ªå¤§ã€‚card table/Remember Set çš„è®¾è®¡ç›®çš„ï¼Œå°±æ˜¯å°½é‡å‡å°‘æ— ç”¨çš„åƒåœ¾æ‰«æèŒƒå›´ï¼Œä½¿ç”¨ç±»ä¼¼æ“ä½œç³»ç»Ÿæˆ–è€…æ•°æ®åº“çš„è„é¡µè¡¨çš„å½¢å¼ï¼Œæ¥åšç±»ä¼¼å¿«è¡¨çš„æŸ¥è¯¢ã€‚ å¡è¡¨ï¼ˆcard tableï¼‰  å¡è¡¨æ˜¯ CMS çš„è§£å†³æ–¹æ¡ˆã€‚ å¡è¡¨é€šå¸¸åœ¨ JV...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Java Collections Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#uml-%E5%9B%BE"><span class="toc-number">1.1.</span> <span class="toc-text">UML å›¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%8E%A5%E5%8F%A3%E4%B8%8E%E6%8A%BD%E8%B1%A1%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">æ ¸å¿ƒæ¥å£ä¸æŠ½è±¡ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sorted-%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.2.1.</span> <span class="toc-text">Sorted æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sortedmap"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">SortedMap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sortedset"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">SortedSet</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#navigable-%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.2.2.</span> <span class="toc-text">Navigable æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">å¯¼èˆªæ–¹æ³•ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8C%83%E5%9B%B4%E8%A7%86%E5%9B%BE%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">èŒƒå›´è§†å›¾ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%8D%E5%BA%8F%E8%A7%86%E5%9B%BE%E4%B8%8E%E8%BE%B9%E7%95%8C%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">é™åºè§†å›¾ä¸è¾¹ç•Œæ“ä½œ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#abstractlist-%E4%B8%8E-abstractsequentiallist"><span class="toc-number">1.2.3.</span> <span class="toc-text">AbstractList ä¸ AbstractSequentialList</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#abstractlist"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">AbstractList</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#abstractsequentiallist"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">AbstractSequentialList</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%9F%E5%88%97%E4%BD%93%E7%B3%BB"><span class="toc-number">1.3.</span> <span class="toc-text">é˜Ÿåˆ—ä½“ç³»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%9F%E5%88%97%E7%9A%84%E5%85%AD%E4%B8%AA%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.1.</span> <span class="toc-text">é˜Ÿåˆ—çš„å…­ä¸ªæ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">æ·»åŠ æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">æŸ¥è¯¢æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%BB%E9%99%A4%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">ç§»é™¤æ“ä½œ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#priorityqueue"><span class="toc-number">1.3.2.</span> <span class="toc-text">PriorityQueue</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#top-k-%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Top-K é—®é¢˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">ä»»åŠ¡è°ƒåº¦</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#delayqueue"><span class="toc-number">1.3.3.</span> <span class="toc-text">DelayQueue</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">å®é™…åº”ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88"><span class="toc-number">1.4.</span> <span class="toc-text">æœ‰åºé›†åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#treeset-%E4%B8%8E-treemap"><span class="toc-number">1.4.1.</span> <span class="toc-text">TreeSet ä¸ TreeMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%92%E5%BA%8F"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">è‡ªå®šä¹‰æ’åº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">å®é™…åº”ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#linkedhashmap-%E4%B8%8E-linkedhashset"><span class="toc-number">1.4.2.</span> <span class="toc-text">LinkedHashMap ä¸ LinkedHashSet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%9D%E6%8C%81%E6%8F%92%E5%85%A5%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">ä¿æŒæ’å…¥é¡ºåº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%9D%E6%8C%81%E8%AE%BF%E9%97%AE%E9%A1%BA%E5%BA%8F-lru-%E7%BC%93%E5%AD%98"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">ä¿æŒè®¿é—®é¡ºåºï¼ˆLRU ç¼“å­˜ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lru-%E7%BC%93%E5%AD%98%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">LRU ç¼“å­˜å®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">æ€§èƒ½å¯¹æ¯”</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E4%B8%93%E7%94%A8%E9%9B%86%E5%90%88"><span class="toc-number">1.5.</span> <span class="toc-text">æšä¸¾ä¸“ç”¨é›†åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#enumset"><span class="toc-number">1.5.1.</span> <span class="toc-text">EnumSet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#enumset-%E7%9A%84%E9%99%90%E5%88%B6"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">EnumSet çš„é™åˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">åˆ›å»ºä¸ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jdk-%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">JDK å®ç°ç»†èŠ‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8A%BF"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">æ€§èƒ½ä¼˜åŠ¿</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#enummap"><span class="toc-number">1.5.2.</span> <span class="toc-text">EnumMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">åˆ›å»ºä¸ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">é«˜çº§ç”¨æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8A%BF"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">æ€§èƒ½ä¼˜åŠ¿</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%94%A8%E9%80%94%E9%9B%86%E5%90%88"><span class="toc-number">1.6.</span> <span class="toc-text">ç‰¹æ®Šç”¨é€”é›†åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#identityhashmap"><span class="toc-number">1.6.1.</span> <span class="toc-text">IdentityHashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E9%80%94"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">ç”¨é€”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">ä½¿ç”¨ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">å®é™…åº”ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#weakhashmap"><span class="toc-number">1.6.2.</span> <span class="toc-text">WeakHashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%B1%E5%BC%95%E7%94%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">å¼±å¼•ç”¨æœºåˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">å®é™…åº”ç”¨åœºæ™¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">æ³¨æ„äº‹é¡¹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#copyonwritearraylist"><span class="toc-number">1.6.3.</span> <span class="toc-text">CopyOnWriteArrayList</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">è¯»æ“ä½œçš„ä¸€è‡´æ€§é—®é¢˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">é€‚ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E9%9B%86%E5%90%88"><span class="toc-number">1.7.</span> <span class="toc-text">å¹¶å‘é›†åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#concurrentskiplistset-%E4%B8%8E-concurrentskiplistmap"><span class="toc-number">1.7.1.</span> <span class="toc-text">ConcurrentSkipListSet ä¸ ConcurrentSkipListMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%B3%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">è·³è¡¨ç»“æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">ä½¿ç”¨ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">å®é™…åº”ç”¨åœºæ™¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%89%B9%E7%82%B9"><span class="toc-number">1.7.1.4.</span> <span class="toc-text">æ€§èƒ½ç‰¹ç‚¹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.8.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2017 - 2026 By magicliang</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">ç°¡</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="/js/tw_cn.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="/"></script></div></body></html>