<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>æ³›å‹æ‹¾é— | å®ˆæ ªé˜</title><meta name="author" content="magicliang"><meta name="copyright" content="magicliang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="åŸºæœ¬è®¾è®¡åŸåˆ™  how codes should vary in different types. compatible with other release. before generic classï¼Œgeneric programming was achieved with inheritanceï¼šåœ¨æ‰€æœ‰åæ¥ä½¿ç”¨Tçš„åœ°æ–¹ä½¿ç”¨Objectæˆ–è€…Objectæ•°ç»„ã€‚ç»å…¸çš„çŒ«ç‹—åˆ—è¡¨é—®é¢˜çš„æ¥æºã€‚  åŸºæœ¬è¯­">
<meta property="og:type" content="article">
<meta property="og:title" content="æ³›å‹æ‹¾é—">
<meta property="og:url" content="https://magicliang.github.io/2020/02/23/%E6%B3%9B%E5%9E%8B%E6%8B%BE%E9%81%97/index.html">
<meta property="og:site_name" content="å®ˆæ ªé˜">
<meta property="og:description" content="åŸºæœ¬è®¾è®¡åŸåˆ™  how codes should vary in different types. compatible with other release. before generic classï¼Œgeneric programming was achieved with inheritanceï¼šåœ¨æ‰€æœ‰åæ¥ä½¿ç”¨Tçš„åœ°æ–¹ä½¿ç”¨Objectæˆ–è€…Objectæ•°ç»„ã€‚ç»å…¸çš„çŒ«ç‹—åˆ—è¡¨é—®é¢˜çš„æ¥æºã€‚  åŸºæœ¬è¯­">
<meta property="og:locale">
<meta property="og:image" content="https://magicliang.github.io/img/wall-paper-46.jpg">
<meta property="article:published_time" content="2020-02-23T07:48:31.000Z">
<meta property="article:modified_time" content="2026-02-09T16:36:28.318Z">
<meta property="article:author" content="magicliang">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://magicliang.github.io/img/wall-paper-46.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æ³›å‹æ‹¾é—",
  "url": "https://magicliang.github.io/2020/02/23/%E6%B3%9B%E5%9E%8B%E6%8B%BE%E9%81%97/",
  "image": "https://magicliang.github.io/img/wall-paper-46.jpg",
  "datePublished": "2020-02-23T07:48:31.000Z",
  "dateModified": "2026-02-09T16:36:28.318Z",
  "author": [
    {
      "@type": "Person",
      "name": "magicliang",
      "url": "https://magicliang.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://magicliang.github.io/2020/02/23/%E6%B3%9B%E5%9E%8B%E6%8B%BE%E9%81%97/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: magicliang","link":"Link: ","source":"Source: å®ˆæ ªé˜","info":"Copyright belongs to the author. For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source."}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'æ³›å‹æ‹¾é—',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="å®ˆæ ªé˜" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/wall-paper-46.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">å®ˆæ ªé˜</span></a><a class="nav-page-title" href="/"><span class="site-name">æ³›å‹æ‹¾é—</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">æ³›å‹æ‹¾é—</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-02-23T07:48:31.000Z" title="Created 2020-02-23 15:48:31">2020-02-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-09T16:36:28.318Z" title="Updated 2026-02-10 00:36:28">2026-02-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">15.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>64mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>åŸºæœ¬è®¾è®¡åŸåˆ™</h1>
<ul>
<li>how codes should vary in different types.</li>
<li>compatible with other release.</li>
<li>before generic classï¼Œgeneric programming was achieved with inheritanceï¼šåœ¨æ‰€æœ‰åæ¥ä½¿ç”¨Tçš„åœ°æ–¹ä½¿ç”¨Objectæˆ–è€…Objectæ•°ç»„ã€‚ç»å…¸çš„çŒ«ç‹—åˆ—è¡¨é—®é¢˜çš„æ¥æºã€‚</li>
</ul>
<h1>åŸºæœ¬è¯­æ³•</h1>
<ul>
<li>java çš„æ³›å‹æ²¡æœ‰ template å…³é”®å­—ã€‚è¡¨é¢ä¸Šï¼ˆsuperficiallyï¼‰çœ‹å’Œ C++ å¹¶æ— äºŒè‡´ï¼Œå®é™…ä¸Šæœ‰å¤§é‡å·®åˆ«</li>
<li>ä¸‰ç§åŸºæœ¬æ¦‚å¿µï¼š
<ul>
<li>Type Parameterï¼ˆç±»å‹å½¢å‚ï¼‰ï¼šåœ¨æ³›å‹ç±»ã€æ¥å£æˆ–æ–¹æ³•å£°æ˜æ—¶ä½¿ç”¨çš„æ ‡è¯†ç¬¦ã€‚
<ul>
<li><code>class Box&lt;T&gt;</code> ä¸­çš„ Tã€‚</li>
<li>ä½†æ˜¯åœ¨ Java æ ¸å¿ƒæŠ€æœ¯ä¸­ï¼Œ<code>List&lt;String&gt;</code>ä¸­çš„Stringä¹Ÿç»å¸¸è¢«æè¿°ä¸º Type Parameterã€‚<code>Container.class.getTypeParameters()</code>å¾—åˆ°çš„ä¹Ÿæ˜¯<code>T</code>ã€‚</li>
</ul>
</li>
<li>Type Variableï¼ˆç±»å‹å˜é‡ï¼‰ï¼šç±»å‹å‚æ•°åœ¨ä»£ç ä¸­çš„å¼•ç”¨ã€‚
<ul>
<li>å¯ä»¥è®¤ä¸ºæ˜¯ç±»å‹å‚æ•°çš„ä¸€ä¸ª&quot;å®ä¾‹&quot;ã€‚åœ¨<code>class Box&lt;T&gt; { T value; }</code> ä¸­ï¼Œvalue çš„ç±»å‹Tæ˜¯ä¸€ä¸ªç±»å‹å˜é‡ï¼ˆè€Œä¸æ˜¯å ä½ç¬¦Tï¼‰ã€‚è®¸å¤šæ–‡æ¡£ä¸­&quot;ç±»å‹å‚æ•°&quot;å’Œ&quot;ç±»å‹å˜é‡&quot;å¯äº’æ¢ä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>Type Argumentï¼ˆç±»å‹å®å‚ï¼‰ï¼šåœ¨ä½¿ç”¨æ³›å‹ç±»å‹æ—¶ï¼Œæä¾›çš„å…·ä½“ç±»å‹ã€‚
<ul>
<li>åœ¨è°ƒç”¨æˆ–å®ä¾‹åŒ–æ—¶æä¾›ã€‚<code>Box&lt;Integer&gt;</code>ä¸­çš„<code>Integer</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç±»å‹å‚æ•°Tåœ¨ç±»å£°æ˜ä¸­å¼•å…¥</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">List</span>&lt;T&gt; &#123;<br>    <span class="hljs-comment">// Tç”¨ä½œç±»å‹å˜é‡</span><br>    <span class="hljs-keyword">private</span> T[] elements;<br>    <br>    <span class="hljs-comment">// Tç»§ç»­ç”¨ä½œç±»å‹å˜é‡</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(T element)</span> &#123;<br>        <span class="hljs-comment">// ...å®ç°ä»£ç </span><br>    &#125;<br>    <br>    <span class="hljs-comment">// Eæ˜¯æ–°çš„ç±»å‹å‚æ•°ï¼Œç”¨äºæ­¤æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> &lt;E&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">addAll</span><span class="hljs-params">(Collection&lt;E&gt; items, Function&lt;E, T&gt; converter)</span> &#123;<br>        <span class="hljs-comment">// ...å®ç°ä»£ç </span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Stringæ˜¯ç±»å‹å®å‚ï¼Œå®ä¾‹åŒ–æ—¶æä¾›</span><br>List&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br></code></pre></td></tr></table></figure>
<ul>
<li>æ³›å‹ç±»çš„ type parameter çš„å£°æ˜åœ¨ç±»èƒŒåã€‚æ³›å‹æ–¹æ³•çš„ type parameter åœ¨ modifierï¼ˆ<code>public static</code>ï¼‰å’Œ<code>return value</code>ä¹‹é—´ã€‚
<ul>
<li>åœ¨ C++ é‡Œï¼Œ<code>f(g&lt;a,b&gt;(c))</code>æœ‰ä¸¤ä¸ªæ„æ€ï¼šä½¿ç”¨<code>g&lt;a,b&gt;(c)</code>çš„ç»“æœè°ƒç”¨fï¼›æˆ–è€…ä½¿ç”¨<code>g&lt;a</code>å’Œ<code>b&gt;(c)</code>è°ƒç”¨ fã€‚æ‰€ä»¥ java æ³›å‹å‚æ•°è¦å†™åœ¨æ–¹æ³•å‰é¢ï¼Œç±»å‹è§è¯ä¹Ÿåœ¨æ–¹æ³•å‰é¢ã€‚</li>
</ul>
</li>
<li><code>List&lt;T&gt;</code> æ˜¯ generic typeã€‚<code>List&lt;String&gt;</code>æ˜¯ Parameterized typeã€‚</li>
</ul>
<h1>è¾¹ç•Œ/ç»‘å®šç±»å‹ï¼ˆbounding typeï¼‰</h1>
<p>åœ¨Javaæ³›å‹çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œâ€œbound&quot;ä¸€è¯æœ€å‡†ç¡®çš„ç¿»è¯‘æ˜¯**â€œè¾¹ç•Œâ€(boundary)**è€Œé&quot;ç»‘å®šâ€ã€‚Javaå®˜æ–¹æ–‡æ¡£ä¸€è‡´ä½¿ç”¨&quot;upper bound&quot;(ä¸Šè¾¹ç•Œ)å’Œ&quot;lower bound&quot;(ä¸‹è¾¹ç•Œ)è¿™æ ·çš„æœ¯è¯­ï¼Œè¿™äº›æœ¯è¯­åœ¨æ•°å­¦å’Œé›†åˆè®ºä¸­è¡¨ç¤ºè¾¹ç•Œæ¦‚å¿µã€‚</p>
<ul>
<li>åœ¨ç±»å‹å‚æ•° T å£°æ˜æ—¶å°±æŒ‡å®š boundï¼Œè€Œä¸æ˜¯åœ¨ä½œä¸ºå±€éƒ¨å˜é‡æˆ–è€…è¿”å›å€¼æ—¶ã€‚</li>
<li>æ˜ç¡®è¦ç»‘å®š type variable åˆ°æŸä¸ªç±»å‹ï¼ˆ<code>T extends BoundinType</code>ï¼Œæ“¦é™¤åˆ°è¿™ä¸ª BoundinTypeï¼‰-å¾—åˆ° type argumentï¼Œ<strong>æ‰å¯ä»¥åœ¨æ¥ä¸‹æ¥çš„æ–¹æ³•é‡Œè°ƒç”¨é‚£ä¸ªç±»å‹çš„æ–¹æ³•</strong>ï¼Œå¦‚éœ€è¦ <code>compareTo</code> æ–¹æ³•ï¼Œå°±å¿…é¡»<code>&lt;T extends Comparable&lt;T&gt;&gt;</code>ã€‚<code>extends</code>æœ¬èº«å¯ä»¥åæ¥å¤šä¸ªç»‘å®šç±»å‹ï¼Œç”¨<code>&amp;</code>åˆ†éš”ã€‚
<ul>
<li>è¿™ç‚¹åŒ C++ æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æ˜¯ä¸ºäº†è°ƒç”¨æŸä¸ªæ–¹æ³•æ‰æŒ‡å®šäº† boundã€‚</li>
<li>extends ä»£è¡¨ subtype concept çš„ approximationï¼Œå¹¶ä¸æ˜¯æ‰©å±•çš„æ„æ€ï¼Œåœ¨ bound çš„ä½¿ç”¨é‡Œï¼Œå®ƒç»Ÿä¸€äº†æ‰©å±•ä¸å®ç°ã€‚
<ul>
<li>extends åªèƒ½æœ‰ä¸€ä¸ª classï¼Œç”¨ampersand(<code>&amp;</code>)æ¥åˆ†éš”å„ç§ç±»å‹ï¼Œç”¨<code>,</code>æ¥åˆ†éš” type variablesã€‚è¿™ä¼šåˆ¶é€ æœ‰é™çš„è±å½¢ç»§æ‰¿é—®é¢˜-è¿™å’Œ java å•ç»§æ‰¿çš„æ€è·¯ä¸€è‡´ã€‚
<ul>
<li><code>T extends Comaprable &amp; Serializable</code> ä¼šæŠŠ T æ“¦é™¤åˆ° Comaprableï¼ˆfirst boundï¼‰ï¼Œåœ¨æŸäº›éœ€è¦ä½œä¸º Serializable çš„æ—¶å€™åˆ™ç¼–è¯‘å™¨æ’å…¥ä¸€ä¸ª cast instructionï¼ˆå¦‚æœå¿…è¦çš„è¯ï¼Œjava ç”šè‡³ä¼šå¯¹<code>.</code>å–å€¼æ“ä½œç¬¦è¿›è¡Œ castæŒ‡ä»¤æ’å…¥ï¼‰ - java çš„ç¼–è¯‘å™¨åšè¿™ç§æ’å…¥å¯¹ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ç®—å¾—ä¸Šæ˜¯å¯æ’æ‹”çš„äº†ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="é€’å½’æ³›å‹è¾¹ç•Œæ¨¡å¼-recursive-generic-type-bounds">é€’å½’æ³›å‹è¾¹ç•Œæ¨¡å¼ï¼ˆRecursive Generic Type Boundsï¼‰</h2>
<p>è¿™æ˜¯è¢«ç§°ä½œâ€œF-boundedå¤šæ€â€ï¼ˆF-bounded polymorphismï¼‰æˆ–&quot;é€’å½’æ³›å‹è¾¹ç•Œ&quot;çš„é«˜çº§æ³›å‹è®¾è®¡æ¨¡å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepresentationModel</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RepresentationModel</span>&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">T</span>&gt;&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li>Tå¿…é¡»æ˜¯RepresentationModelçš„å­ç±»</li>
<li>å¹¶ä¸”è¿™ä¸ªå­ç±»çš„æ³›å‹å‚æ•°å¿…é¡»æ˜¯Tè‡ªèº«æˆ–Tçš„æŸä¸ªå­ç±»</li>
</ul>
<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼š<code>RepresentationModel - type parameter æ˜¯ -&gt; T &lt;- æ˜¯å­ç±»ï¼Œä¸”è¿™ä¸ªå­ç±»çš„ type argument æ˜¯ T è‡ªå·± - RepresentationModel</code>ã€‚</p>
<p>å¦‚æœä¸ä½¿ç”¨è¿™ç§ç±»å‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä¸ä½¿ç”¨é€’å½’æ³›å‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceModel</span> &#123;<br>    <span class="hljs-keyword">public</span> ResourceModel <span class="hljs-title function_">addLink</span><span class="hljs-params">(String rel, String href)</span> &#123;<br>        <span class="hljs-comment">// æ·»åŠ é“¾æ¥çš„é€»è¾‘</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserModel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ResourceModel</span> &#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-comment">// å…¶ä»–ç”¨æˆ·ç‰¹æœ‰å±æ€§å’Œæ–¹æ³•...</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä½¿ç”¨æ—¶ä¼šé­é‡ç¼–è¯‘é”™è¯¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">UserModel</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserModel</span>();<br><span class="hljs-comment">// è¿”å›ç±»å‹æ˜¯ResourceModelï¼Œè€Œä¸æ˜¯UserModel</span><br><span class="hljs-type">ResourceModel</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> user.addLink(<span class="hljs-string">&quot;self&quot;</span>, <span class="hljs-string">&quot;/users/123&quot;</span>); <br><span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼šResourceModelç±»å‹æ²¡æœ‰getUsername()æ–¹æ³•</span><br><span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> result.getUsername(); <br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒæ˜¯ï¼Œæœ‰äº› fluent API æœ¬èº«è¿”å›è‡ªèº«ï¼Œè¿™ç§è‡ªèº«ä¸èƒ½è¿”å›å­ç±»æ—¶ï¼Œçˆ¶å­æ··åˆ build ä¼šäº§ç”Ÿå¥‡æ€ªçš„é—®é¢˜ã€‚</p>
<p>è§£æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepresentationModel</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RepresentationModel</span>&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">T</span>&gt;&gt; &#123;<br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">addLink</span><span class="hljs-params">(String rel, String href)</span> &#123;<br>        <span class="hljs-comment">// æ·»åŠ é“¾æ¥çš„é€»è¾‘</span><br>        <span class="hljs-keyword">return</span> self();<br>    &#125;<br>    <br>    <span class="hljs-comment">// è¿”å›å­ç±»å‹çš„æ—¶å€™æ˜¯å¼ºè¡Œè½¬çš„ï¼Œè¿™ä¸€æ­¥æ˜¯è¿™ç±»æ¨¡å¼å¿…é¡»çš„</span><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">private</span> T <span class="hljs-title function_">self</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> (T) <span class="hljs-built_in">this</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserModel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RepresentationModel</span>&lt;UserModel&gt; &#123;<br>    <span class="hljs-keyword">private</span> String username;<br>    <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> username;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ—¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">UserModel</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserModel</span>();<br><span class="hljs-comment">// ç°åœ¨è¿”å›ç±»å‹ä»ç„¶æ˜¯UserModel</span><br><span class="hljs-type">UserModel</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> user.addLink(<span class="hljs-string">&quot;self&quot;</span>, <span class="hljs-string">&quot;/users/123&quot;</span>);<br><span class="hljs-comment">// å®Œå…¨ç±»å‹å®‰å…¨ï¼Œç¼–è¯‘é€šè¿‡</span><br><span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> result.getUsername();<br></code></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹æ¡ˆçš„åšæ³•æ˜¯ï¼š</p>
<ol>
<li>çˆ¶ç±»æ‰€æœ‰æ–¹æ³•éƒ½ä½¿ç”¨ T ä½œä¸º type variableã€‚åœ¨çˆ¶è½¬å­çš„æ—¶å€™ï¼Œä½¿ç”¨è½¬å‹ï¼Œå¿½ç•¥è­¦å‘Šã€‚</li>
<li>æµå¼è°ƒç”¨çš„æ—¶å€™éƒ½è½¬ä¸ºè‡ªå·±ã€‚</li>
</ol>
<p>æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li>ç±»å‹å®‰å…¨çš„æ–¹æ³•é“¾ï¼šå­ç±»è°ƒç”¨çˆ¶ç±»æ–¹æ³•æ—¶è¿”å›çš„ä»ç„¶æ˜¯å­ç±»ç±»å‹ã€‚</li>
<li>ä»£ç å¤ç”¨ï¼šçˆ¶ç±»å¯ä»¥å®ç°é€šç”¨åŠŸèƒ½ï¼Œå­ç±»æ— éœ€é‡å†™è¿™äº›æ–¹æ³•ã€‚</li>
<li>IDEæ”¯æŒï¼šæ™ºèƒ½æç¤ºå’Œè‡ªåŠ¨å®Œæˆå¯ä»¥æ­£ç¡®æ˜¾ç¤ºè¿”å›å¯¹è±¡çš„å¯ç”¨æ–¹æ³•ã€‚</li>
</ul>
<p>è¿™ç§æ¨¡å¼å¹¿æ³›åº”ç”¨äºå„ç§Javaåº“ä¸­ï¼š</p>
<ul>
<li>Javaçš„<code>Enum&lt;E extends Enum&lt;E&gt;&gt;</code>ã€‚
<ul>
<li><code>public abstract class Enum&lt;E extends Enum&lt;E&gt;&gt; implements Comparable&lt;E&gt;, Serializable {}</code>
<ul>
<li>ç¡®ä¿ç±»å‹å®‰å…¨ï¼š<code>&lt;E extends Enum&lt;E&gt;&gt;</code> è¿™ç§é€’å½’æ³›å‹å®šä¹‰ç¡®ä¿äº†æšä¸¾ç±»å‹åªèƒ½è¢«å…¶å­ç±»å®ä¾‹åŒ–</li>
<li>æä¾›ç±»å‹æ­£ç¡®çš„æ–¹æ³•ï¼šä½¿å¾—åƒ compareTo è¿™æ ·çš„æ–¹æ³•èƒ½å¤Ÿæ­£ç¡®æ¥æ”¶å­ç±»ç±»å‹çš„å‚æ•°</li>
<li>å®ç°è‡ªå¼•ç”¨æ³›å‹ï¼šå…è®¸æšä¸¾ç±»å¼•ç”¨è‡ªèº«ç±»å‹</li>
<li><strong>æç«¯é‡è¦ï¼æ›´å¤æ‚çš„ä¾‹å­</strong>ï¼Œ<code>&lt;</code>å‰è¾¹çš„éƒ¨åˆ†ï¼Œæ°å¥½æ˜¯<code>&gt;</code>å‰è¾¹çš„éƒ¨åˆ†åŠ ä¸Šä¸€ä¸ª<code>&lt;?&gt;</code>ï¼Œä¸­é—´æ’å…¥ä¸€ä¸ª<code>? extends</code>ï¼š<code>java.lang.Object&amp;java.lang.Serializable&amp;java.lang.Comparable&lt;? extends java.lang.Object&amp;java.lang.Serializable&amp;java.lang.Comparable&lt;?&gt;&gt;</code></li>
</ul>
</li>
</ul>
</li>
<li>JPAçš„CriteriaBuilder</li>
<li>Stream API-æ˜“è¢«å¿½ç•¥</li>
<li>å„ç§æ„å»ºå™¨æ¨¡å¼å®ç°</li>
</ul>
<h3 id="æ³¨æ„å’Œ-comparable-æ¯”è¾ƒ">æ³¨æ„å’Œ Comparable æ¯”è¾ƒ</h3>
<ol>
<li><code>&lt;T extends Comparable&lt;T&gt;&gt;</code> æ„å‘³ç€ T åŠ å…¥äº†ä¸€ç§ä»¥è‡ªå·±ä¸ºç›®æ ‡çš„æ··å‹èƒ½åŠ›ã€‚</li>
<li><code>RepresentationModel&lt;T extends RepresentationModel&lt;? extends T&gt;&gt;</code>æ„å‘³ç€è¿™ç§ç±»å‹è¦ä½¿ç”¨æŸäº›çˆ¶å­ç±»å‹éƒ½å…±ç”¨çš„æ“ä½œï¼Œå¿…é¡»è®©æ“ä½œèƒ½å¤Ÿ<strong>è¿”å›å­ç±»å‹</strong>è€Œä¸æ˜¯çˆ¶ç±»å‹ã€‚å®ç°<strong>è‡ªå¼•ç”¨ç±»å‹å±‚æ¬¡ç»“æ„</strong>ã€‚
<ul>
<li>ç±»ä¼¼çš„ä¾‹å­è¿˜æœ‰ï¼š<code>public static &lt;T&gt; List&lt;T&gt; unmodifiableList(List&lt;? extends T&gt; list)</code>ã€‚è¿™ç§ T æ€»æ˜¯åœ¨è¿œå¤„ä½œä¸ºä¸€ä¸ªèµ·ç‚¹ä½¿ç”¨ã€‚å®é™…çš„ç±»å‹çš„å¤šé‡ç»‘å®šè¿˜è¦å‡ºç°åœ¨æ–¹æ³•å‚æ•°æˆ–è€…è¿”å›å€¼é‡Œã€‚</li>
</ul>
</li>
<li><code>Comparable&lt;T extends Comparable&lt;? super T&gt;&gt;</code>ï¼Œæ„å‘³ç€<strong>éœ€è¦ä¸çˆ¶ç±»å‹è¿›è¡Œæ¯”è¾ƒæ“ä½œ</strong>ã€‚</li>
</ol>
<h3 id="äº¤å‰ç±»å‹-intersection-types">äº¤å‰ç±»å‹ï¼ˆIntersection Typesï¼‰</h3>
<p>ç±»å‹å‚æ•°å¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªè¾¹ç•Œï¼Œè¯­æ³•ä¸º <code>&lt;T extends A &amp; B &amp; C&gt;</code>ã€‚è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li>æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªç±»è¾¹ç•Œï¼Œä¸”å¿…é¡»æ”¾åœ¨ç¬¬ä¸€ä½</li>
<li>æ¥å£è¾¹ç•Œå¯ä»¥æœ‰å¤šä¸ª</li>
<li>æ“¦é™¤åçš„ç±»å‹ä¸ºç¬¬ä¸€ä¸ªè¾¹ç•Œ</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-comment">// T å¿…é¡»åŒæ—¶æ˜¯ Comparable å’Œ Serializable</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Pair</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Comparable</span>&lt;T&gt; &amp; Serializable&gt; &#123;<br>    <span class="hljs-keyword">private</span> T first;<br>    <span class="hljs-keyword">private</span> T second;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Pair</span><span class="hljs-params">(T first, T second)</span> &#123;<br>        <span class="hljs-built_in">this</span>.first = first;<br>        <span class="hljs-built_in">this</span>.second = second;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">max</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> first.compareTo(second) &gt;= <span class="hljs-number">0</span> ? first : second;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>äº¤å‰ç±»å‹åœ¨ Lambda è¡¨è¾¾å¼ä¸­ä¹Ÿæœ‰ç‰¹æ®Šç”¨é€”â€”â€”å¯ä»¥å°† Lambda åŒæ—¶è½¬æ¢ä¸ºå¤šä¸ªç±»å‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.util.function.Predicate;<br><br><span class="hljs-comment">// Lambda åŒæ—¶æ»¡è¶³ Predicate å’Œ Serializable</span><br>Predicate&lt;String&gt; predicate = (Predicate&lt;String&gt; &amp; Serializable) s -&gt; s.length() &gt; <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure>
<h3 id="é€’å½’ç±»å‹è¾¹ç•Œ">é€’å½’ç±»å‹è¾¹ç•Œ</h3>
<p>é€’å½’ç±»å‹è¾¹ç•Œï¼ˆRecursive Type Boundï¼‰æ˜¯æŒ‡ç±»å‹å‚æ•°ä»¥è‡ªèº«ä¸ºè¾¹ç•Œçš„æ¨¡å¼ï¼Œæœ€å…¸å‹çš„å½¢å¼ä¸º <code>&lt;T extends Comparable&lt;T&gt;&gt;</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecursiveBoundExample</span> &#123;<br>    <span class="hljs-comment">// T å¿…é¡»èƒ½ä¸è‡ªèº«æ¯”è¾ƒ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Comparable</span>&lt;T&gt;&gt; T <span class="hljs-title function_">findMax</span><span class="hljs-params">(List&lt;T&gt; list)</span> &#123;<br>        <span class="hljs-type">T</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> list.get(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">for</span> (T element : list) &#123;<br>            <span class="hljs-keyword">if</span> (element.compareTo(max) &gt; <span class="hljs-number">0</span>) &#123;<br>                max = element;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> max;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é€’å½’ç±»å‹è¾¹ç•Œç¡®ä¿äº†ç±»å‹å‚æ•°å…·å¤‡ä¸è‡ªèº«åŒç±»å‹å¯¹è±¡äº¤äº’çš„èƒ½åŠ›ã€‚<code>Comparable&lt;T&gt;</code> çš„ <code>compareTo</code> æ–¹æ³•æ¥å— <code>T</code> ç±»å‹å‚æ•°ï¼Œå› æ­¤ <code>T extends Comparable&lt;T&gt;</code> ä¿è¯äº† <code>T</code> çš„å®ä¾‹å¯ä»¥ä¸å…¶ä»– <code>T</code> å®ä¾‹è¿›è¡Œæ¯”è¾ƒã€‚</p>
<h3 id="è‡ªé™å®šç±»å‹-self-bounded-types">è‡ªé™å®šç±»å‹ï¼ˆSelf-bounded Typesï¼‰</h3>
<p>è‡ªé™å®šç±»å‹æ˜¯é€’å½’ç±»å‹è¾¹ç•Œçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå¸¸è§äºåŸºç±»å®šä¹‰ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SelfBounded</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SelfBounded</span>&lt;T&gt;&gt; &#123;<br>    <span class="hljs-keyword">protected</span> T <span class="hljs-title function_">self</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>        <span class="hljs-type">T</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> (T) <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// å­ç±»å°†è‡ªèº«ä½œä¸ºç±»å‹å‚æ•°ä¼ å…¥</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteType</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SelfBounded</span>&lt;ConcreteType&gt; &#123;<br>    <span class="hljs-keyword">public</span> ConcreteType <span class="hljs-title function_">doSomething</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// self() è¿”å› ConcreteType è€Œé SelfBounded</span><br>        <span class="hljs-keyword">return</span> self();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>java.lang.Enum</code> çš„å£°æ˜ <code>Enum&lt;E extends Enum&lt;E&gt;&gt;</code> æ˜¯è‡ªé™å®šç±»å‹çš„ç»å…¸åº”ç”¨ã€‚è¿™ä¸€æ¨¡å¼ç¡®ä¿å­ç±»å‹çš„æ–¹æ³•è¿”å›å€¼å’Œå‚æ•°ç±»å‹æ˜¯å­ç±»å‹è‡ªèº«ï¼Œè€Œéçˆ¶ç±»å‹ã€‚</p>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šç±»å‹è‡ªçº¦æŸ</strong></p>
<p>é€’å½’ç±»å‹è¾¹ç•Œå’Œè‡ªé™å®šç±»å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯&quot;ç±»å‹å‚æ•°çº¦æŸè‡ªèº«&quot;ã€‚å½“éœ€è¦åœ¨åŸºç±»ä¸­å®šä¹‰è¿”å›å­ç±»å‹çš„æ–¹æ³•ï¼ˆå¦‚ Builder é“¾å¼è°ƒç”¨ã€<code>compareTo</code> æ¯”è¾ƒï¼‰æ—¶ï¼Œä½¿ç”¨ <code>&lt;T extends Base&lt;T&gt;&gt;</code> æ¨¡å¼ã€‚<code>Enum&lt;E extends Enum&lt;E&gt;&gt;</code> æ˜¯ JDK ä¸­æœ€è‘—åçš„åº”ç”¨ã€‚</p>
<h1>ç±»å‹æ“¦é™¤ï¼ˆtype erasureï¼‰</h1>
<p>ç±»å‹æ“¦é™¤æ˜¯ Java æ³›å‹å®ç°çš„æ ¸å¿ƒæœºåˆ¶ã€‚ä¸ C++ æ¨¡æ¿åœ¨ç¼–è¯‘æ—¶ä¸ºæ¯ä¸ªç±»å‹å‚æ•°ç”Ÿæˆç‹¬ç«‹ä»£ç ä¸åŒï¼ŒJava ç¼–è¯‘å™¨åœ¨ç¼–è¯‘åå°†æ‰€æœ‰æ³›å‹ç±»å‹ä¿¡æ¯ç§»é™¤ï¼Œæ›¿æ¢ä¸ºå…¶è¾¹ç•Œç±»å‹ï¼ˆæ— è¾¹ç•Œæ—¶ä¸º <code>Object</code>ï¼‰ã€‚è¿™ä¸€è®¾è®¡çš„æ ¹æœ¬åŸå› æ˜¯<strong>å‘åå…¼å®¹</strong>ï¼šJava 5 å¼•å…¥æ³›å‹æ—¶ï¼Œå¿…é¡»ç¡®ä¿æ³›å‹ä»£ç èƒ½ä¸ Java 1.4 åŠæ›´æ—©ç‰ˆæœ¬çš„å­—èŠ‚ç æ— ç¼äº’æ“ä½œã€‚</p>
<p>æ“¦é™¤éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š</p>
<table>
<thead>
<tr>
<th>æºç ä¸­çš„ç±»å‹</th>
<th>æ“¦é™¤åçš„ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>T</code>ï¼ˆæ— è¾¹ç•Œï¼‰</td>
<td><code>Object</code></td>
<td>æœ€å¸¸è§çš„æƒ…å†µ</td>
</tr>
<tr>
<td><code>T extends Number</code></td>
<td><code>Number</code></td>
<td>æ›¿æ¢ä¸ºç¬¬ä¸€ä¸ªè¾¹ç•Œ</td>
</tr>
<tr>
<td><code>T extends Comparable &amp; Serializable</code></td>
<td><code>Comparable</code></td>
<td>å¤šè¾¹ç•Œå–ç¬¬ä¸€ä¸ª</td>
</tr>
<tr>
<td><code>List&lt;String&gt;</code></td>
<td><code>List</code></td>
<td>å‚æ•°åŒ–ç±»å‹æ“¦é™¤ä¸ºåŸå§‹ç±»å‹</td>
</tr>
<tr>
<td><code>T[]</code></td>
<td><code>Object[]</code>ï¼ˆæˆ–è¾¹ç•Œç±»å‹æ•°ç»„ï¼‰</td>
<td>æ³›å‹æ•°ç»„æ“¦é™¤</td>
</tr>
</tbody>
</table>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šæ“¦é™¤å³é€€åŒ–</strong></p>
<p>ç±»å‹æ“¦é™¤çš„æœ¬è´¨æ˜¯ç¼–è¯‘æœŸçš„ç±»å‹ä¸°å¯Œä¿¡æ¯åœ¨è¿è¡Œæ—¶é€€åŒ–ä¸ºè¾¹ç•Œç±»å‹ã€‚ç†è§£è¿™ä¸€ç‚¹æ˜¯ç†è§£æ‰€æœ‰æ³›å‹é™åˆ¶ï¼ˆä¸èƒ½ <code>new T()</code>ã€ä¸èƒ½ <code>instanceof T</code>ã€ä¸èƒ½åˆ›å»ºæ³›å‹æ•°ç»„ï¼‰çš„é’¥åŒ™ï¼šè¿™äº›æ“ä½œéƒ½éœ€è¦è¿è¡Œæ—¶çš„å…·ä½“ç±»å‹ä¿¡æ¯ï¼Œè€Œæ“¦é™¤æ°æ°ç§»é™¤äº†è¿™äº›ä¿¡æ¯ã€‚</p>
<ul>
<li>æ“¦é™¤çš„ç›®çš„ï¼šä¸ºäº† interoperability between generic and legacy codeã€‚æ‰€ä»¥æŠŠç±»å‹ä¿¡æ¯å…¨æ“¦é™¤æˆæ— æ³›å‹ï¼Œèƒ½åœ¨ java 1.0 ä¸Šè¿è¡Œçš„å­—èŠ‚ç ã€‚</li>
<li>ç±»å‹æ“¦é™¤çš„ç»“æœï¼šå°† type variable æ›¿æ¢æˆ<strong>ç»‘å®šç±»å‹ï¼ˆBoundingTypeï¼‰è€Œä¸æ˜¯ç±»å‹å®å‚</strong>çš„ ordinary classã€‚å¦‚æœ<code>B&lt;T extends Comparable&gt;</code>è€Œ<code>A extends B&lt;C&gt;</code>ã€‚é‚£ä¹ˆAç¼–è¯‘è¿‡åï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªBå†…æ‰€æœ‰Téƒ½æ›¿æ¢æˆ<code>Comparable</code>çš„ç±»ï¼Œä½†æ˜¯åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šåœ¨èµ‹å€¼çš„æ—¶å€™æ£€æŸ¥ï¼Œä¸”åœ¨å–å€¼çš„æ—¶å€™è½¬å‹ï¼Œä¿è¯æ‰€æœ‰çš„Tç›¸å…³çš„æ–¹æ³•çš„ç±»å‹å…¨éƒ¨éƒ½æ˜¯Cè€Œä¸æ˜¯ Comparableã€‚å¦‚æœæˆ‘ä»¬å£°æ˜çš„æ˜¯<code>B&lt;T&gt;</code>ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä½¿ç”¨ raw type çš„ classï¼ˆå¦‚<code>ArrayList</code>ä¹‹äº<code>ArrayList&lt;String&gt;</code>ï¼‰-åœ¨å­—èŠ‚ç å±‚é¢Tå…¨éƒ¨æ¢æˆäº†<code>Object</code>ï¼Œå³ä½¿æˆ‘ä»¬åœ¨IDEé‡Œæ„Ÿè§‰æˆ‘ä»¬ä»ç„¶åœ¨ä½¿ç”¨<code>C</code>è¿™ä¸€ç±»å‹ã€‚</li>
<li>æœ‰äº†ç±»å‹æ“¦é™¤ï¼Œæ‰€æœ‰çš„æ³›å‹è¡¨è¾¾å¼éƒ½æ˜¯å¯ä»¥è¢«ç¿»è¯‘çš„ã€‚å¸¦æœ‰æ³›å‹çš„ä»£ç è¢«ç¼–è¯‘å™¨ç¿»è¯‘åé€šå¸¸åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š1. ordinary classï¼Œå¸¦æœ‰ bounding typeï¼Œ2. casting codeï¼Œå¸¦æœ‰ç±»å‹è½¬æ¢çš„ä»£ç ã€‚</li>
<li>cast code æ˜¯ä¸ºäº†ä¿è¯ç±»å‹å®‰å…¨è€Œå­˜åœ¨çš„ã€‚è¿™äº›ä»£ç æœ‰äº›ï¼ˆæ™®é€šçš„æ³›å‹setï¼‰æ˜¯åœ¨ç¼–è¯‘æ—¶é€šè¿‡æ£€æŸ¥å®ç°çš„ï¼Œæœ‰äº›åˆ™æ˜¯åœ¨ä»£ç é‡ŒåŠ ä¸Šä¸€äº›å­—èŠ‚ç æŒ‡ä»¤å®ç°ï¼ˆgetå’Œæ¡¥æ¥çš„setï¼‰çš„ã€‚</li>
<li>å‡è®¾<code>B extends A&lt;C&gt;</code>ï¼Œæˆ‘ä»¬è°ƒç”¨<code>calc(new C())</code>çš„æ—¶å€™ï¼Œçˆ¶ç±»å‹çš„ç›¸å…³æ–¹æ³•æ€»æ˜¯ä¼šè¢«æ“¦é™¤åˆ° bounding typeï¼ˆå‡å®š C çš„æ“¦é™¤ç±»å‹æ˜¯ Objectï¼‰ï¼Œæ‰€ä»¥å­ç±»çš„æ–¹æ³•ä¹Ÿå¸¦æœ‰è¿™ä¸ª bounding type çš„æ–¹æ³•å®ç°<code>calc(Object object)</code>ã€‚ä½†ä¸ºäº†ä¿æŒå¤šæ€ï¼Œå¦‚æœå­ç±»ä¹Ÿå®ç°äº†ä¸€ä¸ª<code>calc(C c)</code>ï¼Œç¼–è¯‘å™¨å°±ä¼šç”Ÿæˆäº†ä¸€ä¸ª<code>calc(Object c)</code>å»è°ƒç”¨<code>calc(C c)</code>ï¼ˆ<strong>ç›¸å½“äºæŠŠé‡è½½æ¡¥æ¥æˆå¤šæ€</strong>ï¼Œè§ä¸‹é¢çš„â€œæ“¦é™¤çš„å®é™…å·¥ä½œæµç¨‹â€ï¼‰ï¼ŒçœŸæ­£è¦ä½¿ç”¨å¤šæ€ï¼Œå°±å¿…é¡»äº§ç”Ÿä¸€ä¸ª synthesized bridge methodï¼Œæ‰§è¡Œ<code>calc(Object object) {calc((C)object);}</code>ã€‚è¿™ä¸ªä¸œè¥¿æ˜¯ä¸ºäº†ä¿æŒå¤šæ€ï¼ˆpreserve polymorphismï¼‰ã€‚</li>
<li>ä¸ºäº†å…¼å®¹æ€§ï¼ˆcompatibilityï¼‰è€ƒè™‘ï¼Œ<code>A a = new A&lt;String&gt;()</code> ä¹‹ç±»çš„èµ‹å€¼ï¼ˆ<strong>ä»æ³›å‹åˆ°æ“¦é™¤ç±»å‹çš„èµ‹å€¼æ€»æ˜¯ä¼šæˆç«‹çš„</strong>ï¼‰æ€»æ˜¯ä¼šæˆç«‹ï¼Œä½†ç¼–è¯‘å™¨æ€»æ˜¯ä¼šæŠ¥ warningï¼ˆ<code>ä½œä¸ºåŸå§‹ç±»å‹ 'generic. Pair' çš„æˆå‘˜å¯¹ 'setFirst(T)' çš„æœªæ£€æŸ¥çš„è°ƒç”¨ </code>ï¼‰ã€‚åœ¨ Jackson ä¸­ç»å¸¸é‡è§å¦‚ä¸‹é—®é¢˜ï¼šå®é™…ååºåˆ—åŒ–çš„ç”Ÿæˆ class æ˜¯ LinkedHashMapï¼Œä½†<code>Entity&lt;A&lt;B&gt;&gt; = JsonUtil.toObject(str)</code>ç­‰è¿˜æ˜¯ä¼šèµ‹å€¼æˆåŠŸï¼ˆæ­¤å¤„ å®é™…å¾—åˆ°çš„æ˜¯<code>A&lt;LinkedHashMap&gt;</code>ï¼‰ã€‚</li>
</ul>
<h2 id="æ“¦é™¤çš„å®é™…å·¥ä½œæµç¨‹">æ“¦é™¤çš„å®é™…å·¥ä½œæµç¨‹</h2>
<p>ä¸‹å›¾å±•ç¤ºäº†ç±»å‹æ“¦é™¤çš„å®Œæ•´æµç¨‹ï¼š</p>
<pre><code class="hljs mermaid">flowchart TD
    %% ç±»å‹æ“¦é™¤æµç¨‹å›¾
    subgraph SourceCode[&quot;æºä»£ç é˜¶æ®µ&quot;]
        A[&quot;æ³›å‹ç±»å‹å®šä¹‰
        public class Box~T~ &#123;
            private T value;
            public T getValue() &#123; return value; &#125;
            public void setValueT value &#123; this.value = value; &#125;
        &#125;&quot;] --&gt; B[&quot;ç¼–è¯‘å™¨å¤„ç†
        1. ç±»å‹æ£€æŸ¥
        2. ç±»å‹è½¬æ¢æ’å…¥&quot;]
    end
    
    subgraph ErasureProcess[&quot;ç±»å‹æ“¦é™¤è¿‡ç¨‹&quot;]
        B --&gt; C&#123;ç±»å‹å‚æ•° T æœ‰è¾¹ç•Œå—?&#125;
        C --&gt;|æ— è¾¹ç•Œ| D[&quot;æ“¦é™¤ä¸º Object
        ç±»å‹å˜é‡ T â†’ Object&quot;]
        C --&gt;|æœ‰è¾¹ç•Œ T extends Number| E[&quot;æ“¦é™¤ä¸ºè¾¹ç•Œç±»å‹
        ç±»å‹å˜é‡ T â†’ Number&quot;]
        
        D --&gt; F[&quot;ç”Ÿæˆæ¡¥æ¥æ–¹æ³•ï¼ˆå¦‚éœ€è¦ï¼‰
        ä¿æŒå¤šæ€æ€§&quot;]
        E --&gt; F
    end
    
    subgraph Bytecode[&quot;å­—èŠ‚ç é˜¶æ®µï¼ˆè¿è¡Œæ—¶ï¼‰&quot;]
        F --&gt; G[&quot;æ“¦é™¤åçš„ä»£ç 
        public class Box &#123;
            private Object value;
            public Object getValue() &#123; return value; &#125;
            public void setValueObject value &#123; this.value = value; &#125;
            // å¯èƒ½åŒ…å«æ¡¥æ¥æ–¹æ³•
        &#125;&quot;]
    end
    
    subgraph Runtime[&quot;è¿è¡Œæ—¶&quot;]
        G --&gt; H[&quot;ç±»å‹æ£€æŸ¥
        ç¼–è¯‘æ—¶æ’å…¥çš„ checkcast&quot;]
        H --&gt; I[&quot;å®é™…ç±»å‹ä¿¡æ¯ä¸¢å¤±
        æ— æ³•è·å– T çš„å®é™…ç±»å‹&quot;]
    end
    
    style SourceCode fill:#e1f5ff
    style ErasureProcess fill:#fff4e1
    style Bytecode fill:#e8f5e9
    style Runtime fill:#fce4ec
    
    note1[&quot;ç±»å‹æ“¦é™¤æ˜¯ç¼–è¯‘æ—¶è¿‡ç¨‹
    æ³›å‹ä¿¡æ¯åœ¨ç¼–è¯‘åæ¶ˆå¤±&quot;] -.-&gt; C</code></pre>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Pair ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Pair</span>&lt;T&gt;<br>&#123;<br>    <span class="hljs-keyword">private</span> T first;<br>    <span class="hljs-keyword">private</span> T second;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Pair</span><span class="hljs-params">()</span> &#123; first = <span class="hljs-literal">null</span>; second = <span class="hljs-literal">null</span>; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Pair</span><span class="hljs-params">(T first, T second)</span> &#123; <span class="hljs-built_in">this</span>.first = first;  <span class="hljs-built_in">this</span>.second = second; &#125;<br><br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getFirst</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> first; &#125;<br>    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getSecond</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> second; &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setFirst</span><span class="hljs-params">(T newValue)</span> &#123; first = newValue; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSecond</span><span class="hljs-params">(T newValue)</span> &#123; second = newValue; &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ´¾ç”Ÿå­ç±»å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DateInterval</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Pair</span>&lt;LocalDate&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æŒ‰ç…§å¸¸è§çš„è§„åˆ™ï¼Œç¼–è¯‘å™¨ä¼šæŠŠæ‰€æœ‰çš„æ–¹æ³•ç­¾åéƒ½æ”¹æ‰ï¼Œå¦‚<code>setSecond(T newValue)</code>ä¼šè¢«å…ˆç¼–è¯‘ä¸º<code>setSecond(LocalDate newValue)</code>ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨åç¼–è¯‘å™¨å»å°è¯•åç¼–è¯‘è¿™ä¸ªç±»<code>javap -c DateInterval.class</code>ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°å¦‚ä¸‹äº‹å®ï¼š</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-type">Compiled</span> from <span class="hljs-string">&quot;Pair.java&quot;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">com</span>.<span class="hljs-title">magicliang</span>.<span class="hljs-title">transaction</span>.<span class="hljs-title">sys</span>.<span class="hljs-title">common</span>.<span class="hljs-title">util</span>.<span class="hljs-title">DateInterval</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">com</span>.<span class="hljs-title">magicliang</span>.<span class="hljs-title">transaction</span>.<span class="hljs-title">sys</span>.<span class="hljs-title">common</span>.<span class="hljs-title">util</span>.<span class="hljs-title">Pair&lt;java</span>.<span class="hljs-title">time</span>.<span class="hljs-title">LocalDate&gt;</span> </span>&#123;<br>  com.magicliang.transaction.sys.common.util.<span class="hljs-type">DateInterval</span>();<br>    <span class="hljs-type">Code</span>:<br>       <span class="hljs-number">0</span>: aload_0<br>       <span class="hljs-number">1</span>: invokespecial #<span class="hljs-number">1</span>                  <span class="hljs-comment">// Method com/magicliang/transaction/sys/common/util/Pair.&quot;&lt;init&gt;&quot;:()V</span><br>       <span class="hljs-number">4</span>: <span class="hljs-keyword">return</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>å¹¶ä¸å­˜åœ¨ä¸€ä¸ªè¢«é‡è½½çš„æ–¹æ³•ï¼Œä»€ä¹ˆæ¢ç­¾åæ–¹æ³•éƒ½ä¸å­˜åœ¨</strong>ï¼</p>
<p>è€Œå¦‚æœæˆ‘ä»¬è¿™æ ·å†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DateInterval</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Pair</span>&lt;LocalDate&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSecond</span><span class="hljs-params">(LocalDate second)</span> &#123;<br>        <span class="hljs-keyword">if</span> (second.compareTo(getFirst()) &gt;<span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-built_in">super</span>.setSecond(second);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å­ç±»ä¸­ä¼šå‡ºç°ä¸¤ä¸ª setSecond æ–¹æ³•ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">Compiled</span> <span class="hljs-string">from</span> <span class="hljs-string">&quot;Pair.java&quot;</span><br><span class="hljs-string">class</span> <span class="hljs-string">com.magicliang.transaction.sys.common.util.DateInterval</span> <span class="hljs-string">extends</span> <span class="hljs-string">com.magicliang.transaction.sys.common.util.Pair&lt;java.time.LocalDate&gt;</span> &#123;<br>  <span class="hljs-string">com.magicliang.transaction.sys.common.util.DateInterval();</span><br>    <span class="hljs-attr">Code:</span><br>       <span class="hljs-attr">0:</span> <span class="hljs-string">aload_0</span><br>       <span class="hljs-attr">1:</span> <span class="hljs-string">invokespecial</span> <span class="hljs-comment">#1                  // Method com/magicliang/transaction/sys/common/util/Pair.&quot;&lt;init&gt;&quot;:()V</span><br>       <span class="hljs-attr">4:</span> <span class="hljs-string">return</span><br><br>  <span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">setSecond(java.time.LocalDate);</span><br>    <span class="hljs-attr">Code:</span><br>       <span class="hljs-attr">0:</span> <span class="hljs-string">new</span>           <span class="hljs-comment">#2                  // class java/lang/Throwable</span><br>       <span class="hljs-attr">3:</span> <span class="hljs-string">dup</span><br>       <span class="hljs-attr">4:</span> <span class="hljs-string">invokespecial</span> <span class="hljs-comment">#3                  // Method java/lang/Throwable.&quot;&lt;init&gt;&quot;:()V</span><br>       <span class="hljs-attr">7:</span> <span class="hljs-string">astore_2</span><br>       <span class="hljs-attr">8:</span> <span class="hljs-string">getstatic</span>     <span class="hljs-comment">#4                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br>      <span class="hljs-attr">11:</span> <span class="hljs-string">aload_2</span><br>      <span class="hljs-attr">12:</span> <span class="hljs-string">invokevirtual</span> <span class="hljs-comment">#5                  // Method java/io/PrintStream.println:(Ljava/lang/Object;)V</span><br>      <span class="hljs-attr">15:</span> <span class="hljs-string">aload_1</span><br>      <span class="hljs-attr">16:</span> <span class="hljs-string">aload_0</span><br>      <span class="hljs-attr">17:</span> <span class="hljs-string">invokevirtual</span> <span class="hljs-comment">#6                  // Method getFirst:()Ljava/lang/Object;</span><br>      <span class="hljs-attr">20:</span> <span class="hljs-string">checkcast</span>     <span class="hljs-comment">#7                  // class java/time/chrono/ChronoLocalDate</span><br>      <span class="hljs-attr">23:</span> <span class="hljs-string">invokevirtual</span> <span class="hljs-comment">#8                  // Method java/time/LocalDate.compareTo:(Ljava/time/chrono/ChronoLocalDate;)I</span><br>      <span class="hljs-attr">26:</span> <span class="hljs-string">ifle</span>          <span class="hljs-number">34</span><br>      <span class="hljs-attr">29:</span> <span class="hljs-string">aload_0</span><br>      <span class="hljs-attr">30:</span> <span class="hljs-string">aload_1</span><br>      <span class="hljs-attr">31:</span> <span class="hljs-string">invokespecial</span> <span class="hljs-comment">#9                  // Method com/magicliang/transaction/sys/common/util/Pair.setSecond:(Ljava/lang/Object;)V</span><br>      <span class="hljs-attr">34:</span> <span class="hljs-string">return</span><br><br>  <span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">setSecond(java.lang.Object);</span><br>    <span class="hljs-attr">Code:</span><br>       <span class="hljs-attr">0:</span> <span class="hljs-string">aload_0</span><br>       <span class="hljs-attr">1:</span> <span class="hljs-string">aload_1</span><br>       <span class="hljs-attr">2:</span> <span class="hljs-string">checkcast</span>     <span class="hljs-comment">#10                 // class java/time/LocalDate</span><br>       <span class="hljs-attr">5:</span> <span class="hljs-string">invokevirtual</span> <span class="hljs-comment">#11                 // Method setSecond:(Ljava/time/LocalDate;)V</span><br>       <span class="hljs-attr">8:</span> <span class="hljs-string">return</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>public void setSecond(java.time.LocalDate)</code>æ˜¯å¼€å‘è€…å®šä¹‰çš„æ˜¾å¼æ–¹æ³•ï¼Œè€Œ<code>public void setSecond(java.lang.Object);</code>æ˜¯ç¼–è¯‘å™¨<strong>åˆæˆï¼ˆsynthesizedï¼‰çš„æ¡¥æ¥æ–¹æ³•ï¼ˆbridge methodï¼‰</strong>ã€‚</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">String</span>[] args)</span> </span>&#123;<br>    DateInterval interval = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DateInterval</span>();<br>    Pair&lt;LocalDate&gt; pair = interval;<br>    <span class="hljs-comment">// è°ƒè¯•è¿›å…¥å¯ä»¥çœ‹åˆ°å¤šå‡ºä¸€è¡Œéšè—æ ˆå¸§ï¼Œè¡Œæ•°æ°å¥½æ˜¯ class DateInterval extends Pair&lt;LocalDate&gt; è¿™ä¸€è¡Œ</span><br>    pair.<span class="hljs-built_in">setSecond</span>(LocalDate.<span class="hljs-built_in">now</span>());<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ‰€ä»¥æ€»ç»“èµ·æ¥ï¼š</p>
<ol>
<li><code>Pair&lt;T&gt;</code>æœ¬è´¨ä¸Š BoundingType æ˜¯ Objectã€‚<code>extends Pair&lt;LocalDate&gt;</code>å¾—åˆ°çš„æ˜¯ä¸€ä¸ªæ‰€æœ‰ T éƒ½ substitute æˆ Object çš„ç±»å‹ï¼Œä½œä¸ºè¿è¡Œæ—¶çš„æ— ç±»å‹åŒ–ç±»å‹ä½¿ç”¨ã€‚</li>
<li>ä½†æ˜¯ç¼–è¯‘å™¨ä¼šåœ¨<strong>ç¼–è¯‘ set æ–¹æ³•çš„æ—¶å€™ä¸¥æ ¼é™åˆ¶ç±»å‹</strong>ï¼Œå¦‚æœä½¿ç”¨äº†é LocalDate çš„ç±»å‹è®¾å€¼å¿…å®šå‘ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œè€Œ<strong>å¦‚æœä½¿ç”¨ get æ–¹æ³•ï¼Œå–å‡ºæ¥çš„å€¼ä¼šéšè—ä¸€ä¸ª checkcast çš„å­—èŠ‚ç æŒ‡ä»¤</strong>ã€‚</li>
<li>åœ¨è°ƒç”¨å­ç±»å®ä¾‹çš„æ–¹æ³•ä¹‹å‰ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªæ“¦é™¤ç±»å‹çš„æ–¹æ³•ï¼Œå³<code>setSecond(java.lang.Object)</code>ï¼Œåœ¨å†…éƒ¨ä¼šæœ‰ä¸€ä¸ª checkcast æŒ‡ä»¤çš„å®ç°ï¼Œè¾¾åˆ°<code>setScond((LocalDate)second)</code>çš„æ•ˆæœã€‚</li>
<li><code> pair.setSecond(LocalDate.now());</code>çš„æ—¶å€™ï¼ŒæŒ‡å‘çš„æ˜¯çˆ¶ç±»<code>Pair&lt;LocalDate&gt;</code>è€Œä¸æ˜¯<code>DateInterval</code>ï¼Œè°ƒç”¨setSecondåªèƒ½æŒ‡å‘çˆ¶ç±»æ–¹æ³•ï¼Œè€Œä¸èƒ½æ˜¯å­ç±»æ–¹æ³•ã€‚ä½†å®é™…ä¸Šæˆ‘ä»¬è°ƒç”¨çš„<strong>é¦–å…ˆæ˜¯æ¡¥æ¥æ–¹æ³•ï¼Œç„¶åæ‰åˆ°å…·ä½“ç±»å‹çš„æ–¹æ³•</strong>ï¼ˆæ ˆå¸§ä¸ºè¯ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¼–è¯‘å™¨çŸ¥é“æ¨æµ‹æ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Œä»¥åŠå¼€å‘è€…åœ¨è¯•å›¾ override å®é™…ä¸Šå¹¶æœª override çš„æ–¹æ³•ï¼Œå› ä¸ºçˆ¶æ–¹æ³•çš„ç­¾åæ˜¯<code>setSecond(java.lang.Object)</code>ï¼Œæˆ‘ä»¬å£°æ˜ä¸€ä¸ª<code>setScond((LocalDate)second)</code>å®é™…ä¸Šæ˜¯åœ¨overloadè¿™ä¸ªæ–¹æ³•ã€‚<strong>ç¼–è¯‘å™¨å°† overload è½¬æ¢ä¸º override</strong>ï¼Œå³ä½¿åŠ ä¸Š<code>@override</code>æ³¨è§£ä¹Ÿæ²¡é—®é¢˜ï¼Œè€Œä¸”è°ƒç”¨çš„æ—¶å€™èƒ½å¤Ÿå®ç°å¤šæ€ã€‚</li>
</ol>
<p>æ‰€è°“çš„æ³›å‹ç¡®å®åªæœ‰ç¼–è¯‘å™¨æ‰å­˜åœ¨ï¼Œå‚æ•°å®ä¾‹åŒ–çš„æ³›å‹ç±»é‡Œåªç•™å­˜ä¸€äº›ç»‘å®šç±»å‹çš„è¾¹ç•Œä¿¡æ¯ï¼Œæ— è¾¹ç•Œæ³›å‹ç±»çš„<strong>çˆ¶æ–¹æ³•çš„ç±»å‹ä¿¡æ¯éƒ½æ˜¯ Object</strong>ï¼Œç±»å‹å®‰å…¨éƒ½æ˜¯åœ¨ç¼–è¯‘å™¨é€šè¿‡<strong>1æ£€æŸ¥</strong>ã€<strong>2æ’å…¥æ¡¥æ¥æ–¹æ³•</strong>ã€<strong>3å–å€¼çš„æ—¶å€™cast</strong>å®ç°çš„ã€‚è¿™ç§å®ç°<strong>ä¿è¯äº†è¿è¡Œæ—¶æ— ç±»å‹ï¼Œåˆç¡®ä¿ç¨‹åºæœ‰å¤šæ€æ•ˆåº”</strong>ã€‚</p>
<p>éªŒè¯æ¡¥æ¥æ–¹æ³•æœ‰2ç§æ–¹æ³•ï¼š</p>
<ol>
<li>åå°„æ£€æŸ¥ï¼šä½¿ç”¨Method.isBridge()åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¸ºæ¡¥æ¥æ–¹æ³•ã€‚<code>Method method = DateInterval.class.getMethod(&quot;setSecond&quot;, Object.class);</code></li>
<li>å­—èŠ‚ç æŸ¥çœ‹ï¼šé€šè¿‡<code>javap -c DateInterval.class</code>æŸ¥çœ‹ç”Ÿæˆçš„æ¡¥æ¥æ–¹æ³•ï¼Œå…¶ä¿®é¥°ç¬¦åŒ…å«ACC_BRIDGEï¼ˆæœ¬ä¾‹ä¸­æ²¡æœ‰è¯•å‡ºæ¥ï¼‰ã€‚å¦‚æœç›´æ¥æŸ¥çœ‹ Pair.classï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æ–¹æ³•ä»ç„¶ä½¿ç”¨æ³›å‹ï¼š<code>public void setSecond(T);</code>ã€‚<strong>æ¡¥æ¥æ–¹æ³•ä»…åœ¨å­ç±»ä¸»åŠ¨é‡å†™çˆ¶ç±»æ³›å‹æ–¹æ³•æ—¶ç”Ÿæˆ</strong>ã€‚</li>
</ol>
<h3 id="æ¡¥æ¥æ–¹æ³•çš„å¦ä¸€ç§ä¾‹å­">æ¡¥æ¥æ–¹æ³•çš„å¦ä¸€ç§ä¾‹å­</h3>
<p>ä¸€ä¸ªç±»å‹å®ç°äº† Clonableï¼Œå¤©ç„¶æ˜¯ Object çš„å­ç±»ã€‚å®ƒå®ç°è‡ªå·±çš„cloneçš„æ—¶å€™ï¼Œä¼šå¾—åˆ°ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å®é™…æ–¹æ³•</span><br>Employee <span class="hljs-title function_">clone</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">/* å…‹éš†é€»è¾‘ */</span> &#125;<br><span class="hljs-comment">// ç¼–è¯‘å™¨åˆæˆçš„æ¡¥æ–¹æ³•ï¼Œoverride äº† Object.clone()</span><br><span class="hljs-comment">// å†…éƒ¨è½¬å‘è°ƒç”¨ Employee clone()ï¼Œå®ç°å¤šæ€</span><br>Object <span class="hljs-title function_">clone</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> clone(); &#125;<br></code></pre></td></tr></table></figure>
<h4 id="æ¡¥æ–¹æ³•çš„ç”Ÿæˆè§„åˆ™">æ¡¥æ–¹æ³•çš„ç”Ÿæˆè§„åˆ™</h4>
<p>æ¡¥æ–¹æ³•ï¼ˆBridge Methodï¼‰æ˜¯ç¼–è¯‘å™¨ä¸ºç»´æŒç±»å‹æ“¦é™¤åçš„å¤šæ€æ€§è€Œè‡ªåŠ¨ç”Ÿæˆçš„åˆæˆæ–¹æ³•ã€‚æ ¹æ® JLS Â§13.1ï¼Œæ¡¥æ–¹æ³•å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ol>
<li><strong>ç”Ÿæˆæ—¶æœº</strong>ï¼šå½“å­ç±»è¦†å†™çˆ¶ç±»æ³›å‹æ–¹æ³•ï¼Œä¸”ç±»å‹æ“¦é™¤å¯¼è‡´æ–¹æ³•ç­¾åä¸ä¸€è‡´æ—¶ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨æ’å…¥æ¡¥æ–¹æ³•ã€‚</li>
<li><strong>å­—èŠ‚ç æ ‡å¿—</strong>ï¼šæ¡¥æ–¹æ³•åœ¨å­—èŠ‚ç ä¸­å¸¦æœ‰ <code>ACC_BRIDGE</code> å’Œ <code>ACC_SYNTHETIC</code> æ ‡å¿—ã€‚</li>
<li><strong>è½¬å‘è°ƒç”¨</strong>ï¼šæ¡¥æ–¹æ³•çš„æ–¹æ³•ä½“ä»…åŒ…å«ç±»å‹è½¬æ¢å’Œå¯¹å®é™…æ–¹æ³•çš„è½¬å‘è°ƒç”¨ã€‚</li>
</ol>
<p>ä¸‹å›¾å±•ç¤ºäº†æ¡¥æ¥æ–¹æ³•çš„ç”Ÿæˆå’Œè°ƒç”¨æµç¨‹ï¼š</p>
<pre><code class="hljs mermaid">sequenceDiagram
    %% æ¡¥æ¥æ–¹æ³•å·¥ä½œåŸç†å›¾
    participant Source as æºä»£ç 
    participant Compiler as ç¼–è¯‘å™¨
    participant SubClass as å­ç±»&lt;br/&gt;Node
    participant Bridge as æ¡¥æ¥æ–¹æ³•
    participant RealMethod as å®é™…æ–¹æ³•&lt;br/&gt;setDataT data
    participant SuperClass as çˆ¶ç±»&lt;br/&gt;MyNode
    
    Note over Source: æ³›å‹ç±»å®šä¹‰
    Source-&gt;&gt;Compiler: class MyNode~T~ &#123;
      setDataT data
    &#125;
    
    Note over Source: å­ç±»é‡å†™
    Source-&gt;&gt;Compiler: class Node extends MyNode~Integer~ &#123;
      setDataInteger data  // é‡å†™
    &#125;
    
    Compiler-&gt;&gt;Compiler: ç±»å‹æ“¦é™¤
    Note right of Compiler: MyNode.setDataObject data
    
    Compiler-&gt;&gt;SubClass: ç”Ÿæˆæ¡¥æ¥æ–¹æ³•
    Note right of Compiler: ä¿æŒå¤šæ€æ€§
    
    SubClass-&gt;&gt;Bridge: æ¡¥æ¥æ–¹æ³•ç­¾å
    Note right of Bridge: public void setDataObject data &#123;
      this.setDataInteger data  // ç±»å‹è½¬æ¢
    &#125;
    
    SubClass-&gt;&gt;RealMethod: å®é™…æ–¹æ³•
    Note right of RealMethod: public void setDataInteger data &#123;
      super.setDatadata;  // è°ƒç”¨çˆ¶ç±»
    &#125;
    
    Note over SuperClass: çˆ¶ç±»æ–¹æ³•
    SuperClass-&gt;&gt;SuperClass: setDataObject data
    
    rect rgb(200, 220, 240)
        Note over Bridge,SuperClass: è¿è¡Œæ—¶è°ƒç”¨æµç¨‹
        Client-&gt;&gt;SubClass: è°ƒç”¨ setDataObject
        SubClass-&gt;&gt;Bridge: æ¡¥æ¥æ–¹æ³•
        Bridge-&gt;&gt;Bridge: æ£€æŸ¥ç±»å‹&lt;br/&gt;if data instanceof Integer
        Bridge-&gt;&gt;RealMethod: è°ƒç”¨å®é™…æ–¹æ³•&lt;br/&gt;this.setDataInteger data
        RealMethod-&gt;&gt;SuperClass: super.setDatadata
    end
    
    Note over Bridge: æ¡¥æ¥æ–¹æ³•ä½œç”¨ï¼š
    1. ä¿æŒæ–¹æ³•ç­¾åä¸çˆ¶ç±»ä¸€è‡´
    2. æ‰§è¡Œç±»å‹æ£€æŸ¥
    3. å§”æ‰˜ç»™å®é™…æ–¹æ³•</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Comparator;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringComparator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparator</span>&lt;String&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(String first, String second)</span> &#123;<br>        <span class="hljs-keyword">return</span> first.compareTo(second);<br>    &#125;<br>    <span class="hljs-comment">// ç¼–è¯‘å™¨ç”Ÿæˆçš„æ¡¥æ–¹æ³•ï¼ˆåç¼–è¯‘å¯è§ï¼‰ï¼š</span><br>    <span class="hljs-comment">// public int compare(Object first, Object second) &#123;</span><br>    <span class="hljs-comment">//     return compare((String) first, (String) second);</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>javap -c -p StringComparator.class</code> å¯ä»¥è§‚å¯Ÿåˆ°æ¡¥æ–¹æ³•çš„å­˜åœ¨ã€‚æ¡¥æ–¹æ³•çš„ç­¾åä¸æ“¦é™¤åçš„çˆ¶ç±»æ–¹æ³•ç­¾åä¸€è‡´ï¼ˆå‚æ•°ä¸º <code>Object</code>ï¼‰ï¼Œæ–¹æ³•ä½“å°†å‚æ•°å¼ºåˆ¶è½¬æ¢ä¸ºå…·ä½“ç±»å‹åè½¬å‘ç»™å®é™…çš„è¦†å†™æ–¹æ³•ã€‚</p>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šæ“¦é™¤æ¡¥æ¥</strong></p>
<p>æ¡¥æ–¹æ³•æ˜¯ç¼–è¯‘å™¨ä¸ºå¼¥åˆ&quot;æºç çº§æ³›å‹å¤šæ€&quot;ä¸&quot;å­—èŠ‚ç çº§æ“¦é™¤ç­¾å&quot;ä¹‹é—´çš„é¸¿æ²Ÿè€Œç”Ÿæˆçš„é€‚é…å™¨ã€‚å½“è¦†å†™æ³›å‹æ–¹æ³•æ—¶ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç­¾åä¸æ“¦é™¤åçˆ¶ç±»æ–¹æ³•ä¸€è‡´çš„æ¡¥æ–¹æ³•ï¼Œå†…éƒ¨é€šè¿‡å¼ºåˆ¶è½¬æ¢è½¬å‘è°ƒç”¨ã€‚è¿™ä¸€æœºåˆ¶å¯¹å¼€å‘è€…é€æ˜ï¼Œä½†åœ¨åå°„è°ƒç”¨ï¼ˆ<code>Method.isBridge()</code>ï¼‰å’Œå­—èŠ‚ç åˆ†ææ—¶éœ€è¦æ³¨æ„åŒºåˆ†ã€‚</p>
<h3 id="ç±»å‹-clash">ç±»å‹ clash</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericOverloadPuzzle</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; String <span class="hljs-title function_">method</span><span class="hljs-params">(T t)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Method 1&quot;</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">method</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Method 2&quot;</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(method(<span class="hljs-string">&quot;Hello&quot;</span>));<br>        System.out.println(method(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>()));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªmethodæœ¬èº«ä¸æ˜¯é‡è½½ï¼Œç›´æ¥ç­¾åå†²çªï¼š<code>'method(T)' ä¸ 'method(Object)' å†²çªï¼›ä¸¤ä¸ªæ–¹æ³•å…·æœ‰ç›¸åŒçš„æ“¦é™¤</code>ã€‚</p>
<h2 id="ä¸é—ç•™ä»£ç çš„å†²çª">ä¸é—ç•™ä»£ç çš„å†²çª</h2>
<p>æŠŠ generic class çš„å®ä¾‹èµ‹ç»™ raw type class çš„å®ä¾‹ä¼šé‡åˆ°ç¼–è¯‘å™¨è­¦å‘Šï¼›åè¿‡æ¥ï¼ŒæŠŠ raw type class çš„å®ä¾‹èµ‹ç»™ generic class çš„å®ä¾‹ä¹Ÿä¼šé‡åˆ°ç¼–è¯‘å™¨è­¦å‘Š-åœ¨è·¨æ¨¡å—ä¼ é€’æ•°æ®æ—¶ï¼Œåè€…å¾€å¾€æ›´å±é™©ã€‚</p>
<p>ç°ä»£ä»£ç ç¼–å†™åŸåˆ™æ˜¯ï¼š</p>
<ol>
<li>è¿œç¦»æ—©æœŸçš„æ•°æ®ç»“æ„ã€‚</li>
<li>å…¨ç¨‹ä½¿ç”¨æ³›å‹ç±»è€ŒéåŸå§‹ç±»å‹â€”â€”é™¤éåœ¨åå°„æˆ–ååºåˆ—åŒ–åœºæ™¯ä¸­ä¸å¾—ä¸è·å–åŸå§‹ç±»å‹ï¼Œæ­¤æ—¶å¿…é¡»æ˜ç¡®å†…å­˜ä¸­çš„å®é™…ç±»å‹ï¼Œå¹¶ä½¿ç”¨ <code>@SuppressWarnings(&quot;unchecked&quot;)</code> æ ‡æ³¨ã€‚</li>
<li>é€šè¿‡ä¸å®‰å…¨çš„ç±»å‹è½¬æ¢ï¼Œå¯èƒ½å°† <code>List&lt;Integer&gt;</code> èµ‹ç»™ <code>List&lt;String&gt;</code>ï¼Œè¿™ä¼šå¯¼è‡´<strong>å †æ±¡æŸ“ï¼ˆheap pollutionï¼‰</strong>ã€‚</li>
</ol>
<h1>é’»çŸ³æ“ä½œç¬¦ <code>&lt;&gt;</code></h1>
<p>Java 7 å¼•å…¥äº†é’»çŸ³æ“ä½œç¬¦ï¼ˆDiamond Operatorï¼‰ï¼Œå…è®¸ç¼–è¯‘å™¨ä»èµ‹å€¼ç›®æ ‡æ¨æ–­æ„é€ å™¨çš„ç±»å‹å‚æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DiamondOperatorExample</span> &#123;<br>    <span class="hljs-comment">// Java 5/6ï¼šç±»å‹å‚æ•°å¿…é¡»æ˜¾å¼æŒ‡å®š</span><br>    Map&lt;String, List&lt;Integer&gt;&gt; oldStyle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;String, List&lt;Integer&gt;&gt;();<br><br>    <span class="hljs-comment">// Java 7+ï¼šé’»çŸ³æ“ä½œç¬¦ï¼Œç¼–è¯‘å™¨ä»å·¦ä¾§æ¨æ–­</span><br>    Map&lt;String, List&lt;Integer&gt;&gt; newStyle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>Java 9 è¿›ä¸€æ­¥æ‰©å±•äº†é’»çŸ³æ“ä½œç¬¦çš„é€‚ç”¨èŒƒå›´ï¼Œå…è®¸åœ¨åŒ¿åå†…éƒ¨ç±»ä¸­ä½¿ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Comparator;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DiamondWithAnonymousClass</span> &#123;<br>    <span class="hljs-comment">// Java 9+ï¼šåŒ¿åå†…éƒ¨ç±»ä¹Ÿå¯ä»¥ä½¿ç”¨é’»çŸ³æ“ä½œç¬¦</span><br>    Comparator&lt;String&gt; comparator = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>&lt;&gt;() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(String first, String second)</span> &#123;<br>            <span class="hljs-keyword">return</span> first.length() - second.length();<br>        &#125;<br>    &#125;;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é’»çŸ³æ“ä½œç¬¦æ˜¯ç±»å‹æ¨æ–­æ”¹è¿›çš„ä¸€éƒ¨åˆ†ï¼Œä¸ Type Witness äº’ä¸ºè¡¥å……ï¼šé’»çŸ³æ“ä½œç¬¦ç®€åŒ–äº†æ„é€ å™¨è°ƒç”¨ï¼ŒType Witness åˆ™åœ¨æ¨æ–­å¤±è´¥æ—¶æä¾›æ˜¾å¼ç±»å‹æŒ‡å®šã€‚</p>
<h1>Type Witness ç±»å‹è§è¯/ç›®å‡»è€…</h1>
<p>ç±»å‹è§è¯çš„æŠ½è±¡æ¨¡å¼ï¼š</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">SomeClass</span>.&lt;<span class="hljs-variable">TypeName</span>&gt;<span class="hljs-function"><span class="hljs-title">methodName</span>(<span class="hljs-variable">arguments</span>)</span><br></code></pre></td></tr></table></figure>
<p>å¸¸è§ä½¿ç”¨åœºæ™¯ï¼š</p>
<ol>
<li>
<p><strong>å½“æ²¡æœ‰è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡è¿›è¡Œæ¨æ–­æ—¶</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">var</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> Collections.&lt;String&gt;emptyList();<br></code></pre></td></tr></table></figure>
</li>
<li>
<p><strong>åœ¨å¤æ‚çš„æ³›å‹åµŒå¥—ä¸­</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‡è®¾å­˜åœ¨ someMethod æ–¹æ³•</span><br><span class="hljs-comment">// someMethod(Collections.&lt;Map&lt;String, Integer&gt;&gt;emptyList());</span><br></code></pre></td></tr></table></figure>
</li>
<li>
<p><strong>åœ¨ Java 7 åŠä»¥å‰</strong>ï¼šè¿™è¡Œä»£ç å¯èƒ½ä¸èƒ½ç¼–è¯‘ï¼Œå› ä¸º <code>processStringList</code> çš„å‚æ•°å¯èƒ½æ˜¯ä¸ªæ³›å‹ç±»å‹ï¼Œè€Œå®å‚èµ‹å€¼çš„æ—¶å€™æ— æ³•æ¨å¯¼åˆ—è¡¨ç±»å‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‡è®¾å­˜åœ¨ processStringList æ–¹æ³•</span><br><span class="hljs-comment">// processStringList(Collections.emptyList());</span><br></code></pre></td></tr></table></figure>
</li>
</ol>
<p>å…¶ä¸­ç¬¬äºŒç§æƒ…å†µæ›´å¸¸è§ï¼Œå¦‚æœæ–¹æ³•è°ƒç”¨å·¦è¾¹æœ‰è¶³å¤Ÿçš„ç›®æ ‡ç±»å‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šäº§ç”Ÿæœ‰æ­§ä¹‰çš„æ¨å¯¼ï¼ˆInferenceï¼‰è·¯å¾„ã€‚</p>
<h1>æ³›å‹ä¸èƒ½åšä»€ä¹ˆï¼ˆRestricstions and Limitationsï¼‰</h1>
<p>æ‰€æœ‰æ³›å‹çš„ bug éƒ½ä¸ä¸€ä¸ªåŸºæœ¬å‡è®¾æœ‰å…³ï¼Œåœ¨è™šæ‹Ÿæœºé‡Œè¿è¡Œçš„ç±»å‹å®é™…ä¸Šä½¿ç”¨çš„æ˜¯ raw typeï¼Œä¸æ³¨æ„è¿™ä¸€ç‚¹å°±å¯èƒ½å‡ºé”™ã€‚<strong>parameterized type vs raw type</strong>ã€‚</p>
<h2 id="ä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹å®ä¾‹åŒ–-type-parameters">ä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹å®ä¾‹åŒ– type parameters</h2>
<p>C++å¯ä»¥ã€‚</p>
<h2 id="åŠ¨æ€ç±»å‹è¯†åˆ«-inquiry-åªèƒ½åœ¨-raw-type-ä¸Šå·¥ä½œ">åŠ¨æ€ç±»å‹è¯†åˆ«ï¼ˆinquiryï¼‰åªèƒ½åœ¨ raw type ä¸Šå·¥ä½œ</h2>
<p>instanceofã€Class ==ã€getClass() è¿™ç±»æ“ä½œéƒ½åªèƒ½å½“åš raw type å·¥ä½œï¼š</p>
<ul>
<li>å®é™…ä¸Šä¸èƒ½<code>a instanceof Pair&lt;String&gt;</code>ï¼Œè¿™ä¼šå¯¼è‡´ä¸€ä¸ªç¼–è¯‘é”™è¯¯</li>
<li>å¯ä»¥<code>(Pair&lt;String&gt;)a</code>ï¼Œè¿™ä¼šå¯¼è‡´ä¸€ä¸ªç¼–è¯‘è­¦å‘Šã€‚</li>
<li><code>stringPair.getClass() == employeePair.getClass() // true</code></li>
</ul>
<h2 id="ä¸èƒ½åˆ›å»º-parameterizedtype-ä½œå…ƒç´ çš„æ•°ç»„">ä¸èƒ½åˆ›å»º ParameterizedType ä½œå…ƒç´ çš„æ•°ç»„</h2>
<p>ä½†å¯ä»¥<strong>å£°æ˜</strong>å’Œ<strong>èµ‹å€¼</strong>åˆ°æ³›å‹æ•°ç»„ï¼Œè¿™å°±æ˜¯ GenericArrayType çš„ç”¨å¤„ã€‚</p>
<ul>
<li>GenericArrayType æ˜¯<code>T[]</code>æˆ–<code>List&lt;String&gt;[]</code>ï¼Œ<code>List&lt;String&gt;</code>æ˜¯ParameterizedTypeã€‚</li>
<li>-<strong>åˆ›å»ºä¸å¯èƒ½</strong>ï¼š
<ul>
<li><code>Pair&lt;Sring&gt;[] a = new Pair&lt;String&gt;[10]</code>æ˜¯ä¸å¯èƒ½çš„ã€‚æ˜¯<code>Pair&lt;String&gt;</code>è€Œä¸æ˜¯ Tã€‚</li>
<li><code>T[] arr = new T[10];</code>æ˜¯ä¸å¯èƒ½çš„ã€‚</li>
<li><code>var table = (Pair&lt;String&gt;[])new Pair&lt;?&gt;[10]</code>æ˜¯åˆæ³•çš„ï¼Œå¯ä»¥ <strong>new é€šé…ç¬¦æ•°ç»„</strong>ï¼Œç„¶åå¼ºè½¬å‹ã€‚</li>
</ul>
</li>
<li><code>Object[] arr = new Pair&lt;String&gt;[10]</code>è¿™æ ·æ˜¯åˆæ³•çš„ï¼Œè€Œä¸”è¿™ä¸ªarrå®é™…ä¸Šæ˜¯<code>Pair[]</code>ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ¥å—ä»»æ„çš„<code>Pair</code>-ä¸ç®¡æ˜¯<code>Pair&lt;String&gt;</code>è¿˜æ˜¯<code>Pair&lt;Employee&gt;</code>ï¼Œä½†ä¸èƒ½æ¥å—<code>String</code>ã€‚è¿™ä¼šå¯¼è‡´ cast å¼‚å¸¸ã€‚</li>
</ul>
<h2 id="ç±»å‹å‚æ•°å¯ä»¥å’Œvargargs-ä¸€èµ·å·¥ä½œ">ç±»å‹å‚æ•°å¯ä»¥å’Œ<code>vargargs</code> ä¸€èµ·å·¥ä½œ</h2>
<p>å¦‚æœä½¿ç”¨<code>@safevarargs</code>è¿è­¦å‘Šéƒ½ä¸ä¼šæœ‰ã€‚ä¹Ÿå°±æ˜¯è¯´<strong>å¯ä»¥è¿™æ ·åˆ›å»ºæ³›å‹æ•°ç»„</strong><code>Pair&lt;String&gt;[] pair = makePairs(pair1, pair2)// makePairs çš„ç­¾åæ˜¯(T... arr)ï¼Œä¸”ç›´æ¥è¿”å›è¿™ä¸ª arr </code>ï¼ˆè¿™ä¸€æ¡ç ´åäº†â€œä¸èƒ½åˆ›å»ºparameterized type çš„æ•°ç»„â€è§„åˆ™ï¼‰ã€‚</p>
<p>ä½†æ³›å‹æ•°ç»„è¿˜æ˜¯å±é™©çš„ï¼Œå› ä¸ºæ•°ç»„æœ¬èº«è¿˜æ˜¯ raw typeï¼Œå¾€é‡Œé¢å†™å…¥ä¸€ä¸ª<code>Pair&lt;Integer&gt;</code>å¯ä»¥ï¼Œå–å‡ºæ¥ä¼šæœ‰è½¬å‹é—®é¢˜ã€‚</p>
<h2 id="ä¸èƒ½åˆå§‹åŒ–-type-variablesï¼š">ä¸èƒ½åˆå§‹åŒ– type variablesï¼š</h2>
<ul>
<li>æœ€å¸¸è§çš„éæ³•å†™æ³•æ˜¯<code>new T()</code>ã€‚
<ul>
<li>å› ä¸º T å®é™…ä¸Šä¼šæ“¦é™¤åˆ° Objectï¼Œä¸èƒ½è°ƒç”¨ç¨‹åºå‘˜æ„å›¾é‡Œçš„é‚£ä¸ªæ„é€ å™¨ã€‚</li>
<li>ä½† T t æ˜¯å¯ä»¥ä¸”å¾ˆå¸¸è§çš„ã€‚</li>
<li>workaroundï¼š
<ul>
<li>java8ï¼š<code>Supplier&lt;T&gt; constr constr.get()</code>ï¼Œç„¶ååœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ„é€ å™¨çš„æ–¹æ³•å¼•ç”¨å°±æ˜¯ä¸€ä¸ª<code>Supplier&lt;T&gt;</code>ã€‚</li>
<li>java8ä»¥å‰ï¼šåœ¨ä½¿ç”¨ T çš„åœ°æ–¹éƒ½ä½¿ç”¨<code>Class&lt;T&gt;</code>ï¼Œç„¶åå€Ÿåå°„æ¥ç”Ÿæˆå¯¹åº”çš„å¯¹è±¡ï¼š<code>Class&lt;T&gt; cl cl.getConstructor().newInstance()</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ä¸èƒ½å®ä¾‹åŒ–æ³›å‹æ•°ç»„">ä¸èƒ½å®ä¾‹åŒ–æ³›å‹æ•°ç»„</h2>
<p><code>T[] a = new T[1] // error</code></p>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦å¾—åˆ°æŸç§ç±»å‹çš„æ•°ç»„ï¼Œå¯ä»¥é‡‡å–å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<ol>
<li>å…ˆæ‰¾åˆ°ä¸€ä¸ªæ³›å‹ Listï¼Œç„¶åä½¿ç”¨ä¸‹æ–‡æåˆ°çš„â€œç©ºæ³›å‹æ•°ç»„çš„æ‹·è´æ–¹æ³•â€ã€‚</li>
<li>æƒ³åŠæ³•ç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶å<code>(T[])</code>åšè½¬å‹-<strong>å®ä¾‹åŒ–ä¸å¯ä»¥ï¼Œä½†æ˜¯è½¬å‹å¯ä»¥</strong>ã€‚</li>
</ol>
<p>è¿™ä¸€æ¡å’Œä¸Šé¢çš„ ParameterizedType æ¡ç›®å·®ä¸å¤šã€‚</p>
<h2 id="æ³›å‹ç±»çš„-type-variables-ä¸èƒ½åœ¨å®ƒçš„-static-ä¸Šä¸‹æ–‡é‡Œå·¥ä½œ">æ³›å‹ç±»çš„ type variables ä¸èƒ½åœ¨å®ƒçš„ static ä¸Šä¸‹æ–‡é‡Œå·¥ä½œ</h2>
<p>ä½†é™æ€æ–¹æ³•è‡ªå·±å¯ä»¥æœ‰ type variablesã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ª<code>class Single&lt;T&gt;</code>ï¼Œä½†è¿™ä¸ª<code>Single</code>é‡Œçš„é™æ€æ–¹æ³•ä¸èƒ½å¼•ç”¨<code>T</code>ã€‚é™æ€æ–¹æ³•é‡Œå¯ä»¥è‡ªå·±å£°æ˜å¦ä¸€ä¸ª<code>&lt;U&gt;</code>ã€‚</p>
<h2 id="ä¸èƒ½æŠ›å‡ºå’Œæ•è·æ³›å‹ç±»">ä¸èƒ½æŠ›å‡ºå’Œæ•è·æ³›å‹ç±»</h2>
<ol>
<li><code>T extends Throwable</code>åˆæ³•ã€‚</li>
<li><code>method throws T</code>åˆæ³•ï¼Œ<code>throw (T)t</code>åˆæ³•ã€‚</li>
<li><code>catch(T t)</code>éæ³•ã€‚</li>
<li><code>Problem&lt;T&gt; extends Exception</code>éæ³•ã€‚</li>
</ol>
<h2 id="å·§å¦™åœ°ä½¿ç”¨æ³›å‹-å¯ä»¥ç ´å-checked-exception-çš„é™åˆ¶">å·§å¦™åœ°ä½¿ç”¨æ³›å‹ï¼Œå¯ä»¥ç ´å checked exception çš„é™åˆ¶</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Task</span><br>&#123;<br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception;<br>   <br>   <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>   <span class="hljs-keyword">static</span> &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Throwable</span>&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">throwAs</span><span class="hljs-params">(Throwable t)</span> <span class="hljs-keyword">throws</span> T <br>   &#123;<br>      <span class="hljs-keyword">throw</span> (T) t;<br>   &#125;<br>   <br>   <span class="hljs-keyword">static</span> Runnable <span class="hljs-title function_">asRunnable</span><span class="hljs-params">(Task task)</span> <br>   &#123;<br>      <span class="hljs-keyword">return</span> () -&gt; <br>      &#123; <br>         <span class="hljs-keyword">try</span> <br>         &#123;<br>            task.run();<br>         &#125;<br>         <span class="hljs-keyword">catch</span> (Exception e) <br>         &#123;<br>            <span class="hljs-comment">// ç¼–è¯‘å™¨å…è®¸æˆ‘ä»¬å»æ‰ &lt;RuntimeException&gt;ï¼Œä¼¼ä¹å¯ä»¥ç›´æ¥æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸</span><br>            Task.&lt;RuntimeException&gt;throwAs(e);<br>         &#125;<br>      &#125;;<br>   &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DefeatCheckedExceptionChecking</span><br>&#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span><br>   &#123;<br>      <span class="hljs-type">var</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(Task.asRunnable(() -&gt; <br>         &#123;<br>            Thread.sleep(<span class="hljs-number">1000</span>);<br>            System.out.println(<span class="hljs-string">&quot;Hello, World!&quot;</span>);<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exception</span>(<span class="hljs-string">&quot;Check this out!&quot;</span>);<br>         &#125;));<br>      thread.start();<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éª—è¿‡äº†ç¼–è¯‘å™¨ï¼Œè®©å®ƒè®¤ä¸º<code>asRunnable</code>æŠ›å‡ºçš„ä¸æ˜¯å—æ£€å¼‚å¸¸ï¼š</p>
<ol>
<li>è°ƒç”¨ asRunnable ä»¥åï¼Œæˆ‘ä»¬<strong>ä¸éœ€è¦å†™å—æ£€å¼‚å¸¸çš„ handler</strong>ï¼Œä¹Ÿ<strong>ä¸éœ€è¦<code>new RuntimeException(ex)</code>æ¥ wrap</strong>ã€‚</li>
<li>è¿è¡Œæ—¶<code>throw (T) t;</code>ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ“¦é™¤æ˜¯æ“¦é™¤åˆ° Throwableï¼Œæˆ‘ä»¬ä»ç„¶åœ¨æ›´ä¸Šæ¸¸é‡åˆ°è¿™ä¸ªå¼‚å¸¸æ—¶å’Œé‡åˆ°æ™®é€šå¼‚å¸¸çš„æµç¨‹æ˜¯ä¸€è‡´çš„ã€‚</li>
</ol>
<h2 id="æ°¸è¿œä¸è¦å†™boolean-equals-t-object">æ°¸è¿œä¸è¦å†™<code>boolean equals(T object)</code></h2>
<p>å› ä¸ºæ¯ä¸ªæ³›å‹æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªå…œåº•çš„ raw type æ–¹æ³•å…œåº•ï¼Œå¦‚æœå…œåº•æ–¹æ³•å’Œçˆ¶ç±»çš„éæ³›å‹æ–¹æ³•ç›¸å†²çªï¼ˆclashï¼‰ï¼Œç¼–è¯‘ä¼šæŠ¥é”™ã€‚</p>
<p>ç¼–è¯‘å™¨ä¼šæ“¦é™¤å‡º <code>boolean equals(Object object)</code>ï¼Œåˆ¶é€ åŒç­¾åçš„æ–¹æ³•ï¼Œè¿é‡è½½éƒ½ç®—ä¸ä¸Šã€‚</p>
<p>åªèƒ½å†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span> &#123;<br>    <span class="hljs-keyword">if</span> (o == <span class="hljs-literal">null</span> || getClass() != o.getClass()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    Pair&lt;?&gt; pair = (Pair&lt;?&gt;) o;<br>    <span class="hljs-keyword">return</span> Objects.equals(first, pair.first) &amp;&amp; Objects.equals(second, pair.second);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™æ ·æ„æˆäº†æ˜¾å¼overrideã€‚</p>
<p>æ‰€ä»¥è¿™é‡Œæœ‰ä¸€ä¸ªæç«¯é‡è¦çš„è®¤çŸ¥ï¼š</p>
<ol>
<li>æˆ‘ä»¬ä¸èƒ½åœ¨æ³›å‹ç±»é‡Œå£°æ˜æ“¦é™¤åæœ‰åŒç­¾åçš„æ–¹æ³•ã€‚<code>foo(T o)</code>å’Œ<code>foo(Object o)</code>ä¸ç®—ä¸€ç§é‡è½½ï¼Œç®—ä¸€ç§ clashã€‚ä½†æˆ‘ä»¬å¯ä»¥å†™<code>@override foo(Object o){}</code>æ¥ overrideã€‚</li>
<li>æˆ‘ä»¬å¯ä»¥åœ¨å®ä¾‹åŒ–çš„å­ç±»é‡Œé¢å†™å…·ä½“ç±»å‹æ¥ overrload æ“¦é™¤æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šå¸®æˆ‘ä»¬æŠŠoverloadè½¬æˆ overrideã€‚ä¾‹å­è§ä¸Šé¢â€œæ“¦é™¤çš„å®é™…å·¥ä½œæµç¨‹â€ã€‚</li>
</ol>
<h2 id="å†è°ˆæ•°ç»„å’Œæ³›å‹ç±»çš„ç»§æ‰¿å’Œåå˜">å†è°ˆæ•°ç»„å’Œæ³›å‹ç±»çš„ç»§æ‰¿å’Œåå˜</h2>
<p>æ•°ç»„éšè—æœ‰ç±»å‹ä¿¡æ¯ã€‚æ‰€ä»¥è™½ç„¶æ•°ç»„æ˜¯åå˜çš„ï¼Œä½†æ˜¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ•°ç»„åå˜ä¸ç»§æ‰¿ç¤ºä¾‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">A</span> &#123;&#125;<br><br><span class="hljs-comment">// åˆæ³•ï¼šå­ç±»æ•°ç»„å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»æ•°ç»„å¼•ç”¨</span><br>A[] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">B</span>[<span class="hljs-number">10</span>];<br><span class="hljs-comment">// ä½†æ˜¯ arr å®é™…ä¸Šæ˜¯ä¸€ä¸ª B æ•°ç»„</span><br><span class="hljs-comment">// arr[0] = new A(); // è¿è¡Œæ—¶æŠ›å‡º ArrayStoreExceptionï¼ŒB æ•°ç»„ä¸å…è®¸å­˜å‚¨ A ç±»å‹</span><br></code></pre></td></tr></table></figure>
<p>ä½†æ˜¯æ³›å‹ç±»æ˜¯å®Œå…¨æ“¦é™¤çš„ï¼Œæ‰€ä»¥å¯¹äº A List é‡Œæ’å…¥ B å…ƒç´ ï¼Œå¦‚æœå…è®¸ç»§æ‰¿ï¼Œåˆ™çœŸçš„ä¼šå‘ç”Ÿæ··åˆæ’å…¥çš„é—®é¢˜ã€‚</p>
<p>Java æœ‰ä¸€ä¸ªä¹ æƒ¯ï¼Œå°±æ˜¯ä¸å®Œå…¨é˜²æ­¢å †æ±¡æŸ“ï¼Œæœ‰æ—¶å€™é åœ¨å–å€¼çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸æ¥è§£å†³ã€‚</p>
<h2 id="æ³›å‹ä¸æ•°ç»„">æ³›å‹ä¸æ•°ç»„</h2>
<h3 id="æ•°ç»„åå˜-vs-æ³›å‹ä¸å˜">æ•°ç»„åå˜ vs æ³›å‹ä¸å˜</h3>
<p>Java æ•°ç»„æ˜¯åå˜çš„ï¼ˆcovariantï¼‰ï¼šå¦‚æœ <code>B</code> æ˜¯ <code>A</code> çš„å­ç±»å‹ï¼Œåˆ™ <code>B[]</code> æ˜¯ <code>A[]</code> çš„å­ç±»å‹ã€‚è¿™ä¸€è®¾è®¡åœ¨ Java 1.0 æ—¶ä»£ä¸ºå¤šæ€æ•°ç»„æ“ä½œæä¾›äº†ä¾¿åˆ©ï¼Œä½†ä¹Ÿå¼•å…¥äº†è¿è¡Œæ—¶ç±»å‹å®‰å…¨é£é™©ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ•°ç»„åå˜ç¤ºä¾‹ï¼ˆæ³¨æ„ï¼š42 ä¼šè¢«è‡ªåŠ¨è£…ç®±ä¸º Integerï¼‰</span><br>Object[] objectArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[<span class="hljs-number">10</span>]; <span class="hljs-comment">// ç¼–è¯‘é€šè¿‡ï¼šæ•°ç»„åå˜</span><br><span class="hljs-comment">// objectArray[0] = 42;               // ç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶æŠ›å‡º ArrayStoreException</span><br></code></pre></td></tr></table></figure>
<p>æ³›å‹åˆ™æ˜¯ä¸å˜çš„ï¼ˆinvariantï¼‰ï¼š<code>List&lt;String&gt;</code> ä¸æ˜¯ <code>List&lt;Object&gt;</code> çš„å­ç±»å‹ã€‚è¿™ä¸€è®¾è®¡å°†ç±»å‹é”™è¯¯ä»è¿è¡Œæ—¶æå‰åˆ°ç¼–è¯‘æ—¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// List&lt;Object&gt; list = new ArrayList&lt;String&gt;(); // ç¼–è¯‘é”™è¯¯</span><br>List&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Object</span>&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;(); <span class="hljs-comment">// é€šé…ç¬¦æä¾›å—é™çš„åå˜</span><br></code></pre></td></tr></table></figure>
<h3 id="ä¸ºä»€ä¹ˆä¸èƒ½åˆ›å»ºæ³›å‹æ•°ç»„">ä¸ºä»€ä¹ˆä¸èƒ½åˆ›å»ºæ³›å‹æ•°ç»„</h3>
<p><code>new T[]</code> å’Œ <code>new List&lt;String&gt;[10]</code> éƒ½æ˜¯éæ³•çš„ã€‚æ ¹æœ¬åŸå› åœ¨äºç±»å‹æ“¦é™¤ä¸æ•°ç»„çš„å…·åŒ–ï¼ˆreificationï¼‰ç‰¹æ€§å†²çªï¼š</p>
<ul>
<li><strong>æ•°ç»„æ˜¯å…·åŒ–çš„</strong>ï¼šæ•°ç»„åœ¨è¿è¡Œæ—¶çŸ¥é“è‡ªå·±çš„å…ƒç´ ç±»å‹ï¼Œå¹¶åœ¨æ¯æ¬¡èµ‹å€¼æ—¶æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼ˆ<code>ArrayStoreException</code>ï¼‰ã€‚</li>
<li><strong>æ³›å‹æ˜¯æ“¦é™¤çš„</strong>ï¼šæ³›å‹ç±»å‹å‚æ•°åœ¨è¿è¡Œæ—¶ä¸å­˜åœ¨ï¼Œæ— æ³•ä¸ºæ•°ç»„æä¾›è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥æ‰€éœ€çš„ä¿¡æ¯ã€‚</li>
</ul>
<p>å¦‚æœå…è®¸åˆ›å»ºæ³›å‹æ•°ç»„ï¼Œå°†å¯¼è‡´ç±»å‹å®‰å…¨æ¼æ´ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‡è®¾ä»¥ä¸‹ä»£ç åˆæ³•ï¼ˆå®é™…ç¼–è¯‘ä¸é€šè¿‡ï¼‰</span><br><span class="hljs-comment">// List&lt;String&gt;[] stringLists = new List&lt;String&gt;[1];  // å‡è®¾åˆæ³•</span><br><span class="hljs-comment">// Object[] objects = stringLists;                     // æ•°ç»„åå˜ï¼Œåˆæ³•</span><br><span class="hljs-comment">// objects[0] = List.of(42);                           // è¿è¡Œæ—¶æ— æ³•æ£€æµ‹ç±»å‹é”™è¯¯</span><br><span class="hljs-comment">// String value = stringLists[0].get(0);               // ClassCastException</span><br></code></pre></td></tr></table></figure>
<p>æ›¿ä»£æ–¹æ¡ˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Array;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericArrayFactory</span> &#123;<br>    <span class="hljs-comment">// æ–¹æ¡ˆä¸€ï¼šé€šè¿‡ Array.newInstance åˆ›å»º</span><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T[] createArray(Class&lt;T&gt; componentType, <span class="hljs-type">int</span> length) &#123;<br>        <span class="hljs-keyword">return</span> (T[]) Array.newInstance(componentType, length);<br>    &#125;<br><br>    <span class="hljs-comment">// æ–¹æ¡ˆäºŒï¼šä½¿ç”¨é›†åˆæ›¿ä»£æ•°ç»„</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; List&lt;T&gt; <span class="hljs-title function_">createList</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šå…·åŒ–ä¸æ“¦é™¤çš„å†²çª</strong></p>
<p>æ•°ç»„çš„åå˜+å…·åŒ–è®¾è®¡ä¸æ³›å‹çš„ä¸å˜+æ“¦é™¤è®¾è®¡å­˜åœ¨æ ¹æœ¬çŸ›ç›¾ã€‚å½“éœ€è¦&quot;æ³›å‹å®¹å™¨&quot;æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ <code>List&lt;T&gt;</code> è€Œé <code>T[]</code>ã€‚å½“ç¡®å®éœ€è¦æ³›å‹æ•°ç»„æ—¶ï¼Œé€šè¿‡ <code>Array.newInstance()</code> é…åˆ <code>Class&lt;T&gt;</code> ä»¤ç‰Œåœ¨è¿è¡Œæ—¶åˆ›å»ºã€‚</p>
<h1>æ³›å‹èƒ½å¤Ÿåšä»€ä¹ˆ</h1>
<ul>
<li>type variable å¯ä»¥æ‹¿æ¥åšç›®æ ‡å‚æ•°ï¼Œå¦‚<code>T t = get()</code>ã€<code>(T)</code>ï¼Œ<code>(T[])</code>ã€‚</li>
<li>æˆ‘ä»¬å§‹ç»ˆå¯ä»¥æŠŠ parameterized type å¾€ raw type è½¬ã€‚</li>
<li><code>ArrayList&lt;Integer&gt;</code>å¯ä»¥å¾€<code>List&lt;Integer&gt;</code>è½¬-æˆ‘ä»¬ç»å¸¸æ˜¯è¿™æ ·å£°æ˜çš„ã€‚</li>
</ul>
<h2 id="é€šé…ç¬¦-wildcard">é€šé…ç¬¦ï¼ˆwildcardï¼‰</h2>
<ol>
<li>? è¡¨æ˜äº† Type variable æ˜¯æ€æ · varyçš„ã€‚</li>
<li>æ³›å‹ä¸æ˜¯åå˜çš„ï¼Œä½† ? ç”¨æ¥å®ç°æŸäº›äººç±»ä¼¼åå˜çš„éœ€æ±‚ï¼Œäº§ç”Ÿäº†ä¸€ä¸ªæ³›å‹ç±»å®¶æ—çš„çˆ¶ç±»/å­ç±»ï¼ˆ<strong>é€šé…ç¬¦å…è®¸æ³›å‹ç±»çš„ç»§æ‰¿æ ‘åœ¨æ³›å‹å±‚é¢å‡ºç°ï¼Œè€Œæ™®é€šæ³›å‹åˆ™åªå…è®¸æ³›å‹ç±»çš„ç»§æ‰¿æ ‘åœ¨å¤–éƒ¨ç±»çš„å±‚é¢å‡ºç°</strong>ï¼‰ã€‚è¿™å¢åŠ ä»£ç çš„çµæ´»æ€§ï¼ŒåŒæ—¶ä¿æŒç±»å‹å®‰å…¨ã€‚</li>
</ol>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-built_in">List</span><span class="hljs-operator">&lt;?&gt;</span> <span class="hljs-punctuation">(</span>æ ¹èŠ‚ç‚¹<span class="hljs-punctuation">)</span><br>â”œâ”€â”€ <span class="hljs-built_in">List</span><span class="hljs-operator">&lt;?</span> <span class="hljs-variable">extends</span> <span class="hljs-built_in">Number</span><span class="hljs-operator">&gt;</span>        <span class="hljs-operator">//</span> å­ç±»å‹èŒƒå›´ï¼š<span class="hljs-operator">?</span>å¯ä»¥æ˜¯<span class="hljs-built_in">Number</span>æˆ–å…¶å­ç±»ï¼ˆå¦‚<span class="hljs-built_in">Integer</span>ã€<span class="hljs-variable">Double</span>ï¼‰<br>â”‚   â””â”€â”€ <span class="hljs-built_in">List</span><span class="hljs-operator">&lt;</span><span class="hljs-built_in">Integer</span><span class="hljs-operator">&gt;</span>             <span class="hljs-operator">//</span> å…·ä½“ç±»å‹ï¼ˆéé€šé…ç¬¦ï¼‰<br>â””â”€â”€ <span class="hljs-built_in">List</span><span class="hljs-operator">&lt;?</span> <span class="hljs-variable">super</span> <span class="hljs-built_in">Integer</span><span class="hljs-operator">&gt;</span>         <span class="hljs-operator">//</span> å­ç±»å‹èŒƒå›´ï¼š<span class="hljs-operator">?</span>å¯ä»¥æ˜¯<span class="hljs-built_in">Integer</span>æˆ–å…¶çˆ¶ç±»ï¼ˆå¦‚<span class="hljs-built_in">Number</span>ã€<span class="hljs-variable">Object</span>ï¼‰<br>    â””â”€â”€ <span class="hljs-built_in">List</span><span class="hljs-operator">&lt;</span><span class="hljs-built_in">Number</span><span class="hljs-operator">&gt;</span>              <span class="hljs-operator">//</span> å…·ä½“ç±»å‹ï¼ˆéé€šé…ç¬¦ï¼‰<br></code></pre></td></tr></table></figure>
<p>åç›´è§‰çš„ä¸¤ç§å­ç±»å…³ç³»ï¼Œ<strong>å­ç±»æ„å‘³ç€ç±»å‹å…¼å®¹</strong>ï¼š</p>
<ol>
<li><code>Pair&lt;? extends Employee&gt;</code>æ„å‘³ç€å®ƒçš„å­ç±» å¯ä»¥æ˜¯<code>Pair&lt;Employee&gt;</code>å’Œ<code>Pair&lt;Manger&gt;</code>ã€‚</li>
<li><code>Pair&lt;? super Employee&gt;</code>æ„å‘³ç€å®ƒçš„å­ç±»ï¼ˆè€Œä¸æ˜¯è¶…ç±»ï¼‰å¯ä»¥æ˜¯<code>Pair&lt;Employee&gt;</code>å’Œ<code>Pair&lt;Object&gt;</code>ã€‚</li>
</ol>
<h3 id="pecs-åŸåˆ™">PECS åŸåˆ™</h3>
<p>ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å¹¶ä¸ä¼šçœŸçš„æŠŠ ? æ›¿æ¢ä¸ºå…·ä½“ç±»å‹â€”â€”<strong>è™½ç„¶å¼€å‘è€…ç»å¸¸åœ¨æ¦‚å¿µä¸Šè¿™æ ·æƒ³</strong>ã€‚</p>
<p>PECS è®¨è®ºçš„æ˜¯ï¼ŒEmployee ä½œä¸ºç›®æ ‡ç±»å‹ï¼Œ<strong>ä»€ä¹ˆæ—¶å€™åªèƒ½æ¶ˆè´¹-ä½œä¸ºå‚æ•°/å³å€¼ï¼Œä»€ä¹ˆæ—¶å€™åªèƒ½ç”Ÿäº§-ä½œä¸ºè¿”å›å€¼/å·¦å€¼</strong>ã€‚</p>
<p><code>? extends T</code>ä½œä¸ºä¸€ä¸ª type parameter è¯æ˜<strong>å¯ä»¥åœ¨ T t å¤„è¯»</strong>ã€‚<br>
<code>? super T </code>ä½œä¸ºä¸€ä¸ª type parameter è¯æ˜<strong>å¯ä»¥åœ¨ T t å¤„å†™</strong>ã€‚</p>
<p>è¿™ä¸ªåŸåˆ™å¾ˆå¥½åœ°ç¤ºèŒƒäº†**å®šä¹‰ï¼ˆç®€å•æ€§ï¼‰-ä¾‹å­ï¼ˆå¤æ‚æ€§ï¼‰-åŠ©è®°ç¬¦ï¼ˆç®€å•æ€§ï¼‰**ä¹‹é—´çš„å…³ç³»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">(Collection&lt;? extends Number&gt; e)</span> &#123;<br>    <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºeå¯èƒ½ Collection&lt;Integer&gt; æˆ–è€… Collection&lt;Long&gt;</span><br>    e.add(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// åˆæ³•</span><br><span class="hljs-keyword">public</span> Collection&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Number</span>&gt; bar() &#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>ç”±äºç¼–è¯‘å™¨æ— æ³•ç¡®å®šå…·ä½“ç±»å‹</strong>ï¼Œæ‰€ä»¥å¹²è„†ä¸å…è®¸ set/callï¼ˆæ¶ˆè´¹ï¼‰ï¼Œä½†å¯ä»¥getã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">(Collection&lt;? <span class="hljs-built_in">super</span> Number&gt; e)</span> &#123;<br>    <span class="hljs-comment">// åˆæ³•ï¼Œå› ä¸º 1 å¯ä»¥è¢«åŠ å…¥åˆ° Collection&lt;Number&gt; å’Œ Collection&lt;Object&gt; é‡Œ</span><br>    e.add(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// éæ³•ï¼Œå› ä¸ºè¿™é‡Œåªå…è®¸èµ‹å€¼ç»™ Collection&lt;Number&gt; å’Œ Collection&lt;Object&gt; </span><br><span class="hljs-keyword">public</span> Collection&lt;? <span class="hljs-built_in">super</span> Number&gt; bar() &#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç”¨èµ‹å€¼å’Œè®¾å€¼ï¼Œç”¨ collection çš„ get å’Œ add æ¯”è¾ƒå¥½ç†è§£è¿™ä¸ªè§„åˆ™ã€‚</p>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šè¯»å†™åˆ†ç¦»è¾¹ç•Œ</strong></p>
<p>PECS çš„æœ¬è´¨æ˜¯æ³›å‹çš„è¯»å†™åˆ†ç¦»ï¼š<code>? extends T</code> ä¿è¯è¯»å‡ºçš„å€¼è‡³å°‘æ˜¯ Tï¼ˆå®‰å…¨è¯»å–ï¼‰ï¼Œ<code>? super T</code> ä¿è¯å†™å…¥çš„ T å€¼ä¸€å®šå…¼å®¹å®¹å™¨ç±»å‹ï¼ˆå®‰å…¨å†™å…¥ï¼‰ã€‚è®¾è®¡ API æ—¶ï¼Œå‚æ•°å¦‚æœåªè¯»å°±ç”¨ extendsï¼Œåªå†™å°±ç”¨ superï¼Œæ—¢è¯»åˆå†™å°±ç”¨ç²¾ç¡®ç±»å‹ Tã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº†é€šé…ç¬¦ç±»å‹çš„å…³ç³»å’Œ PECS åŸåˆ™ï¼š</p>
<pre><code class="hljs mermaid">graph LR
    %% é€šé…ç¬¦ç»§æ‰¿å…³ç³»ä¸ PECS åŸåˆ™
    subgraph WildcardTypes[&quot;é€šé…ç¬¦ç±»å‹&quot;]
        A[&quot;? æ— ç•Œé€šé…ç¬¦
        Unknown Type&quot;]
        B[&quot;? extends T ä¸Šç•Œé€šé…ç¬¦
        Covariant (åå˜)&quot;]
        C[&quot;? super T ä¸‹ç•Œé€šé…ç¬¦
        Contravariant (é€†å˜)&quot;]
    end
    
    subgraph PECS[&quot;PECS åŸåˆ™&quot;]
        P[&quot;Producer Extends
        ç”Ÿäº§è€…ä½¿ç”¨ extends&quot;]
        C2[&quot;Consumer Super
        æ¶ˆè´¹è€…ä½¿ç”¨ super&quot;]
    end
    
    subgraph Examples[&quot;ä½¿ç”¨ç¤ºä¾‹&quot;]
        E1[&quot;List~? extends Number~
        åªèƒ½è¯»å–ä¸èƒ½å†™å…¥
        Number n = list.get0;&quot;]
        E2[&quot;List~? super Integer~
        åªèƒ½å†™å…¥ä¸èƒ½è¯»å–
        list.addnew Integer1;&quot;]
    end
    
    subgraph Inheritance[&quot;ç»§æ‰¿å…³ç³»&quot;]
        I1[&quot;Integer &lt;: Number&quot;]
        I2[&quot;List~Integer~ &lt;: List~? extends Integer~&quot;]
        I3[&quot;List~Integer~ &lt;: List~? super Integer~&quot;]
    end
    
    A -.-&gt;|&quot;å¯ä»¥è§†ä¸º&quot;| B
    A -.-&gt;|&quot;å¯ä»¥è§†ä¸º&quot;| C
    
    B --&gt;|&quot;é€‚ç”¨äº&quot;| P
    C --&gt;|&quot;é€‚ç”¨äº&quot;| C2
    
    P --&gt; E1
    C2 --&gt; E2
    
    style WildcardTypes fill:#e3f2fd
    style PECS fill:#f3e5f5
    style Examples fill:#e8f5e9
    style Inheritance fill:#fff3e0
    
    note[&quot;? extends T: åªè¯»ï¼Œä¸èƒ½å†™å…¥
    ? super T: åªå†™ï¼Œä¸èƒ½è¯»å–ç¡®å‹&quot;] -.-&gt; B</code></pre>
<h3 id="æ—¥æœŸçš„ä¾‹å­-ï¼Ÿå’Œ-t-åŒæ—¶å‡ºç°">æ—¥æœŸçš„ä¾‹å­-ï¼Ÿå’Œ T åŒæ—¶å‡ºç°</h3>
<p><code>LocalDate</code>æ˜¯<code>ChronoLocalDate</code>çš„å­ç±»ï¼ˆé¡ºåºå°±æ˜¯è¿™æ ·ï¼Œæ²¡æœ‰åè¿‡æ¥ï¼‰ï¼Œä½† ChronoLocalDate å·²ç„¶å®ç°äº† <code>comparable&lt;ChronoLocalDate&gt;</code>ã€‚è¿™æ—¶å€™ LocalDate çš„æ¯”è¾ƒæ–¹æ³•å°±åº”è¯¥å£°æ˜æˆ<code>&lt;T extends Comparable&lt;? super T&gt;&gt;</code>ã€‚è¿™æ˜¯å‡è½» caller ç¨‹åºå‘˜è´Ÿæ‹…ï¼Œè€ŒæŠŠå¤æ‚åº¦ç•™ç»™åº“æœ¬èº«çš„ä¸€ç§åšæ³•ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªä¾‹å­ï¼š<code>int compareTo(? super T)</code>ï¼Œè¿™æ„å‘³ç€é€šé…ç¬¦<strong>ä¸æ˜¯Tçš„å®å‚</strong>ã€‚</p>
<p>ä» A æ´¾ç”Ÿå‡º Bï¼Œåˆ™ B çš„ comparable æ–¹æ³•å¿…é¡»å£°æ˜ä¸ºå¯ä»¥æ”¯æŒ superï¼Œ<strong>è¿™æ ·å¯¹ A çš„ compare æ‰èƒ½åŒæ—¶å…¼å®¹ Aã€B - è€Œä¸åªæ˜¯ B</strong>ï¼ŒLists çš„ removeIf æ–¹æ³•çš„è°“è¯åŒç†ã€‚</p>
<p>ä¸¾ä¾‹ï¼ŒJava 8 ä¸­çš„ ArrayList æœ‰ä¸ª removeIf çš„æ–¹æ³•ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸ª predicateï¼Œä½†è¿™ä¸ª predicate çš„å®å‚å¯ä»¥æ˜¯ï¼Œæ¯”å¦‚ Employeeï¼Œä¹Ÿå¯ä»¥æ˜¯ Objectï¼ˆç”¨ä¸Šäº† superï¼‰ï¼š<code>default boolean removeIf(Predicate&lt;? super E&gt; filter)</code>ã€‚</p>
<h3 id="æ›´ä¸¥æ ¼çš„">æ›´ä¸¥æ ¼çš„<code>&lt;?&gt;</code></h3>
<p>?åœ¨æ²¡æœ‰å…¶ä»–ç±»å‹ extends/super çš„æ—¶å€™ï¼Œåªèƒ½åœ¨ get èµ‹å€¼ç”¨ï¼Œç­‰åŒäº<code>&lt;? exntends Object&gt;</code>ã€‚å†æ¬¡å¼ºè°ƒï¼Œ?ä¸æ˜¯Tçš„å®å‚ã€‚</p>
<p><code>Pair&lt;?&gt;</code> æ˜¯ä¸€ä¸ªåŠŸèƒ½å—é™çš„ç±»å‹ï¼ˆåŸæ–‡ç§°ä¸º wimpy typeï¼‰ï¼Œå…¶ <code>setFirst(? object)</code> æ–¹æ³•æ— æ³•è¢«è°ƒç”¨â€”â€”æ ¹æ® PECS æ³•åˆ™ï¼Œç¼–è¯‘å™¨æ— æ³•ç¡®å®šä¼ å…¥çš„å€¼æ˜¯å¦å…¼å®¹æœªçŸ¥çš„é€šé…ç¬¦ç±»å‹ã€‚è€Œ <code>getFirst</code> æ–¹æ³•çš„è¿”å›å€¼ä¹Ÿåªèƒ½èµ‹ç»™ <code>Object</code>ã€‚</p>
<p>ä½† <code>Pair</code> çš„ <code>set</code> æ–¹æ³•å¯ä»¥ä½¿ç”¨ä»»æ„ç±»å‹ï¼Œè€Œ <code>get</code> æ–¹æ³•å¯ä»¥èµ‹ç»™ <code>Object</code>ã€‚</p>
<p>å¦‚æœæŸäº›åœºæ™¯åªéœ€ä» <code>Pair&lt;T&gt;</code> å†…éƒ¨è¯»å€¼ï¼Œé‚£ä¹ˆ <code>Pair&lt;?&gt;</code> æ¯” <code>Pair&lt;T&gt;</code> æ›´åŠ ç®€æ´æ˜“è¯»ã€‚</p>
<h3 id="é€šé…ç¬¦æ•è·ï¼šå•å±‚-å‚æ•°æ–¹æ³•å¥—ç€å•å±‚-t-å‚æ•°æ–¹æ³•-è€Œé€»è¾‘æ˜¯åœ¨å†…å±‚æ–¹æ³•é‡Œå†™çš„">é€šé…ç¬¦æ•è·ï¼šå•å±‚<code>&lt;?&gt;</code>å‚æ•°æ–¹æ³•å¥—ç€å•å±‚<code>&lt;T&gt;</code>å‚æ•°æ–¹æ³•ï¼Œè€Œé€»è¾‘æ˜¯åœ¨å†…å±‚æ–¹æ³•é‡Œå†™çš„</h3>
<p>? ä¸æ˜¯ type variableï¼Œæ˜¯ wildcard variableã€‚</p>
<p>é€šé…ç¬¦æ•è·è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š<strong>æ— æ³•ç”¨ ? æ¥å†™ä»£ç </strong>ï¼Œä¸èƒ½å½“ä½œå·¦å€¼çš„ç±»å‹æ¥ç”¨ã€‚<code>? a = Pair.getFirst()</code> æ˜¯ä¸åˆæ³•çš„ã€‚å› æ­¤æ— æ³•ç¼–å†™ swap æ–¹æ³•ï¼š</p>
<p>é€šé…ç¬¦æ•è·çš„è§£æ³•æ˜¯ï¼š<strong>å¼•å…¥ä¸€ä¸ª T æ¥æ•è·é€šé…ç¬¦</strong>ï¼Œç”¨ T æ¥å†™ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildcardCapture</span> &#123;<br>    <span class="hljs-comment">// è¾…åŠ©æ³›å‹æ–¹æ³•ï¼šæ•è·é€šé…ç¬¦ç±»å‹</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">swapHelper</span><span class="hljs-params">(List&lt;T&gt; list, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span> &#123;<br>     <span class="hljs-comment">// åœ¨æ–¹æ³•ä½“å†…å¯ä»¥éšæ„ä½¿ç”¨ tempã€‚ç”¨æœ‰å€¼çš„å®ä¾‹æ¥è·å–æ³›å‹å˜é‡ã€‚</span><br>        <span class="hljs-type">T</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> list.get(i);<br>        list.set(i, list.get(j));<br>        list.set(j, temp);<br>        <span class="hljs-keyword">return</span> temp;<br><br>    &#125;<br><br>    <span class="hljs-comment">// å¯¹å¤–æš´éœ²çš„é€šé…ç¬¦æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swap</span><span class="hljs-params">(List&lt;?&gt; list, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span> &#123;<br>       <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> swapHelper(list, i, j); <span class="hljs-comment">// é€šé…ç¬¦æ•è·åœ¨æ­¤å‘ç”Ÿ</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">// ç”²éª¨æ–‡çš„ä¾‹å­</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildcardFixed</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">(List&lt;?&gt; i)</span> &#123;<br>        fooHelper(i);<br>    &#125;<br><br>    <span class="hljs-comment">// Helper method created so that the wildcard can be captured</span><br>    <span class="hljs-comment">// through type inference.</span><br>    <span class="hljs-keyword">private</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">fooHelper</span><span class="hljs-params">(List&lt;T&gt; l)</span> &#123;<br>        l.set(<span class="hljs-number">0</span>, l.get(<span class="hljs-number">0</span>));<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œ<strong>T æ•è·äº†é€šé…ç¬¦</strong>ã€‚T ä¸çŸ¥é“ ? çš„å…·ä½“ç±»å‹ï¼Œä½†çŸ¥é“å®ƒæ˜¯æŸä¸ªç¡®å®šç±»å‹-å°±å½“ Object ç”¨ã€‚</p>
<p>ç¼–è¯‘å™¨åªæœ‰åœ¨ç¡®å®š T å¯ä»¥æ•è·ç¡®å®šçš„é€šé…ç¬¦çš„æ—¶å€™æ‰å…è®¸ç¼–è¯‘é€šè¿‡ã€‚ä¾‹å¦‚<code>List&lt;Pair&lt;?&gt;&gt;</code> å¤šäº†ä¸€ä¸ªé—´æ¥å±‚ï¼Œä¸€ä¸ª list å¯èƒ½æœ‰ä¸åŒçš„ <code>Pair&lt;?&gt;</code>ï¼ˆè¿™è¶³ä»¥è¯æ˜?å³ä½¿æ˜¯åœ¨ä¸€ä¸ªæ•°æ®ç»“æ„é‡Œï¼Œä¹Ÿå¯èƒ½äº§ç”Ÿå¤šä¸ªç±»å‹<code>Pair1&lt;?&gt;</code>å†…éƒ¨çš„çš„ï¼Ÿæ˜¯åŒä¸€ç§ï¼Ÿï¼Œä½†æ˜¯ <code>Pair2&lt;?&gt;</code>å®Œå…¨æ˜¯å¦ä¸€ç§ï¼‰ï¼ŒæŒæœ‰ä¸åŒçš„å…·ä½“ç±»å‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šå…è®¸æ•è· <code>List&lt;Pair&lt;T&gt;&gt;</code>é‡Œçš„ Tã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildcardFixed</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">(List&lt;List&lt;?&gt;&gt; i)</span> &#123;<br>        fooHelper(i);<br>    &#125;<br><br>    <span class="hljs-comment">// not working</span><br>    <span class="hljs-keyword">private</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">fooHelper</span><span class="hljs-params">(List&lt;List&lt;T&gt;&gt; l)</span> &#123;<br>        l.set(<span class="hljs-number">0</span>, l.get(<span class="hljs-number">0</span>));<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>éœ€è¦çš„ç±»å‹: List &lt;List&lt;T&gt;&gt; æä¾›çš„ç±»å‹: List &lt;List&lt;?&gt;&gt; åŸå› : ä¸å…¼å®¹çš„ç›¸ç­‰çº¦æŸ: T å’Œ ?</code></p>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šé€šé…ç¬¦æ•è·æ¡¥æ¥</strong></p>
<p>å½“éœ€è¦å¯¹é€šé…ç¬¦ç±»å‹æ‰§è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œç¼–å†™ä¸€ä¸ªç§æœ‰æ³›å‹è¾…åŠ©æ–¹æ³•æ¥&quot;æ•è·&quot;é€šé…ç¬¦ï¼šå¤–å±‚æ–¹æ³•æ¥å— <code>&lt;?&gt;</code>ï¼Œå†…å±‚æ–¹æ³•ç”¨ <code>&lt;T&gt;</code> æ•è·å…·ä½“ç±»å‹ã€‚ç¼–è¯‘å™¨é€šè¿‡ç±»å‹æ¨æ–­å°† <code>?</code> ç»‘å®šåˆ° <code>T</code>ï¼Œä»è€Œåœ¨è¾…åŠ©æ–¹æ³•å†…éƒ¨è·å¾—å®Œæ•´çš„ç±»å‹æ“ä½œèƒ½åŠ›ã€‚æ³¨æ„ï¼šå¤šå±‚åµŒå¥—çš„é€šé…ç¬¦ï¼ˆå¦‚ <code>List&lt;List&lt;?&gt;&gt;</code>ï¼‰æ— æ³•è¢«æ•è·ï¼Œå› ä¸ºå†…å±‚çš„ <code>?</code> å¯èƒ½ä»£è¡¨ä¸åŒçš„å…·ä½“ç±»å‹ã€‚</p>
<h3 id="å¹½çµç±»å‹">å¹½çµç±»å‹</h3>
<p>ä¾‹å­æ¥è‡ªäº<a href="https://magicliang.github.io/2017/11/30/Java%E4%B8%AD%E7%9A%84%E5%B9%BD%E7%81%B5%E7%B1%BB%E5%9E%8B/">ã€ŠJavaä¸­çš„å¹½çµç±»å‹ã€‹</a>å’Œ<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/86526306">ã€Šä½ çœŸçš„æ‡‚ Builder è®¾è®¡æ¨¡å¼å—ï¼Ÿè®ºå¦‚ä½•å®ç°çœŸæ­£å®‰å…¨çš„ Builder æ¨¡å¼ã€‹</a>ã€‚</p>
<p>å¿½ç•¥äº†ç‰¹åˆ«å¤æ‚çš„é˜¶æ®µå¼æ„é€ ï¼Œå› ä¸ºå®ƒæ˜¯ä¸æ³›å‹æ— å…³çš„ã€‚</p>
<h4 id="æ„é€ ç±»å‹çš„ç”¨æ³•">æ„é€ ç±»å‹çš„ç”¨æ³•</h4>
<ol>
<li>ç”¨æ¥å£å­ç±»å½“ä½œçŠ¶æ€ï¼Œè€Œä¸æ˜¯æšä¸¾ï¼Œè¿™æ ·å¯ä»¥ä½œä¸º generic çš„boundä½¿ç”¨ã€‚</li>
<li>å®šä¹‰æ³›å‹ç±»ï¼Œæ³›å‹ç±»åªæœ‰ç§æœ‰æ„é€ å™¨ï¼Œä¸å…è®¸å¤–éƒ¨åˆ›å»ºï¼Œå› ä¸ºè¿™æ˜¯æ³›å‹ç±»ï¼Œæ‰€ä»¥æ„é€ å™¨åœ¨è°ƒç”¨çš„æ—¶å€™æ˜¯ä¸€å®šå¯ä»¥å¸¦æœ‰ç±»å‹è§è¯çš„ï¼Œå¦‚<code>new Plane&lt;Landed&gt;(10)</code>ã€‚</li>
<li>å®šä¹‰åˆå§‹æ„é€ æ–¹æ³•ï¼Œåªå…è®¸ç”Ÿæˆåˆå§‹æ€å®ä¾‹ã€‚</li>
<li>**å…³é”®ï¼š**å®šä¹‰å¤åˆ¶æ„é€ æ–¹æ³•ï¼Œå…è®¸<code>? extend FlightStatus</code>è¿™ä¸ªç±»å‹æ—çš„å®ä¾‹ç›¸äº’æ‹·è´ï¼Œè¿™æ ·äº§ç”Ÿäº†å¤–å±‚æ–¹æ³•ã€‚</li>
<li>å®šä¹‰å„ç§è·³è½¬æ–¹æ³•ï¼Œ <strong>å…³é”®ï¼šåœ¨ç­¾åå’Œè¿”å›å€¼ä¸Šåšå¹½çµç±»å‹çš„åˆ‡æ¢</strong>ï¼Œå†…éƒ¨åªä½¿ç”¨åŒä¸€ä¸ªå‚æ•°æ—æ–¹æ³•å¤åˆ¶æ¥å¤åˆ¶å»ï¼Œæ¯æ¬¡å¤åˆ¶çš„æ—¶å€™ä½¿ç”¨æ–°çš„ç±»å‹è§è¯<code>return new Plane&lt;Flying&gt;(p);</code>ã€‚</li>
</ol>
<h4 id="ä¸åŸºäºæ¥å£çš„ç”¨æ³•">ä¸åŸºäºæ¥å£çš„ç”¨æ³•</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Member</span> &#123;&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Team</span>&lt;S&gt; &#123;<br>    <span class="hljs-keyword">private</span> List&lt;Member&gt; members = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-comment">// ...å…¶ä»–ä»£ç </span><br>    <span class="hljs-comment">// phantom types</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">READY</span> &#123;&#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">STARTED</span> &#123;&#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">END</span> &#123;&#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Game</span> &#123;<br>    <span class="hljs-keyword">public</span> Team&lt;Team.STARTED&gt; start(Team&lt;Team.READY&gt; team) &#123;<br>        <span class="hljs-comment">// ...å®ç°ä»£ç </span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> Team&lt;Team.END&gt; end(Team&lt;Team.STARTED&gt; team) &#123;<br>        <span class="hljs-comment">// ...å®ç°ä»£ç </span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-comment">// ...å…¶ä»–æ–¹æ³•</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="builder-pattern">builder pattern</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String password;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String name, String password)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.password = password;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> User <span class="hljs-title function_">build</span><span class="hljs-params">(Builder&lt;TRUE, TRUE&gt; builder)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(builder.name, builder.password);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Builder&lt;FALSE, FALSE&gt; <span class="hljs-title function_">builder</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Builder</span>&lt;FALSE, FALSE&gt;();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span>&lt;HNAME, HPASSWORD&gt; &#123;<br>        <span class="hljs-keyword">private</span> String name;<br>        <span class="hljs-keyword">private</span> String password;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-title function_">Builder</span><span class="hljs-params">()</span> &#123;<br>        &#125;<br><br>        <span class="hljs-keyword">private</span> <span class="hljs-title function_">Builder</span><span class="hljs-params">(String name, String password)</span> &#123;<br>            <span class="hljs-built_in">this</span>.name = name;<br>            <span class="hljs-built_in">this</span>.password = password;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> Builder&lt;TRUE, HPASSWORD&gt; <span class="hljs-title function_">name</span><span class="hljs-params">(String name)</span> &#123;<br>            <span class="hljs-built_in">this</span>.name = name;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Builder</span>&lt;TRUE, HPASSWORD&gt;(name, <span class="hljs-built_in">this</span>.password);<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> Builder&lt;HNAME, TRUE&gt; <span class="hljs-title function_">password</span><span class="hljs-params">(String password)</span> &#123;<br>            <span class="hljs-built_in">this</span>.password = password;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Builder</span>&lt;HNAME, TRUE&gt;(<span class="hljs-built_in">this</span>.name, password);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// phantom types</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TRUE</span> &#123;&#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FALSE</span> &#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<ol>
<li>æŠŠ builder æ³›å‹åŒ–ï¼Œæ¯ä¸ªå­—æ®µå¯¹åº”ä¸€ä¸ªæ³›å‹å‚æ•°ã€‚</li>
<li>å®šä¹‰ TRUEã€FALSE ä¸¤ä¸ªçŠ¶æ€ã€‚</li>
<li>æ„é€ å™¨è¦æ±‚å­—æ®µå¯¹åº”çš„æ³›å‹å‚æ•°å…¨éƒ¨éƒ½æ˜¯ TRUEã€‚</li>
<li>æ¯ä¸ª builder åªä¿ç•™ä¸€ä¸ªæœ¬å‚æ•°å¯¹åº”çš„ç±»å‹å®å‚ï¼Œå…¶ä»–éƒ¨åˆ†ä»ç„¶æ³›åŒ–-<strong>éƒ¨åˆ†æ³›å‹</strong>ã€‚</li>
<li>å¦‚æœä¸€ä¸ªå­—æ®µæœ‰é»˜è®¤å€¼ï¼Œå®ƒä¸å…·æœ‰å¯¹åº”çš„æ³›å‹å‚æ•°ã€‚</li>
</ol>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šç¼–è¯‘æœŸçŠ¶æ€æœº</strong></p>
<p>å¹½çµç±»å‹å°†è¿è¡Œæ—¶çŠ¶æ€æ£€æŸ¥æå‰åˆ°ç¼–è¯‘æœŸï¼šç”¨ä¸åŒçš„ç±»å‹ï¼ˆè€Œéæšä¸¾å€¼ï¼‰è¡¨ç¤ºçŠ¶æ€ï¼Œç”¨æ³›å‹å‚æ•°æºå¸¦çŠ¶æ€ä¿¡æ¯ï¼Œç”¨æ–¹æ³•ç­¾åçš„ç±»å‹å˜æ¢è¡¨è¾¾çŠ¶æ€è½¬ç§»ã€‚éæ³•çš„çŠ¶æ€è½¬ç§»åœ¨ç¼–è¯‘æœŸå°±ä¼šæŠ¥é”™ï¼Œè€Œéç­‰åˆ°è¿è¡Œæ—¶æ‰æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ä¸€æ¨¡å¼ç‰¹åˆ«é€‚åˆ Builderã€çŠ¶æ€æœºã€åè®®æµç¨‹ç­‰éœ€è¦å¼ºåˆ¶æ‰§è¡Œè°ƒç”¨é¡ºåºçš„åœºæ™¯ã€‚</p>
<h1>æ³›å‹ä¸åå°„</h1>
<h2 id="æ³›å‹ä¸-class">æ³›å‹ä¸ class</h2>
<p><code>String.class</code>æ˜¯<code>Class&lt;String&gt;</code>çš„ä¸€ä¸ª objectã€‚</p>
<p>Class çš„ type variable å®é™…ä¸Šé™åˆ¶äº†å®ƒæ–¹æ³•çš„ç§ç§è¿”å›å€¼ã€‚</p>
<p>Java åœ¨5ä»¥åï¼Œç¡®åˆ‡åœ°æŠŠå„ç§constructorç›¸å…³çš„æ–¹æ³•éƒ½<code>&lt;T&gt;</code>å‚æ•°åŒ–äº†ã€‚</p>
<h2 id="åå°„èƒ½å¤Ÿåœ¨æ“¦é™¤åçŸ¥é“äº›ä»€ä¹ˆ">åå°„èƒ½å¤Ÿåœ¨æ“¦é™¤åçŸ¥é“äº›ä»€ä¹ˆ</h2>
<p>å¯ä»¥çŸ¥é“çš„ä»¥ä¸‹ä¸œè¥¿ï¼š</p>
<ul>
<li>ä¸€ä¸ªæ–¹æ³•æˆ–è€…ç±»å‹æœ‰ä¸ª type parameter Tã€‚</li>
<li>T æœ‰ super æˆ–è€… extends çš„ boundã€‚</li>
<li>T æœ‰ä¸ª wildcard variable - wildcard å’Œ T ä¼šåŒæ—¶å­˜åœ¨ã€‚</li>
</ul>
<h2 id="ä¸å¯ä»¥çŸ¥é“çš„ä¸œè¥¿">ä¸å¯ä»¥çŸ¥é“çš„ä¸œè¥¿</h2>
<ul>
<li>åˆ°åº•è¿è¡Œæ—¶ç»‘å®šçš„ type parameter æ˜¯ä»€ä¹ˆï¼Ÿhow type parameter were resolved.</li>
</ul>
<h3 id="è·å–ç±»å‹ä¿¡æ¯">è·å–ç±»å‹ä¿¡æ¯</h3>
<p><code>Type[] actualTypes = ((ParameterizedType) type).getActualTypeArguments()</code>ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿå¾—åˆ°<code>String</code>ï¼Ÿ</p>
<p>ä¸¢å¤±ç±»å‹ä¿¡æ¯å°±æ— æ³• ParameterizedType è½¬å‹ã€‚</p>
<h4 id="ä»€ä¹ˆæƒ…å†µä¸‹ä¼šä¸¢å¤±ç±»å‹ä¿¡æ¯">ä»€ä¹ˆæƒ…å†µä¸‹ä¼šä¸¢å¤±ç±»å‹ä¿¡æ¯</h4>
<ul>
<li>æ–¹æ³•å‚æ•°ï¼ˆå¦‚<code>void process(List&lt;T&gt; list)</code>ï¼‰ã€‚</li>
<li>å±€éƒ¨å˜é‡ï¼ˆå¦‚<code>List&lt;T&gt; list = new ArrayList&lt;&gt;()</code>ï¼‰ã€‚</li>
<li>æ³›å‹æ–¹æ³•çš„ç±»å‹æ¨æ–­ï¼ˆå¦‚<code>Collections.emptyList()</code>ï¼‰ã€‚</li>
</ul>
<h4 id="ä»€ä¹ˆæƒ…å†µä¸‹èƒ½å¤Ÿè·å–åˆ°ç±»å‹ä¿¡æ¯">ä»€ä¹ˆæƒ…å†µä¸‹èƒ½å¤Ÿè·å–åˆ°ç±»å‹ä¿¡æ¯</h4>
<ul>
<li>ç±»æˆ–æ¥å£ç»§æ‰¿æ—¶æ˜¾å¼æŒ‡å®šæ³›å‹å‚æ•°â€‹â€‹ï¼ˆå¦‚ class MyList extends ArrayList<String>ï¼‰ã€‚</li>
<li>ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ï¼š<code>List&lt;String&gt; list = new ArrayList&lt;String&gt;() {}; // åŒ¿åå­ç±»</code>
<ul>
<li>gsonçš„ç±»å‹ä»¤ç‰Œï¼š<code>List&lt;String&gt; list = gson.fromJson(json, new TypeToken&lt;List&lt;String&gt;&gt;() {}.getType());// è¿™é‡Œè·å¾—çš„ Type æ˜¯æœ€é¡¶å±‚çš„java Type æ¥å£</code></li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TypeToken</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Type type;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TypeToken</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Type</span> <span class="hljs-variable">superClass</span> <span class="hljs-operator">=</span> getClass().getGenericSuperclass();<br>        <span class="hljs-built_in">this</span>.type = ((ParameterizedType) superClass).getActualTypeArguments()[<span class="hljs-number">0</span>];<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Type <span class="hljs-title function_">getType</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> type; &#125;<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼ˆå‡è®¾ TypeToken ç±»å·²å®šä¹‰ï¼‰</span><br><span class="hljs-comment">// TypeToken&lt;List&lt;String&gt;&gt; token = new TypeToken&lt;List&lt;String&gt;&gt;() &#123;&#125;;</span><br><span class="hljs-comment">// System.out.println(token.getType()); // è¾“å‡º: java.util.List&lt;java.lang.String&gt;</span><br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šåŒ¿åå­ç±»ç±»å‹æ•è·</strong></p>
<p><code>TypeToken</code> åˆ©ç”¨äº†ä¸€ä¸ªå…³é”®äº‹å®ï¼šè™½ç„¶æ³›å‹åœ¨è¿è¡Œæ—¶è¢«æ“¦é™¤ï¼Œä½†<strong>ç±»å®šä¹‰ä¸­çš„æ³›å‹ä¿¡æ¯ä¼šä¿ç•™åœ¨å­—èŠ‚ç çš„ Signature å±æ€§ä¸­</strong>ã€‚é€šè¿‡åˆ›å»ºåŒ¿åå­ç±» <code>new TypeToken&lt;List&lt;String&gt;&gt;() {}</code>ï¼Œæ³›å‹å‚æ•° <code>List&lt;String&gt;</code> è¢«å›ºåŒ–åˆ°å­ç±»çš„ç±»å®šä¹‰ä¸­ï¼Œå¯é€šè¿‡ <code>getGenericSuperclass()</code> åœ¨è¿è¡Œæ—¶è·å–ã€‚Gsonã€Jacksonã€Spring çš„ <code>ParameterizedTypeReference</code> éƒ½åŸºäºè¿™ä¸€åŸç†ã€‚</p>
<h2 id="åå°„çš„ç±»å‹-hierarchy">åå°„çš„ç±»å‹ hierarchy</h2>
<p><img src="java%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F.png" alt="javaç±»å‹ç³»ç»Ÿ.png"></p>
<p>ä¸‹å›¾å±•ç¤ºäº† Java åå°„ Type æ¥å£çš„å®Œæ•´å±‚æ¬¡ç»“æ„ï¼š</p>
<pre><code class="hljs mermaid">classDiagram
    %% Java åå°„ Type æ¥å£å±‚æ¬¡ç»“æ„å›¾
    class Type &#123;
        &lt;&lt;interface&gt;&gt;
        Type ç±»å‹è¡¨ç¤º
    &#125;
    
    class Class &#123;
        &lt;&lt;class&gt;&gt;
        è¡¨ç¤ºåŸå§‹ç±»å‹å’Œæ³›å‹ç±»
        +getTypeParameters()
        +getComponentType()
    &#125;
    
    class TypeVariable &#123;
        &lt;&lt;interface&gt;&gt;
        è¡¨ç¤ºç±»å‹å˜é‡ï¼ˆå¦‚ T, Eï¼‰
        +getName()
        +getBounds()
        +getGenericDeclaration()
    &#125;
    
    class ParameterizedType &#123;
        &lt;&lt;interface&gt;&gt;
        è¡¨ç¤ºå‚æ•°åŒ–ç±»å‹ï¼ˆå¦‚ List~String~ï¼‰
        +getActualTypeArguments()
        +getRawType()
        +getOwnerType()
    &#125;
    
    class GenericArrayType &#123;
        &lt;&lt;interface&gt;&gt;
        è¡¨ç¤ºæ³›å‹æ•°ç»„ç±»å‹ï¼ˆå¦‚ T[]ï¼‰
        +getGenericComponentType()
    &#125;
    
    class WildcardType &#123;
        &lt;&lt;interface&gt;&gt;
        è¡¨ç¤ºé€šé…ç¬¦ç±»å‹ï¼ˆå¦‚ ? extends Tï¼‰
        +getUpperBounds()
        +getLowerBounds()
    &#125;
    
    Type &lt;|-- Class
    Type &lt;|-- TypeVariable
    Type &lt;|-- ParameterizedType
    Type &lt;|-- GenericArrayType
    Type &lt;|-- WildcardType
    
    note for Type &quot;java.lang.reflect.Type\næ‰€æœ‰ç±»å‹çš„é¡¶çº§æ¥å£&quot;
    note for Class &quot;è¡¨ç¤ºå…·ä½“çš„ç±»ç±»å‹\nå¦‚ String, List, Integer&quot;
    note for TypeVariable &quot;æ³›å‹ç±»å‹å˜é‡\nå¦‚ T, E, K, V&quot;
    note for ParameterizedType &quot;å‚æ•°åŒ–ç±»å‹\nå¦‚ List~String~, Map~String, Integer~&quot;
    note for GenericArrayType &quot;æ³›å‹æ•°ç»„\nå¦‚ T[], List~E~[]&quot;
    note for WildcardType &quot;é€šé…ç¬¦ç±»å‹\nå¦‚ ?, ? extends Number, ? super String&quot;</code></pre>
<p>åå°„çš„åŸºç¡€ç±»å‹æ˜¯<code>Type</code>æ¥å£ï¼Œå®ƒæœ‰äº”ä¸ªå­ç±»ï¼š</p>
<h3 id="class">Class</h3>
<p>æè¿°å…·ä½“ç±»å‹ï¼ˆè€Œä¸æ˜¯æ¥å£ï¼‰ã€‚æˆ‘ä»¬å¸¸è§çš„ç±»å‹å¦‚æœæœ¬èº«ä¸å¸¦æœ‰<code>&lt;&gt;</code>å°±å±äºè¿™ä¸€ç±»å‹ã€‚å¯¹ Java 1.5 ä»¥åçš„æ³›å‹ï¼Œä¸€ä¸ª<code>Map.class</code>å’Œ<code>Map&lt;String, Integer&gt;</code>çš„ class åœ¨æ±‚ç­‰ä¸Šå®Œå…¨ç›¸ç­‰ï¼Œä½†å”¯æœ‰å¼•å…¥å…¶ä»– Type å­ç±»æ‰èƒ½è¯´æ˜<code>String</code>å’Œ<code>Integer</code>çš„å­˜åœ¨ã€‚</p>
<ul>
<li>æœ€å¸¸è§çš„ Type å®ç°ç±»ã€‚</li>
<li>ä»£è¡¨åŸå§‹ç±»å‹ï¼ˆraw typesï¼‰å’ŒåŸºæœ¬ç±»å‹ï¼ˆprimitive typesï¼‰</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Class&lt;?&gt; clazz = String.class;<br>Class&lt;?&gt; arrayClass = <span class="hljs-type">int</span>[].class; <span class="hljs-comment">// class [I</span><br></code></pre></td></tr></table></figure>
<h3 id="typevariable-ç±»å‹å˜é‡">TypeVariableï¼ˆç±»å‹å˜é‡ï¼‰</h3>
<ul>
<li>è¡¨ç¤ºæ³›å‹ä¸­çš„ç±»å‹å˜é‡</li>
<li>ä¾‹å¦‚æ³›å‹å®šä¹‰ä¸­çš„ Tã€Kã€V ç­‰</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Container</span>&lt;T&gt; &#123;<br>    <span class="hljs-keyword">private</span> T value;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showType</span><span class="hljs-params">()</span> &#123;<br>        TypeVariable&lt;?&gt;[] typeParameters = Container.class.getTypeParameters();<br>        <span class="hljs-comment">// typeParameters[0] å°±æ˜¯ T</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="parameterizedtype-å‚æ•°åŒ–ç±»å‹">ParameterizedTypeï¼ˆå‚æ•°åŒ–ç±»å‹ï¼‰</h3>
<ul>
<li>æè¿°æ³›å‹ç±»æˆ–æ¥å£ç±»å‹ï¼Œå¦‚<code>Comparable&lt;? super T&gt;</code>- æ³¨æ„ï¼Œå¦‚æœä¸¢å¤±äº†ç±»å‹ä¿¡æ¯ï¼ˆéå­ç±»å‹ï¼‰ï¼Œæ­¤å¤„æ˜¯ T è€Œä¸æ˜¯ Stringã€‚å¸¸è§çš„ ParameterizedType æœ‰ Collection çš„ Class å®ä¾‹ã€‚å¯ä»¥ç®€å•æŠŠ ParameterizedType ç†è§£ä¸º æŒ‡å‘ Collection ç±»çš„ç‰¹æ®Šçš„ classï¼Œå®ƒæºå¸¦çš„ actualParamters å°±æ˜¯String/Integer çš„ classï¼Œè€Œ WildcardType çš„ bounds å°±æ˜¯ extends A çš„é‚£ä¸ª A çš„ classã€‚å®ƒè¿˜æœ‰ä¸€ä¸ª getRawTypeï¼ˆä¹Ÿå°±æ˜¯ Mapï¼‰ï¼Œå’Œ ownerTypeï¼ˆä¹Ÿå°±æ˜¯ Map ä¹‹äº Entryï¼‰ã€‚</li>
<li>ä¸»è¦æ–¹æ³•ï¼š
<ul>
<li><code>getActualTypeArguments()</code>: è·å–æ³›å‹å‚æ•°çš„å®é™…ç±»å‹</li>
<li><code>getRawType()</code>: è·å–åŸå§‹ç±»å‹</li>
<li><code>getOwnerType()</code>: è·å–æ‰€å±ç±»å‹</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Type;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">// HashMap çš„ getGenericSuperclass() è¿”å›çš„æ˜¯ AbstractMapï¼Œä¸æ˜¯å‚æ•°åŒ–ç±»å‹</span><br><span class="hljs-comment">// è¿™é‡Œä»…æ¼”ç¤ºåå°„ API çš„ä½¿ç”¨</span><br>Map&lt;String, List&lt;Integer&gt;&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><span class="hljs-type">Type</span> <span class="hljs-variable">type</span> <span class="hljs-operator">=</span> map.getClass().getGenericSuperclass();<br><span class="hljs-comment">// æ³¨æ„ï¼šä»¥ä¸‹ instanceof æ£€æŸ¥å®é™…ä¸ä¼šé€šè¿‡ï¼Œå› ä¸º HashMap çš„çˆ¶ç±»ä¸æ˜¯å‚æ•°åŒ–ç±»å‹</span><br><span class="hljs-comment">// å®é™…ä½¿ç”¨æ—¶éœ€è¦å…ˆåˆ¤æ–­ Type çš„å…·ä½“ç±»å‹ï¼Œå†è¿›è¡Œç›¸åº”çš„ç±»å‹è½¬æ¢å’Œæ“ä½œ</span><br></code></pre></td></tr></table></figure>
<h3 id="genericarraytype-æ³›å‹æ•°ç»„ç±»å‹">GenericArrayTypeï¼ˆæ³›å‹æ•°ç»„ç±»å‹ï¼‰</h3>
<p>GenericArray æ¥å£ï¼Œæè¿°æ³›å‹æ•°ç»„å¦‚ <code>T[]</code>ã€‚è¿™å¯ä»¥è¢«ç”¨åœ¨è·å–æ–¹æ³•å‚æ•°ä¸Šã€‚è·å–åˆ°å…·ä½“å‚æ•°ä»¥åï¼Œå¯ä»¥æŠŠå®ƒè½¬åŒ–ä¸º ParameterizedTypeï¼Œç„¶åè·å–å®ƒæºå¸¦çš„ actualParamtersã€‚ä¾‹å¦‚ï¼š<code>T[]</code> æˆ– <code>List&lt;String&gt;[]</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.GenericArrayType;<br><span class="hljs-keyword">import</span> java.lang.reflect.ParameterizedType;<br><span class="hljs-keyword">import</span> java.lang.reflect.Type;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span>&lt;T&gt; &#123;<br>    T[] array;<br>    List&lt;String&gt;[] lists;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">check</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> NoSuchFieldException &#123;<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">arrayField</span> <span class="hljs-operator">=</span> Example.class.getDeclaredField(<span class="hljs-string">&quot;array&quot;</span>);<br>        <span class="hljs-type">Type</span> <span class="hljs-variable">arrayType</span> <span class="hljs-operator">=</span> arrayField.getGenericType();<br>        <span class="hljs-keyword">if</span> (arrayType <span class="hljs-keyword">instanceof</span> GenericArrayType) &#123;<br>            <span class="hljs-type">Type</span> <span class="hljs-variable">componentType</span> <span class="hljs-operator">=</span> ((GenericArrayType) arrayType).getGenericComponentType();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><br><span class="hljs-meta">### WildcardTypeï¼ˆé€šé…ç¬¦ç±»å‹ï¼‰</span><br><br>è¡¨ç¤ºé€šé…ç¬¦æ³›å‹ï¼Œå¦‚ `?`ã€`? extends <span class="hljs-type">Number</span>`ã€`? super <span class="hljs-type">Integer</span>`ã€‚å®ƒå¿…ç„¶å¯ä»¥æ‰¾åˆ° up boundï¼ˆæœ€èµ·ç æœ‰ <span class="hljs-type">Object</span>ï¼‰ï¼Œä¸ä¸€å®šæœ‰ lower boundã€‚<br><br>```java<br><span class="hljs-title">public</span> <span class="hljs-keyword">class</span> <span class="hljs-type">WildcardExample</span> &#123;<br>    <span class="hljs-type">List</span>&lt;? extends <span class="hljs-type">Number</span>&gt; numbers;<br>    <br>    public void examine() &#123;<br>        <span class="hljs-type">Field</span> field = <span class="hljs-type">WildcardExample</span>.<span class="hljs-keyword">class</span>.getDeclaredField(<span class="hljs-string">&quot;numbers&quot;</span>);<br>        <span class="hljs-type">Type</span> <span class="hljs-class"><span class="hljs-keyword">type</span> = field.getGenericType();</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-class"><span class="hljs-keyword">type</span> instanceof <span class="hljs-type">ParameterizedType</span>) &#123;</span><br><span class="hljs-class">            <span class="hljs-type">Type</span>[] <span class="hljs-title">actualTypeArguments</span> = ((<span class="hljs-type">ParameterizedType</span>) <span class="hljs-title">type</span>).<span class="hljs-title">getActualTypeArguments</span>();</span><br><span class="hljs-class">            <span class="hljs-type">WildcardType</span> <span class="hljs-title">wildcard</span> = (<span class="hljs-type">WildcardType</span>) <span class="hljs-title">actualTypeArguments</span>[0];</span><br><span class="hljs-class">            <span class="hljs-type">Type</span>[] <span class="hljs-title">upperBounds</span> = <span class="hljs-title">wildcard</span>.<span class="hljs-title">getUpperBounds</span>(); // è·å–ä¸Šç•Œ</span><br><span class="hljs-class">            <span class="hljs-type">Type</span>[] <span class="hljs-title">lowerBounds</span> = <span class="hljs-title">wildcard</span>.<span class="hljs-title">getLowerBounds</span>(); // è·å–ä¸‹ç•Œ</span><br><span class="hljs-class">        &#125;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="ä¸»è¦ä½¿ç”¨åœºæ™¯">ä¸»è¦ä½¿ç”¨åœºæ™¯</h3>
<ol>
<li>åå°„è·å–æ³›å‹ä¿¡æ¯</li>
<li>æ³›å‹ç±»å‹ç³»ç»Ÿçš„å®ç°</li>
<li>æ¡†æ¶å¼€å‘ä¸­çš„ç±»å‹åˆ¤æ–­å’Œå¤„ç†</li>
<li>æ³¨è§£å¤„ç†å™¨çš„å¼€å‘</li>
<li>åºåˆ—åŒ–/ååºåˆ—åŒ–æ¡†æ¶</li>
</ol>
<p>è¿™äº›ç±»å‹ç³»ç»Ÿçš„å®ç°è®© Java èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶è·å–å’Œå¤„ç†æ³›å‹ä¿¡æ¯ï¼Œå°½ç®¡ Java çš„æ³›å‹æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤å®ç°çš„ï¼Œä½†é€šè¿‡è¿™äº›æ¥å£ä»ç„¶å¯ä»¥åœ¨è¿è¡Œæ—¶è·å–åˆ°æ³›å‹çš„ç±»å‹ä¿¡æ¯ã€‚</p>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šType äº”å­ç±»åˆ†æ²»</strong></p>
<p>å¤„ç†åå°„ä¸­çš„æ³›å‹ç±»å‹æ—¶ï¼Œé‡‡ç”¨åˆ†æ²»ç­–ç•¥ï¼šå¯¹ <code>Type</code> å®ä¾‹ä¾æ¬¡åˆ¤æ–­æ˜¯å¦ä¸º <code>Class</code>ï¼ˆå…·ä½“ç±»å‹ï¼‰ã€<code>ParameterizedType</code>ï¼ˆå‚æ•°åŒ–ç±»å‹ï¼‰ã€<code>TypeVariable</code>ï¼ˆç±»å‹å˜é‡ï¼‰ã€<code>WildcardType</code>ï¼ˆé€šé…ç¬¦ï¼‰ã€<code>GenericArrayType</code>ï¼ˆæ³›å‹æ•°ç»„ï¼‰ï¼Œåˆ†åˆ«æå–å¯¹åº”çš„ç±»å‹ä¿¡æ¯ã€‚è¿™äº”ç§å­ç±»å‹è¦†ç›–äº† Java ç±»å‹ç³»ç»Ÿçš„æ‰€æœ‰å¯èƒ½å½¢æ€ã€‚</p>
<h2 id="typeliteral">TypeLiteral</h2>
<p>æœ‰ä¸€ä¸ªå¯ä»¥æ•è·å¤šé‡æ³›å‹çš„å®å‚çš„æ–¹æ¡ˆã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java"><br> <span class="hljs-comment">// 1ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªClassï¼Œç”¨Class. getGenericInterfaces()æ–¹æ³•å¾—åˆ°Type[]ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªç±»å®ç°æ¥å£çš„Typeç±»å‹åˆ—è¡¨ã€‚</span><br> <span class="hljs-comment">// 2ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªClassï¼Œç”¨Class.getDeclaredFields()æ–¹æ³•å¾—åˆ°Field[]ï¼Œä¹Ÿå°±æ˜¯ç±»çš„å±æ€§åˆ—è¡¨ï¼Œç„¶åç”¨Field. getGenericType()æ–¹æ³•å¾—åˆ°è¿™ä¸ªå±æ€§çš„Typeç±»å‹ã€‚</span><br> <span class="hljs-comment">// 3ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªMethodï¼Œç”¨Method. getGenericParameterTypes()æ–¹æ³•è·å¾—Type[]ï¼Œä¹Ÿå°±æ˜¯æ–¹æ³•çš„å‚æ•°ç±»å‹åˆ—è¡¨ã€‚</span><br><br> <span class="hljs-comment">/**</span><br><span class="hljs-comment"> * This constructor must be invoked from an anonymous subclass</span><br><span class="hljs-comment"> * as new TypeLiteral&lt;. . .&gt;()&#123;&#125;.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">TypeLiteral</span><span class="hljs-params">()</span><br>&#123;<br>   <span class="hljs-comment">// </span><br>   <span class="hljs-type">Type</span> <span class="hljs-variable">parentType</span> <span class="hljs-operator">=</span> getClass().getGenericSuperclass();<br>   <span class="hljs-keyword">if</span> (parentType <span class="hljs-keyword">instanceof</span> ParameterizedType) <br>   &#123; <br>      <span class="hljs-comment">// é‡è¦ï¼šè¿™é‡Œå¾—åˆ°çš„ Type æ˜¯çœŸçš„ Class å®ä¾‹ï¼Œä¸è¿‡åšç±»å‹åˆ¤å®šä¸èƒ½ç”¨ instanceofï¼Œåªèƒ½ç”¨ assignableFromã€‚å› ä¸º Class çš„è‡ªèº«ç±»å‹å’ŒæŒ‡ä»£ç±»å‹æ˜¯ä¸ä¸€æ ·çš„ã€‚å½“ç„¶ Type ä¹Ÿå¯èƒ½æ˜¯ ParameterizedType ç­‰ä»»æ„å­ç±»å‹ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥é€šè¿‡ getClass ç†è§£è‡ªèº«çš„ç±»å‹ã€‚</span><br>      type = ((ParameterizedType) parentType).getActualTypeArguments()[<span class="hljs-number">0</span>];<br>   &#125;<br>   <span class="hljs-keyword">else</span><br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>(<br>         <span class="hljs-string">&quot;Construct as new TypeLiteral&amp;lt;. . .&amp;gt;()&#123;&#125;&quot;</span>);            <br>&#125;<br><br><span class="hljs-comment">// ä¸Šè¿° api çš„ä¾‹å­</span><br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>     List&lt;String&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>     Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">List</span>&gt; firstClazz = list.getClass();<br>     <span class="hljs-type">Type</span> <span class="hljs-variable">genericSuperclass</span> <span class="hljs-operator">=</span> firstClazz.getGenericSuperclass();<br>     <span class="hljs-comment">// java.util.AbstractList&lt;E&gt;</span><br>     System.out.println(genericSuperclass);<br><br>     <span class="hljs-type">ParameterizedType</span> <span class="hljs-variable">parameterizedSuperType</span> <span class="hljs-operator">=</span> (ParameterizedType) genericSuperclass;<br>     Type[] actualTypeArguments = parameterizedSuperType.getActualTypeArguments();<br>     <span class="hljs-comment">// E</span><br>     <span class="hljs-type">Type</span> <span class="hljs-variable">actualTypeArgument</span> <span class="hljs-operator">=</span> actualTypeArguments[<span class="hljs-number">0</span>];<br>     System.out.println(actualTypeArgument);<br><br>     <span class="hljs-comment">// java.util.AbstractCollection&lt;E&gt;</span><br>     genericSuperclass = firstClazz.getSuperclass().getGenericSuperclass();<br>     System.out.println(genericSuperclass);<br><br>     parameterizedSuperType = (ParameterizedType) genericSuperclass;<br>     actualTypeArguments = parameterizedSuperType.getActualTypeArguments();<br>     <span class="hljs-comment">// E</span><br>     actualTypeArgument = actualTypeArguments[<span class="hljs-number">0</span>];<br>     System.out.println(actualTypeArgument);<br> &#125;<br> <br> <span class="hljs-comment">// ä½†è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œå¦‚ï¼š</span><br> <br> <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringList</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt; &#123;<br> &#125;<br><br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>     List&lt;String&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringList</span>();<br>     Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">List</span>&gt; firstClazz = list.getClass();<br>     <span class="hljs-type">Type</span> <span class="hljs-variable">genericSuperclass</span> <span class="hljs-operator">=</span> firstClazz.getGenericSuperclass();<br>     <span class="hljs-comment">// java.util.ArrayList&lt;java.lang.String&gt;</span><br>     System.out.println(genericSuperclass);<br><br>     <span class="hljs-type">ParameterizedType</span> <span class="hljs-variable">parameterizedSuperType</span> <span class="hljs-operator">=</span> (ParameterizedType) genericSuperclass;<br>     Type[] actualTypeArguments = parameterizedSuperType.getActualTypeArguments();<br>     <span class="hljs-comment">// class java.lang.String ç±»å‹ä¸å†æ˜¯ typevariable</span><br>     <span class="hljs-type">Type</span> <span class="hljs-variable">actualTypeArgument</span> <span class="hljs-operator">=</span> actualTypeArguments[<span class="hljs-number">0</span>];<br>     System.out.println(actualTypeArgument);<br> &#125;<br> <br> <span class="hljs-comment">// è¿™ä¸ªä¾‹å¤–ä¸‹é¢æœ‰ç”¨ã€‚</span><br></code></pre></td></tr></table></figure>
<h2 id="è¿è¡Œæ—¶æ•è·ç±»å‹å‚æ•°çš„æ–¹æ³•">è¿è¡Œæ—¶æ•è·ç±»å‹å‚æ•°çš„æ–¹æ³•</h2>
<h3 id="æ–¹æ³•ä¸€">æ–¹æ³•ä¸€</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericClass</span>&lt;T&gt; &#123;<br><br>     <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Class&lt;T&gt; type;<br><br>     <span class="hljs-keyword">public</span> <span class="hljs-title function_">GenericClass</span><span class="hljs-params">(Class&lt;T&gt; type)</span> &#123;<br>          <span class="hljs-built_in">this</span>.type = type;<br>     &#125;<br><br>     <span class="hljs-keyword">public</span> Class&lt;T&gt; <span class="hljs-title function_">getMyType</span><span class="hljs-params">()</span> &#123;<br>         <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.type;<br>     &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="æ–¹æ³•äºŒ">æ–¹æ³•äºŒ</h3>
<p><a target="_blank" rel="noopener" href="https://github.com/jhalterman/typetools">typetools</a></p>
<h3 id="æ–¹æ³•ä¸‰">æ–¹æ³•ä¸‰</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TypeReference</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;TypeReference&lt;T&gt;&gt;<br>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> Type _type;<br>    <br>    <span class="hljs-keyword">protected</span> <span class="hljs-title function_">TypeReference</span><span class="hljs-params">()</span><br>    &#123;<br>        <span class="hljs-type">Type</span> <span class="hljs-variable">superClass</span> <span class="hljs-operator">=</span> getClass().getGenericSuperclass();<br>        <span class="hljs-keyword">if</span> (superClass <span class="hljs-keyword">instanceof</span> Class&lt;?&gt;) &#123; <span class="hljs-comment">// sanity check, should never happen</span><br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Internal error: TypeReference constructed without actual type information&quot;</span>);<br>        &#125;<br>        <span class="hljs-comment">/* 22-Dec-2008, tatu: Not sure if this case is safe -- I suspect</span><br><span class="hljs-comment">         *   it is possible to make it fail?</span><br><span class="hljs-comment">         *   But let&#x27;s deal with specific</span><br><span class="hljs-comment">         *   case when we know an actual use case, and thereby suitable</span><br><span class="hljs-comment">         *   workarounds for valid case(s) and/or error to throw</span><br><span class="hljs-comment">         *   on invalid one(s).</span><br><span class="hljs-comment">         */</span><br>        _type = ((ParameterizedType) superClass).getActualTypeArguments()[<span class="hljs-number">0</span>];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•æ¥è‡ªäº JDK 5 çš„ä½œè€…çš„åšå®¢<a target="_blank" rel="noopener" href="http://gafter.blogspot.com/2006/12/super-type-tokens.html">ã€Šsuper-type-tokensã€‹</a>ã€‚</p>
<ol>
<li>abstract class ä¿è¯äº†è¿™ä¸ªç±»å‹å¿…é¡»é€šè¿‡å­ç±»ç¡®å®šï¼Œè¿™æ ·<code>getGenericSuperclass</code>å¿…å®šä¼šå¾—åˆ°ä¸€ä¸ª ParameterizedType è€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ª GenericTypeã€‚</li>
<li><code>implements Comparable&lt;TypeReference&lt;T&gt;&gt;</code> å¹¶ä¸æ˜¯çœŸçš„å¸Œæœ›å­ç±»è¦†å†™ä¸€ä¸ªæ¯”è¾ƒæ–¹æ³•ï¼Œè€Œæ˜¯å¸Œæœ›å­ç±»å‹ä¸è¦å®ç°æˆä¸€ä¸ª raw typeã€‚</li>
</ol>
<p>ä¿è¯äº†è¿™ä¸¤å¤©<code>_type</code>ä¸€å®šæ˜¯ä¸€ä¸ª concret classã€‚</p>
<h2 id="æ³›å‹çš„é‡è½½é™åˆ¶">æ³›å‹çš„é‡è½½é™åˆ¶</h2>
<p>ç”±äºç±»å‹æ“¦é™¤ï¼Œä»¥ä¸‹é‡è½½åœ¨ Java ä¸­æ˜¯éæ³•çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼šä¸¤ä¸ªæ–¹æ³•æ“¦é™¤åç­¾åç›¸åŒ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OverloadExample</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">process</span><span class="hljs-params">(List&lt;String&gt; strings)</span> &#123; &#125;<br>    <span class="hljs-comment">// public void process(List&lt;Integer&gt; integers) &#123; &#125; // æ“¦é™¤åéƒ½æ˜¯ process(List)</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ“¦é™¤å <code>List&lt;String&gt;</code> å’Œ <code>List&lt;Integer&gt;</code> éƒ½å˜ä¸º <code>List</code>ï¼Œå¯¼è‡´æ–¹æ³•ç­¾åå†²çªã€‚è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li><strong>ä½¿ç”¨ä¸åŒçš„æ–¹æ³•å</strong>ï¼š<code>processStrings(List&lt;String&gt;)</code> å’Œ <code>processIntegers(List&lt;Integer&gt;)</code></li>
<li><strong>ä½¿ç”¨é€šé…ç¬¦ç»Ÿä¸€</strong>ï¼š<code>process(List&lt;? extends CharSequence&gt;)</code></li>
<li><strong>æ·»åŠ é¢å¤–å‚æ•°åŒºåˆ†</strong>ï¼šåˆ©ç”¨å¹½çµç±»å‹å‚æ•°ï¼ˆå‚è§æœ¬æ–‡&quot;å¹½çµç±»å‹&quot;ç« èŠ‚ï¼‰</li>
</ol>
<h1>å„ç§æ³›å‹é»‘é­”æ³•</h1>
<h2 id="ç±»ä¼¼å¹½çµç±»å‹çš„æ¨¡å¼åŒ¹é…">ç±»ä¼¼å¹½çµç±»å‹çš„æ¨¡å¼åŒ¹é…</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> &#123;&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">X</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">(List&lt;A&gt; ls, A... dummy)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;call A&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">(List&lt;B&gt; ls, B... dummy)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;call B&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">var</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">X</span>();<br>        x.call(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;A&gt;());<br>        x.call(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;B&gt;());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="è·å–é€šé…ç¬¦çš„-bound">è·å–é€šé…ç¬¦çš„ bound</h2>
<p>æ­¤å¤„å¹¶éåœ¨ä»£ç ä¸­ä½¿ç”¨é€šé…ç¬¦ï¼Œè€Œæ˜¯ç¡®åˆ‡çŸ¥é“?çš„ bound æ˜¯ä»€ä¹ˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.ParameterizedType;<br><span class="hljs-keyword">import</span> java.lang.reflect.Type;<br><span class="hljs-keyword">import</span> java.lang.reflect.WildcardType;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<br><span class="hljs-keyword">import</span> org.junit.jupiter.api.Assertions;<br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestClass</span> &#123;<br>    <br>    <span class="hljs-comment">// ä»»ä½•ç›¸å…³çš„é—®é¢˜éƒ½å¯ä»¥å†™ä¸€ä¸ªæˆå‘˜ç±»æ¥ç›´æ¥é€šè¿‡åå°„æ¥å®éªŒ</span><br>    <span class="hljs-keyword">private</span> List&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Number</span>&gt; listNum;<br>   <br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetWildCardType</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> NoSuchFieldException &#123;<br>    <br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Field</span> <span class="hljs-variable">fieldNum</span> <span class="hljs-operator">=</span> TestClass.class.getDeclaredField(<span class="hljs-string">&quot;listNum&quot;</span>);<br>        <span class="hljs-comment">// genericTypeå‡ ä¹å¿…ç„¶æ˜¯ ParameterizedTypeImpl çš„å®ä¾‹</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Type</span> <span class="hljs-variable">genericType</span> <span class="hljs-operator">=</span> fieldNum.getGenericType();<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">ParameterizedType</span> <span class="hljs-variable">parameterizedType</span> <span class="hljs-operator">=</span> (ParameterizedType) genericType;<br>        <span class="hljs-keyword">final</span> Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();<br>        <span class="hljs-keyword">for</span> (Type actualTypeArgument : actualTypeArguments) &#123;<br>            <span class="hljs-comment">// wildCard éšè—åœ¨ actualTypeArguments é‡Œ</span><br>            <span class="hljs-keyword">if</span> (actualTypeArgument <span class="hljs-keyword">instanceof</span> WildcardType) &#123;<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">WildcardType</span> <span class="hljs-variable">wildcardType</span> <span class="hljs-operator">=</span> (WildcardType) actualTypeArgument;<br>                <span class="hljs-keyword">final</span> Type[] lowerBounds = wildcardType.getLowerBounds();<br>                <span class="hljs-comment">// æ‰€æœ‰çš„ bound éƒ½æ˜¯ class</span><br>                log.info(Arrays.toString(lowerBounds));<br>                <span class="hljs-keyword">final</span> Type[] upperBounds = wildcardType.getUpperBounds();<br>                log.info(Arrays.toString(upperBounds));<br>            &#125;<br>        &#125;<br><br>        Assertions.assertTrue(<span class="hljs-literal">true</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="optional-é‡Œé€šé…ç¬¦è½¬æˆç±»å‹å‚æ•°">Optional é‡Œé€šé…ç¬¦è½¬æˆç±»å‹å‚æ•°</h2>
<p>å¯è§<code>@SuppressWarnings(&quot;unchecked&quot;)</code> java çš„åŸºç¡€åº“é‡Œåˆ°å¤„éƒ½æ˜¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Optional;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OptionalExample</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Common instance for &#123;<span class="hljs-doctag">@code</span> empty()&#125;.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Optional&lt;?&gt; EMPTY = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Optional</span>&lt;&gt;();<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Optional&lt;T&gt; <span class="hljs-title function_">empty</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>        Optional&lt;T&gt; t = (Optional&lt;T&gt;) EMPTY;<br>        <span class="hljs-keyword">return</span> t;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="ç¡®è®¤æ¶ˆè´¹ç±»å‹çš„ä¸¤ç§æ–¹æ³•">ç¡®è®¤æ¶ˆè´¹ç±»å‹çš„ä¸¤ç§æ–¹æ³•</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.ParameterizedType;<br><span class="hljs-keyword">import</span> java.lang.reflect.Type;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericUtils</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * éªŒè¯ä¸€ä¸ªç±»å‹æ˜¯ä¸æ˜¯å¦ä¸€ä¸ªç±»å‹çš„å‚æ•°åŒ–å­ç±»</span><br><span class="hljs-comment">     * &lt;p&gt;</span><br><span class="hljs-comment">     * A implements B&lt;C&gt;</span><br><span class="hljs-comment">     * åˆ™ isGenericSubClass(A.class, B.class, C.class) ä¸º true</span><br><span class="hljs-comment">     * æ³¨æ„ï¼Œå¦‚æœå­˜åœ¨ D extends Cï¼ŒC extends F</span><br><span class="hljs-comment">     * D ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°è¿”å› trueï¼Œè€Œ F è¿”å› false</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> subClass                     å­ç±»å‹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> genericSuperClass            è¶…ç±»å‹ï¼Œå¯ä»¥æ˜¯æ¥å£</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> targetGenericActualParameter ç±»å‹å®å‚</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è®¤å®šç»“æœ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isGenericSubClass</span><span class="hljs-params">(Class&lt;?&gt; subClass, Class&lt;?&gt; genericSuperClass, Class&lt;?&gt; targetGenericActualParameter)</span> &#123;<br><br>        <span class="hljs-keyword">if</span> (!genericSuperClass.isAssignableFrom(subClass)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Type</span> <span class="hljs-variable">genericSuperclass</span> <span class="hljs-operator">=</span> subClass.getGenericSuperclass();<br><br>        <span class="hljs-keyword">if</span> (genericSuperclass <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">ParameterizedType</span> <span class="hljs-variable">parameterizedType</span> <span class="hljs-operator">=</span> (ParameterizedType) genericSuperclass;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Type</span> <span class="hljs-variable">rawType</span> <span class="hljs-operator">=</span> parameterizedType.getRawType();<br>            <span class="hljs-comment">// è¿™é‡Œå¯ä»¥ç¡®è®¤ Collection æ˜¯ä¸æ˜¯ Collection-è€Œä¸æ˜¯ List</span><br>            <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">rawTypeMatch</span> <span class="hljs-operator">=</span> rawType == genericSuperClass;<br>            <span class="hljs-keyword">final</span> Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();<br>            <span class="hljs-comment">// è¿™ä¸¤è¡Œå¾ˆé‡è¦ï¼Œç±»å‹å®å‚çš„è·å–ä¸»è¦ä¾èµ–æ­¤æ–¹æ³•ï¼Œä½†è·å–åˆ°çš„ç±»å‹ä»…é™äº Class å®ä¾‹</span><br>            <span class="hljs-keyword">for</span> (Type type : actualTypeArguments) &#123;<br>                <span class="hljs-keyword">if</span> (type <span class="hljs-keyword">instanceof</span> Class) &#123;<br>                    <span class="hljs-keyword">if</span> (rawTypeMatch &amp;&amp; ((Class&lt;?&gt;) type).isAssignableFrom(targetGenericActualParameter)) &#123;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">final</span> Type[] genericInterfaceTypes = subClass.getGenericInterfaces();<br>        <span class="hljs-keyword">for</span> (Type genericInterfaceType : genericInterfaceTypes) &#123;<br>            <span class="hljs-keyword">if</span> (genericInterfaceType <span class="hljs-keyword">instanceof</span> ParameterizedType) &#123;<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">ParameterizedType</span> <span class="hljs-variable">parameterizedType</span> <span class="hljs-operator">=</span> (ParameterizedType) genericInterfaceType;<br>                <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">rawTypeMatch</span> <span class="hljs-operator">=</span> parameterizedType.getRawType() == genericSuperClass;<br>                <span class="hljs-keyword">final</span> Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();<br>                <span class="hljs-comment">// è¿™ä¸¤è¡Œå¾ˆé‡è¦ï¼Œç±»å‹å®å‚çš„è·å–ä¸»è¦ä¾èµ–æ­¤æ–¹æ³•ï¼Œä½†è·å–åˆ°çš„ç±»å‹ä»…é™äº Class å®ä¾‹</span><br>                <span class="hljs-keyword">for</span> (Type type : actualTypeArguments) &#123;<br>                    <span class="hljs-keyword">if</span> (type <span class="hljs-keyword">instanceof</span> Class) &#123;<br>                        <span class="hljs-keyword">if</span> (rawTypeMatch &amp;&amp; ((Class&lt;?&gt;) type).isAssignableFrom(targetGenericActualParameter)) &#123;<br>                            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * isGenericSubClass çš„ Spring ç‰ˆæœ¬ï¼Œåªèƒ½éªŒè¯ç¬¬ä¸€ä¸ª TypeParameterï¼ŒéªŒè¯ç¬¬äºŒä¸ªå‚æ•°å¿…ç„¶è¿”å› false</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> subClass                     å­ç±»å‹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> genericSuperClass            è¶…ç±»å‹ï¼Œå¯ä»¥æ˜¯æ¥å£</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> targetGenericActualParameter ç±»å‹å®å‚</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è®¤å®šç»“æœ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isParameterized</span><span class="hljs-params">(Class&lt;?&gt; subClass, Class&lt;?&gt; genericSuperClass, Class&lt;?&gt; targetGenericActualParameter)</span> &#123;<br>        <span class="hljs-comment">// éœ€è¦å¼•å…¥ Spring çš„ ResolvableType</span><br>        <span class="hljs-comment">// final ResolvableType generic = ResolvableType.forClass(subClass).as(genericSuperClass).getGeneric();</span><br>        <span class="hljs-comment">// return generic.isAssignableFrom(ResolvableType.forClass(targetGenericActualParameter));</span><br>        <span class="hljs-comment">// æ­¤å¤„ä»…ä¸ºç¤ºä¾‹ï¼Œå®é™…ä½¿ç”¨éœ€è¦ Spring ä¾èµ–</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<pre><code>}
</code></pre>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><br>## ç©ºæ³›å‹æ•°ç»„çš„æ‹·è´æ–¹æ³•<br><br>```java<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> ArrayCollection&lt;E&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> E[] a;<br>    <br>    <span class="hljs-keyword">public</span> ArrayCollection(E[] array) &#123;<br>        <span class="hljs-keyword">this</span>.a = array;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-keyword">size</span>() &#123;<br>        <span class="hljs-keyword">return</span> a.length;<br>    &#125;<br>    <br>    @Override<br>    @SuppressWarnings(<span class="hljs-string">&quot;unchecked&quot;</span>)<br>    <span class="hljs-keyword">public</span> &lt;T&gt; T[] toArray(T[] a) &#123;<br>        <span class="hljs-keyword">int</span> <span class="hljs-keyword">size</span> = <span class="hljs-keyword">size</span>();<br>        <span class="hljs-keyword">if</span> (a.length &lt; <span class="hljs-keyword">size</span>)<br>            <span class="hljs-keyword">return</span> Arrays.copyOf(<span class="hljs-keyword">this</span>.a, <span class="hljs-keyword">size</span>,<br>                                 (<span class="hljs-keyword">Class</span>&lt;? <span class="hljs-keyword">extends</span> T[]&gt;) a.getClass());<br>        System.arraycopy(<span class="hljs-keyword">this</span>.a, <span class="hljs-number">0</span>, a, <span class="hljs-number">0</span>, <span class="hljs-keyword">size</span>);<br>        <span class="hljs-keyword">if</span> (a.length &gt; <span class="hljs-keyword">size</span>)<br>            a[<span class="hljs-keyword">size</span>] = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•çš„ç‰¹ç‚¹ï¼š</p>
<ol>
<li>è‡ªåŠ¨è°ƒæ•´æ•°ç»„å¤§å°ã€‚</li>
<li>å¯ä»¥åƒ go ä¸€æ ·å¾€å‚æ•°å¡«å……æ•°æ®ã€‚</li>
<li>ç±»å‹å®‰å…¨ï¼š<code>String[] rightWay = list.toArray(new String[0]);</code>ä¼˜äº<code>String[] wrongWay = (String[]) list.toArray();</code>ã€‚</li>
</ol>
<h2 id="æ³›å‹åœ¨-lambda-ä¸-stream-ä¸­çš„ç±»å‹æ¨æ–­">æ³›å‹åœ¨ Lambda ä¸ Stream ä¸­çš„ç±»å‹æ¨æ–­</h2>
<p>Java 8 å¼•å…¥çš„ Lambda è¡¨è¾¾å¼å’Œ Stream API å¤§é‡ä¾èµ–æ³›å‹ç±»å‹æ¨æ–­ã€‚ç¼–è¯‘å™¨é€šè¿‡ç›®æ ‡ç±»å‹æ¨æ–­ï¼ˆTarget Type Inferenceï¼‰ç¡®å®š Lambda è¡¨è¾¾å¼çš„ç±»å‹å‚æ•°ã€‚</p>
<h3 id="ç›®æ ‡ç±»å‹æ¨æ–­">ç›®æ ‡ç±»å‹æ¨æ–­</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.function.Function;<br><span class="hljs-keyword">import</span> java.util.function.Predicate;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TargetTypeInference</span> &#123;<br>    <span class="hljs-comment">// ç¼–è¯‘å™¨ä»èµ‹å€¼ç›®æ ‡æ¨æ–­ T=String, R=Integer</span><br>    Function&lt;String, Integer&gt; lengthFunction = s -&gt; s.length();<br><br>    <span class="hljs-comment">// ç¼–è¯‘å™¨ä»æ–¹æ³•å‚æ•°ç±»å‹æ¨æ–­ T=String</span><br>    Predicate&lt;String&gt; nonEmpty = s -&gt; !s.isEmpty();<br><br>    <span class="hljs-comment">// æ–¹æ³•å¼•ç”¨åŒæ ·ä¾èµ–ç›®æ ‡ç±»å‹æ¨æ–­</span><br>    Function&lt;String, Integer&gt; parseFunction = Integer::parseInt;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="stream-é“¾å¼è°ƒç”¨ä¸­çš„ç±»å‹ä¼ æ’­">Stream é“¾å¼è°ƒç”¨ä¸­çš„ç±»å‹ä¼ æ’­</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamTypeInference</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        List&lt;String&gt; names = List.of(<span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-string">&quot;Charlie&quot;</span>);<br><br>        <span class="hljs-comment">// ç±»å‹å‚æ•°æ²¿ Stream ç®¡é“é€æ­¥æ¨æ–­</span><br>        <span class="hljs-comment">// Stream&lt;String&gt; â†’ Stream&lt;Integer&gt; â†’ List&lt;Integer&gt;</span><br>        List&lt;Integer&gt; lengths = names.stream()<br>                .map(String::length)      <span class="hljs-comment">// æ¨æ–­ Function&lt;String, Integer&gt;</span><br>                .filter(length -&gt; length &gt; <span class="hljs-number">3</span>) <span class="hljs-comment">// æ¨æ–­ Predicate&lt;Integer&gt;</span><br>                .collect(Collectors.toList());<br><br>        <span class="hljs-comment">// å¤æ‚çš„ç±»å‹æ¨æ–­ï¼šåˆ†ç»„æ“ä½œ</span><br>        <span class="hljs-comment">// æ¨æ–­ Collector&lt;String, ?, Map&lt;Integer, List&lt;String&gt;&gt;&gt;</span><br>        Map&lt;Integer, List&lt;String&gt;&gt; groupedByLength = names.stream()<br>                .collect(Collectors.groupingBy(String::length));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å½“ç±»å‹æ¨æ–­å¤±è´¥æ—¶,å¯ä»¥é€šè¿‡ç±»å‹è§è¯ï¼ˆType Witnessï¼‰æ˜¾å¼æŒ‡å®šï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TypeWitnessExample</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">// ç¼–è¯‘å™¨æ— æ³•æ¨æ–­ç©ºé›†åˆçš„ç±»å‹å‚æ•°</span><br>        <span class="hljs-comment">// List&lt;String&gt; list = Collections.emptyList(); // åœ¨æŸäº›ä¸Šä¸‹æ–‡ä¸­å¯èƒ½å¤±è´¥</span><br>        List&lt;String&gt; list = Collections.&lt;String&gt;emptyList(); <span class="hljs-comment">// ç±»å‹è§è¯</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ğŸ”‘ <strong>æ¨¡å¼æç‚¼ï¼šç›®æ ‡ç±»å‹é©±åŠ¨</strong></p>
<p>Lambda å’Œ Stream çš„ç±»å‹æ¨æ–­éµå¾ª&quot;ç›®æ ‡ç±»å‹é©±åŠ¨&quot;åŸåˆ™ï¼šç¼–è¯‘å™¨ä»è¡¨è¾¾å¼çš„ä½¿ç”¨ä¸Šä¸‹æ–‡ï¼ˆèµ‹å€¼ç›®æ ‡ã€æ–¹æ³•å‚æ•°ã€è¿”å›ç±»å‹ï¼‰åå‘æ¨æ–­ç±»å‹å‚æ•°ã€‚å½“æ¨æ–­å¤±è´¥æ—¶ï¼Œä½¿ç”¨ç±»å‹è§è¯ <code>ClassName.&lt;Type&gt;method()</code> æ˜¾å¼æŒ‡å®šã€‚</p>
<h2 id="æ³›å‹ä¸æ³¨è§£-type-annotations">æ³›å‹ä¸æ³¨è§£ï¼ˆType Annotationsï¼‰</h2>
<p>Java 8ï¼ˆJSR 308ï¼‰å¼•å…¥äº†ç±»å‹æ³¨è§£ï¼Œå…è®¸åœ¨ä»»ä½•ä½¿ç”¨ç±»å‹çš„ä½ç½®æ·»åŠ æ³¨è§£ï¼ŒåŒ…æ‹¬æ³›å‹ç±»å‹å‚æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.annotation.ElementType;<br><span class="hljs-keyword">import</span> java.lang.annotation.Target;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@Target(ElementType.TYPE_USE)</span><br><span class="hljs-meta">@interface</span> NonNull &#123;&#125;<br><br><span class="hljs-meta">@Target(ElementType.TYPE_USE)</span><br><span class="hljs-meta">@interface</span> Nullable &#123;&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TypeAnnotationExample</span> &#123;<br>    <span class="hljs-comment">// æ³¨è§£æ³›å‹ç±»å‹å‚æ•°</span><br>    <span class="hljs-keyword">private</span> List&lt;<span class="hljs-meta">@NonNull</span> String&gt; names;<br><br>    <span class="hljs-comment">// æ³¨è§£åµŒå¥—æ³›å‹</span><br>    <span class="hljs-keyword">private</span> Map&lt;<span class="hljs-meta">@NonNull</span> String, <span class="hljs-meta">@Nullable</span> List&lt;<span class="hljs-meta">@NonNull</span> Integer&gt;&gt; data;<br><br>    <span class="hljs-comment">// æ³¨è§£é€šé…ç¬¦è¾¹ç•Œ</span><br>    <span class="hljs-keyword">private</span> List&lt;<span class="hljs-meta">@NonNull</span> ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Number</span>&gt; numbers;<br><br>    <span class="hljs-comment">// æ³¨è§£æ•°ç»„</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-meta">@NonNull</span> String <span class="hljs-meta">@Nullable</span> [] array;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç±»å‹æ³¨è§£ä¸ Checker Framework ç­‰é™æ€åˆ†æå·¥å…·é…åˆï¼Œå¯ä»¥åœ¨ç¼–è¯‘æœŸæ£€æµ‹ç©ºæŒ‡é’ˆã€çº¿ç¨‹å®‰å…¨ç­‰é—®é¢˜ï¼Œå°†è¿è¡Œæ—¶é”™è¯¯æå‰åˆ°ç¼–è¯‘æœŸã€‚</p>
<h2 id="æ³›å‹æœ€ä½³å®è·µ">æ³›å‹æœ€ä½³å®è·µ</h2>
<h3 id="é¿å…åŸå§‹ç±»å‹">é¿å…åŸå§‹ç±»å‹</h3>
<p>åŸå§‹ç±»å‹ï¼ˆRaw Typesï¼‰ç»•è¿‡äº†æ³›å‹çš„ç±»å‹æ£€æŸ¥ï¼Œåº”å§‹ç»ˆä½¿ç”¨å‚æ•°åŒ–ç±»å‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RawTypeExample</span> &#123;<br>    <span class="hljs-comment">// é”™è¯¯ï¼šä½¿ç”¨åŸå§‹ç±»å‹</span><br>    <span class="hljs-comment">// List list = new ArrayList();</span><br>    <span class="hljs-comment">// list.add(&quot;string&quot;);</span><br>    <span class="hljs-comment">// list.add(42); // ç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶å¯èƒ½ ClassCastException</span><br><br>    <span class="hljs-comment">// æ­£ç¡®ï¼šä½¿ç”¨å‚æ•°åŒ–ç±»å‹</span><br>    List&lt;String&gt; typedList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-comment">// typedList.add(42); // ç¼–è¯‘é”™è¯¯ï¼Œç±»å‹å®‰å…¨</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="ä¼˜å…ˆä½¿ç”¨-list-è€Œéæ•°ç»„">ä¼˜å…ˆä½¿ç”¨ List è€Œéæ•°ç»„</h3>
<p>æ³›å‹ä¸æ•°ç»„å­˜åœ¨æ ¹æœ¬çŸ›ç›¾ï¼ˆå‚è§&quot;æ³›å‹ä¸æ•°ç»„&quot;ç« èŠ‚ï¼‰ï¼Œåœ¨æ³›å‹ä¸Šä¸‹æ–‡ä¸­åº”ä¼˜å…ˆä½¿ç”¨é›†åˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PreferListOverArray</span> &#123;<br>    <span class="hljs-comment">// ä¸æ¨èï¼šæ³›å‹æ•°ç»„</span><br>    <span class="hljs-comment">// T[] items = new T[10]; // ç¼–è¯‘é”™è¯¯</span><br><br>    <span class="hljs-comment">// æ¨èï¼šä½¿ç”¨ List</span><br>    <span class="hljs-comment">// List&lt;T&gt; items = new ArrayList&lt;&gt;();</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="pecs-åŸåˆ™çš„å®è·µ">PECS åŸåˆ™çš„å®è·µ</h3>
<p>åœ¨è®¾è®¡ API æ—¶ï¼Œéµå¾ª Producer Extends, Consumer Super åŸåˆ™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Collection;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PecsExample</span> &#123;<br>    <span class="hljs-comment">// source æ˜¯ç”Ÿäº§è€…ï¼ˆè¯»å–æ•°æ®ï¼‰ï¼Œä½¿ç”¨ extends</span><br>    <span class="hljs-comment">// destination æ˜¯æ¶ˆè´¹è€…ï¼ˆå†™å…¥æ•°æ®ï¼‰ï¼Œä½¿ç”¨ super</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">copy</span><span class="hljs-params">(List&lt;? extends T&gt; source, List&lt;? <span class="hljs-built_in">super</span> T&gt; destination)</span> &#123;<br>        <span class="hljs-keyword">for</span> (T item : source) &#123;<br>            destination.add(item);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="æ¨¡å¼é€ŸæŸ¥è¡¨">æ¨¡å¼é€ŸæŸ¥è¡¨</h3>
<table>
<thead>
<tr>
<th>åœºæ™¯å…³é”®è¯</th>
<th>å¯¹åº”æ¨¡å¼</th>
<th>æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç±»å‹æ“¦é™¤åæ–¹æ³•ç­¾åå†²çª</td>
<td>æ“¦é™¤æ¡¥æ¥</td>
<td>ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆæ¡¥æ–¹æ³•ï¼Œåå°„æ—¶ç”¨ <code>Method.isBridge()</code> è¿‡æ»¤</td>
</tr>
<tr>
<td>éœ€è¦æ³›å‹æ•°ç»„</td>
<td>å…·åŒ–ä¸æ“¦é™¤çš„å†²çª</td>
<td>ä½¿ç”¨ <code>Array.newInstance()</code> æˆ– <code>List&lt;T&gt;</code> æ›¿ä»£</td>
</tr>
<tr>
<td>åŸºç±»æ–¹æ³•è¿”å›å­ç±»å‹</td>
<td>ç±»å‹è‡ªçº¦æŸ</td>
<td><code>&lt;T extends Base&lt;T&gt;&gt;</code> è‡ªé™å®šæ¨¡å¼</td>
</tr>
<tr>
<td>è¿è¡Œæ—¶è·å–æ³›å‹ç±»å‹</td>
<td>ç±»å‹ä»¤ç‰Œ</td>
<td><code>TypeToken</code> / <code>TypeReference</code> åŒ¿åå­ç±»æ•è·</td>
</tr>
<tr>
<td>Lambda ç±»å‹æ¨æ–­å¤±è´¥</td>
<td>ç›®æ ‡ç±»å‹é©±åŠ¨</td>
<td>ç±»å‹è§è¯ <code>ClassName.&lt;Type&gt;method()</code></td>
</tr>
<tr>
<td>æ³›å‹æ–¹æ³•ä¸èƒ½é‡è½½</td>
<td>æ“¦é™¤ç­¾åå†²çª</td>
<td>ä½¿ç”¨ä¸åŒæ–¹æ³•åæˆ–é€šé…ç¬¦ç»Ÿä¸€</td>
</tr>
<tr>
<td>è¯»å–ç”¨ extendsï¼Œå†™å…¥ç”¨ super</td>
<td>PECS</td>
<td><code>&lt;? extends T&gt;</code> ç”Ÿäº§è€…ï¼Œ<code>&lt;? super T&gt;</code> æ¶ˆè´¹è€…</td>
</tr>
<tr>
<td>ç¼–è¯‘æœŸç©ºå€¼æ£€æŸ¥</td>
<td>ç±»å‹æ³¨è§£</td>
<td><code>@NonNull</code> + Checker Framework</td>
</tr>
</tbody>
</table>
<h1>å…¶ä»–èµ„æ–™</h1>
<p><a target="_blank" rel="noopener" href="http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html#FAQ005">angelikalanger çš„ JavaGenericsFAQ</a>ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://magicliang.github.io">magicliang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://magicliang.github.io/2020/02/23/%E6%B3%9B%E5%9E%8B%E6%8B%BE%E9%81%97/">https://magicliang.github.io/2020/02/23/%E6%B3%9B%E5%9E%8B%E6%8B%BE%E9%81%97/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post-share"><div class="social-share" data-image="/img/wall-paper-46.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2017/10/23/%E6%98%82%E8%B4%B5%E7%9A%84%E5%BC%82%E5%B8%B8/" title="æ˜‚è´µçš„å¼‚å¸¸"><img class="cover" src="/img/wall-paper-173.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-10-23</div><div class="info-item-2">æ˜‚è´µçš„å¼‚å¸¸</div></div><div class="info-2"><div class="info-item-1">æŠ›å‡ºé—®é¢˜ Joshua Bloch åœ¨ã€ŠEffective Javaã€‹çš„ Item 57 é‡Œæ˜ç¡®åœ°æåˆ°è¿‡ï¼Œä¸è¦è¯•å›¾ç”¨ Exception çš„è·³è½¬æ¥ä»£æ›¿æ­£å¸¸çš„ç¨‹åºæ§åˆ¶æµã€‚ä»–åˆ—ä¸¾äº†å¾ˆå¤šåŸå› ï¼Œä½†ç‰¹åˆ«æåˆ°äº†æŠ›å‡ºå¼‚å¸¸ä¼šä½¿å¾—æ•´ä¸ªç¨‹åºè¿è¡Œå˜æ…¢ã€‚æŠ›å‡ºå¼‚å¸¸è¿œæ¯”æ™®é€šçš„ returnã€break ç­‰æ“ä½œå¯¹æ§åˆ¶æµã€æ•°æ®æµçš„æ€§èƒ½å½±å“è¦å¤§ï¼Œå®ƒå°±åªé€‚åˆæ‹¿æ¥ä½œå¼‚å¸¸åˆ†æ”¯çš„æ§åˆ¶è¯­å¥ï¼Œè€Œä¸èƒ½æ‹¿æ¥ç¼–å†™æ­£å¸¸çš„é€»è¾‘ã€‚  Throwing exception is expensive.  è¿™å¥è¯åœ¨ Java çš„ç¨‹åºå‘˜ä¸–ç•Œé‡Œé¢å·²ç»æˆä¸ºè€ç”Ÿå¸¸è°ˆï¼Œå´å¾ˆå°‘æœ‰äººè°ˆåŠåˆ°åº•æŠ›å‡ºå¼‚å¸¸æ¯”æ­£å¸¸çš„ç¨‹åºè·³è½¬è¿”å›æ…¢åœ¨å“ªé‡Œï¼Œæœ‰å¤šæ…¢ã€‚&quot;ä¸è¦æ»¥ç”¨å¼‚å¸¸&quot;å¥½åƒä¸€ä¸ªçŒ´å­å®šå¾‹ï¼Œäººä»¬çŸ¥é“ä¸èƒ½è¿™ä¹ˆåšï¼Œå´ä¸æ˜ç™½ä¸ºä»€ä¹ˆä¸èƒ½è¿™ä¹ˆåšã€‚ æ­¤å‰è¯»äº†ä¸€ä½åŒäº‹å†™çš„å¥½æ–‡ã€ŠJavaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ã€‹ï¼Œæ·±å…¥åœ°åˆ†æäº† JVM å¯¹å¼‚å¸¸è·³è½¬çš„å¤„ç†è¿‡ç¨‹ï¼šJVM ä¼šé€šè¿‡å¼‚å¸¸è¡¨çš„æœºåˆ¶ï¼Œä¼˜åŒ–å¼‚å¸¸æŠ›å‡ºå’Œæ­£å¸¸è¿”å›ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ã€‚ä»…ä»ç¨‹åºè®¡æ•°å™¨çš„ç§»åŠ¨ä¸Šæ¥è®²ï¼ŒæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¯¹æ ˆå¸§çš„å¼¹æ ˆå¹¶ä¸æ¯”ç›´æ¥è¿”å›æ›´æ˜‚è´µã€‚å†™åœ¨å‰å¤´çš„ç»“è®ºæ˜¯ï¼š&quot;try-catch è¯­å¥å—å‡ ä¹ä¸ä¼šå½±å“ç¨‹åºè¿è¡Œæ€§èƒ½ï¼...</div></div></div></a><a class="pagination-related" href="/2017/11/30/Java%E4%B8%AD%E7%9A%84%E5%B9%BD%E7%81%B5%E7%B1%BB%E5%9E%8B/" title="Javaä¸­çš„å¹½çµç±»å‹"><img class="cover" src="/img/wall-paper-144.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-11-30</div><div class="info-item-2">Javaä¸­çš„å¹½çµç±»å‹</div></div><div class="info-2"><div class="info-item-1">ä»€ä¹ˆæ˜¯å¹½çµç±»å‹ å…ˆä¸Šç»“è®ºï¼šå¹½çµç±»å‹ï¼ˆPhantom Typeï¼‰é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¹½çµèˆ¬çš„ç±»å‹ï¼Œè¿™ç§ç±»å‹å¾€å¾€åœ¨è¿è¡Œæ—¶å¯ä»¥æ¶ˆå¤±ï¼Œå› ä¸ºåœ¨è¿è¡Œæ—¶æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œå®ƒä»¬æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æ²¡æœ‰ä»»ä½•å®ä¾‹ï¼ˆJava çš„ Void å°±æ˜¯ä¸€ä¸ªä¸å¯å®ä¾‹åŒ–ç±»å‹çš„ä¾‹å­ï¼Œå¸¸è¢«ç”¨ä½œå¹½çµç±»å‹çš„ç±»å‹å‚æ•°ï¼Œå¦‚ Future&lt;Void&gt;ï¼‰ã€‚å¹½çµç±»å‹æ˜¯ä¸€ç§å¯ä»¥æŠŠæœ‰äº›è¿è¡Œæ—¶æ‰èƒ½æ£€æµ‹åˆ°çš„é”™è¯¯ï¼Œåœ¨ç¼–è¯‘æ—¶æ£€æµ‹å‡ºæ¥çš„æŠ€å·§ã€‚æŒ‰ç…§æœ‰äº›è€å¤–çš„è§‚ç‚¹ï¼Œå°±æ˜¯&quot;Making Wrong Code Look Wrong&quot;ã€‚åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸­ï¼Œå¹½çµç±»å‹çš„å®ç°ï¼Œå¾€å¾€ä¸çŠ¶æ€æ¨¡å¼è¾ƒä¸ºæ¥è¿‘ï¼Œä½†æ¯”çŠ¶æ€æ¨¡å¼æä¾›äº†æ›´å¼ºçš„çº é”™åŠŸèƒ½ã€‚åœ¨ Java 5 ä»¥åçš„ç‰ˆæœ¬é‡Œï¼Œç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨æ³›å‹ã€‚é€šè¿‡æ³›å‹çš„ç±»å‹å‚æ•°ï¼ŒJava ä¸­ä¹Ÿæ‹¥æœ‰äº†å¹½çµç±»å‹çš„èƒ½åŠ›ã€‚ ä¸Šé¢çš„é˜è¿°æ˜¯ä¸æ˜¯å¾ˆéš¾çœ‹æ‡‚ï¼Ÿç›´æ¥è¿›å…¥å…·ä½“çš„ä¾‹å­ã€‚å‡è®¾æœ‰ä¸€ä¸ªé£æœºæ§åˆ¶ç¨‹åºï¼Œæ“ä½œé£æœºèµ·é£æˆ–è€…è½åœ°ã€‚è¿™ä¸ªç¨‹åºæœ‰ä¸€ä¸ªéå¸¸å¼ºçš„ä¸šåŠ¡çº¦æŸï¼Œå°±æ˜¯å¿…é¡»ä¿è¯é£æœºä¸€å¼€å§‹å¿…é¡»å‡ºç°åœ¨åœ°ä¸Šï¼Œåªæœ‰åœ¨åœ°ä¸Šçš„é£æœºå¯ä»¥èµ·é£ï¼Œåªæœ‰èµ·é£çš„é£æœºå¯ä»¥è½åœ°ï¼Œé‚£ä¹ˆåº”è¯¥æ€æ ·è®¾è®¡ç¨‹åºï¼ˆä¸»è¦æ˜¯ç±»å‹å…³ç³»ï¼‰ï¼Œæ¥ä¿è¯è¿™ä¸ªçº¦æŸå¿…ç„¶æˆç«‹å‘¢ï¼Ÿ å®šä¹‰çŠ¶æ€æ¥å£ å…ˆæ¥å®šä¹‰...</div></div></div></a><a class="pagination-related" href="/2018/05/29/JPA-%E7%9A%84-id-%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5/" title="JPA çš„ id ç”Ÿæˆç­–ç•¥"><img class="cover" src="/img/wall-paper-65.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-05-29</div><div class="info-item-2">JPA çš„ id ç”Ÿæˆç­–ç•¥</div></div><div class="info-2"><div class="info-item-1">JPA æœ‰ä¸€ä¸ª@GeneratedValueæ³¨è§£ï¼Œæœ‰ä¸€ä¸ªstrategy attributeï¼Œå¦‚ @GeneratedValue(strategy = GenerationType.IDENTITY)ã€‚ å¸¸è§çš„å¯é€‰ç­–ç•¥ä¸»è¦æœ‰IDENTITYå’ŒSEQUENCEã€‚ GenerationType.IDENTITY è¦æ±‚åº•å±‚æœ‰ä¸€ä¸ª integer æˆ–è€… bigint ç±»å‹çš„è‡ªå¢åˆ—ï¼ˆ auto-incremented column)ã€‚è‡ªå¢åˆ—çš„èµ‹å€¼å¿…é¡»åœ¨æ’å…¥æ“ä½œä¹‹åå‘ç”Ÿï¼Œå› ä¸ºè¿™ä¸ªåŸå› ï¼ŒHibernate æ— æ³•è¿›è¡Œå„ç§ä¼˜åŒ–ï¼ˆç‰¹åˆ«æ˜¯ JDBC çš„ batch å¤„ç†ï¼Œä¸€æ¬¡ flush æ“ä½œä¼šäº§ç”Ÿå¾ˆå¤šæ¡insert è¯­å¥ï¼Œåˆ†åˆ«æ‰§è¡Œï¼‰ã€‚å¦‚æœäº‹åŠ¡å›æ»šï¼Œè‡ªå¢åˆ—çš„å€¼å°±ä¼šè¢«ä¸¢å¼ƒã€‚æ•°æ®åº“åœ¨è¿™ä¸ªè‡ªå¢æ“ä½œä¸Šæœ‰ä¸ªé«˜åº¦ä¼˜åŒ–çš„è½»é‡çº§é”æœºåˆ¶ï¼Œæ€§èƒ½éå¸¸æ£’ã€‚ MySQL æ”¯æŒè¿™ç§ id ç”Ÿæˆç­–ç•¥ï¼Œ ä½¿ç”¨ MySQL åº”è¯¥å°½é‡ä½¿ç”¨è¿™ä¸ªç­–ç•¥ï¼Œå³ä½¿å®ƒæ— æ³•ä¼˜åŒ–ã€‚ JPA ç”¨å®ƒç”Ÿæˆ idï¼Œä¼šä¸€æ¡ä¸€æ¡åœ°æ’å…¥æ–°çš„ entityã€‚ GenerationType.SEQUENCE æ•°æ®åº“æœ‰ä¸€ä¸ªæ‰€è°“çš„ sequence å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ selec...</div></div></div></a><a class="pagination-related" href="/2018/06/19/%E5%A6%82%E4%BD%95%E5%81%9A%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8B%E7%9A%84%E7%AD%94%E6%A1%88/" title="å¦‚ä½•åšæ€§èƒ½æµ‹è¯•çš„é—®é¢˜ä¸‹çš„ç­”æ¡ˆ"><img class="cover" src="/img/wall-paper-62.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-19</div><div class="info-item-2">å¦‚ä½•åšæ€§èƒ½æµ‹è¯•çš„é—®é¢˜ä¸‹çš„ç­”æ¡ˆ</div></div><div class="info-2"><div class="info-item-1">è¯•ç€å›ç­”ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚ é¦–å…ˆè¦åˆ’åˆ†ç³»ç»Ÿç±»å‹ï¼šæœ‰çŠ¶æ€è¿˜æ˜¯æ— çŠ¶æ€ï¼Œä¸šåŠ¡ç³»ç»Ÿè¿˜æ˜¯å­˜å‚¨ç³»ç»Ÿã€‚æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œè®¾ç«‹æ€§èƒ½æµ‹è¯•çš„ç›®æ ‡ï¼šæ˜¯è¦æµ‹ QPSï¼Œè¿˜æ˜¯ TPS è¿˜æ˜¯ TPSï¼Œè¿˜æ˜¯ä»»ä½•å…¶ä»–ã€æ€§èƒ½ã€‘-ä»å¹¿ä¹‰æ¥è®²ï¼Œä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿåˆ°åº•èƒ½å¤Ÿä»¥å¤šé«˜çš„å¹³å‡æ—¶å»¶æ¥ç®¡ç†å¤§å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œå¯èƒ½ä¹Ÿæ˜¯æ€§èƒ½çš„ä¸€ç§ã€‚ æœ‰äº†æ€§èƒ½æµ‹è¯•çš„ç›®æ ‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‹†è§£ç”¨ä¾‹ã€‚å¦‚æœæŠŠæ€§èƒ½æµ‹è¯•å½’ä¸ºæµ‹è¯•çš„è¯ï¼Œæµ‹è¯•å°±éœ€è¦æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ç”¨ä¾‹åªæ˜¯ç”¨ä¾‹çš„å½¢å¼åŒ–è¡¨è¾¾ã€‚æŠŠç”¨æˆ·çš„ä½¿ç”¨åœºæ™¯å‹¾å‹’å‡ºæ¥ï¼ŒæŠŠæ¯ä¸€æ­¥æ‹†è§£æˆçš„æµç¨‹å›¾æˆ–è€…æ—¶åºå›¾â€“æˆ‘ä»¬å·²ç»å¾—åˆ°äº†ä¸€ä¸ªçº¸ä¸Šçš„é›†æˆæµ‹è¯•è®¡åˆ’ï¼Œåªæ˜¯æ²¡æœ‰è·Ÿæ€§èƒ½æŒ‚ä¸Šé’©ã€‚ æ¥ä¸‹æ¥å°±è¿›å…¥çœŸæ­£å†™æµ‹è¯•ç”¨ä¾‹çš„ç¯èŠ‚äº†ã€‚ æˆ‘ä»¬çš„æµ‹è¯•æŠ¥å‘Šå¦‚æœè¦æ¶µç›–è¶³å¤Ÿç«‹ä½“çš„ä¿¡æ¯ï¼Œåˆ™æ—¢è¦äº†è§£æ¯ä¸€ä¸ªç¯èŠ‚/æ¥å£/API çš„æ€§èƒ½æŒ‡æ ‡ï¼Œåˆè¦äº†è§£æ•´ä½“çš„æ€§èƒ½æŒ‡æ ‡ã€‚ è¿™ä¸ªæ—¶å€™æµ‹è¯•å·¥å…·çš„è¦†ç›–é¢å°±å¾ˆé‡è¦äº†ã€‚å¦‚æœæˆ‘ä»¬é€‰æ‹©åé»‘ç›’çš„æµ‹è¯•å·¥å…·ï¼Œapache ab /JMeterï¼Œåˆ™æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹å°±è¦å›´ç»•ç€å¯¹å¤–äº¤äº’çš„ APIå†™ï¼Œä¹Ÿåªèƒ½æµ‹åˆ°å¤–å›´æ¥å£çš„æ€§èƒ½ã€‚è¿™æ ·çš„æµ‹è¯•ç”¨ä¾‹å†™èµ·æ¥æœ€ç®€å•ï¼Œæ— éœ€ä¾µå…¥ä»»ä½•å†…éƒ¨ä»£ç ä¸­ã€‚ å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº† JMH ä¸€ç±»çš„å·¥å…·ï¼Œåˆ™å¯ä»¥è‡ªç”±ç¼–å†™å¯¹ä»»ä½•æ–¹æ³•çš„æµ‹è¯•ç”¨ä¾‹ã€‚ä½†éœ€è¦å¯¹ç³»ç»Ÿæœ‰éå¸¸...</div></div></div></a><a class="pagination-related" href="/2018/09/07/%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/" title="æ—¥æœŸä¸æ—¶é—´"><img class="cover" src="/img/wall-paper-57.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-09-07</div><div class="info-item-2">æ—¥æœŸä¸æ—¶é—´</div></div><div class="info-2"><div class="info-item-1">JSR 310 Java Dateä¸Time API æ–°æ—§ API çš„æ›´è¿­ æ—§çš„ Java API ä¸»è¦åŒ…æ‹¬java.util.Dateå’Œjava.util.Calendar ä¸¤ä¸ªåŒ…çš„å†…å®¹ã€‚è¿™ä¸¤ä¸ªåŒ…çš„æ—¶é—´ç±»å‹æ˜¯å¯å˜çš„ã€‚å¦‚ Date çš„å®ä¾‹å¯ä»¥é€šè¿‡ setYear æ¥äº§ç”Ÿå˜åŒ–ã€‚ JSR 310 ä¸­åŒ…æ‹¬çš„æ—¥æœŸç±»å‹ä¸»è¦æœ‰ï¼š  è®¡ç®—æœºæ—¶é—´ï¼šInstantï¼Œå¯¹åº” java.util.Dateï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªç¡®å®šçš„æ—¶é—´ç‚¹ï¼Œå³ç›¸å¯¹äºæ ‡å‡†Javaçºªå…ƒï¼ˆ1970å¹´1æœˆ1æ—¥ï¼‰çš„åç§»é‡ï¼›ä½†ä¸java.util.Dateç±»ä¸åŒçš„æ˜¯å…¶ç²¾ç¡®åˆ°äº†çº³ç§’çº§åˆ«ã€‚ äººç±»æ—¶é—´ï¼šå¯¹åº”äºäººç±»è‡ªèº«çš„è§‚å¿µï¼Œæ¯”å¦‚LocalDateå’ŒLocalTimeã€‚ä»–ä»¬ä»£è¡¨äº†ä¸€èˆ¬çš„æ—¶åŒºæ¦‚å¿µï¼Œè¦ä¹ˆæ˜¯æ—¥æœŸï¼ˆä¸åŒ…å«æ—¶é—´ï¼‰ï¼Œè¦ä¹ˆæ˜¯æ—¶é—´ï¼ˆä¸åŒ…å«æ—¥æœŸï¼‰ï¼Œç±»ä¼¼äºjava.sqlçš„è¡¨ç¤ºæ–¹å¼ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªMonthDayï¼Œå®ƒå¯ä»¥å­˜å‚¨æŸäººçš„ç”Ÿæ—¥ï¼ˆä¸åŒ…å«å¹´ä»½ï¼‰ã€‚æ¯ä¸ªç±»éƒ½åœ¨å†…éƒ¨å­˜å‚¨æ­£ç¡®çš„æ•°æ®è€Œä¸æ˜¯åƒjava.util.Dateé‚£æ ·åˆ©ç”¨åˆå¤œ12ç‚¹æ¥åŒºåˆ†æ—¥æœŸï¼Œåˆ©ç”¨1970-01-01æ¥è¡¨ç¤ºæ—¶é—´ã€‚è¿™äº›ç±»å‹çš„å®ä¾‹æ˜¯ immutable çš„ï¼Œè€Œä¸”åªèƒ½é€šè¿‡å·¥å‚æ–¹æ³•åˆ›å»ºã€‚  æ—¶åŒº...</div></div></div></a><a class="pagination-related" href="/2018/10/13/%E5%8D%A1%E8%A1%A8%E5%92%8C-RSet/" title="å¡è¡¨å’Œ RSet"><img class="cover" src="/img/wall-paper-100.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2018-10-13</div><div class="info-item-2">å¡è¡¨å’Œ RSet</div></div><div class="info-2"><div class="info-item-1">å¡è¡¨å’Œ RSet é—®é¢˜å®šä¹‰ï¼šä¸ºä»€ä¹ˆéœ€è¦è·¨åŒºåŸŸå¼•ç”¨è®°å½• JVM åƒåœ¾æ”¶é›†å™¨çš„æ ¸å¿ƒå·¥ä½œä¹‹ä¸€æ˜¯ç¡®å®š live setâ€”â€”å“ªäº›å¯¹è±¡ä»ç„¶å­˜æ´»ã€ä¸å¯å›æ”¶ã€‚ç¡®å®š live set çš„æ ‡å‡†åšæ³•æ˜¯ä» GC Rootsï¼ˆæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡ã€é™æ€å­—æ®µç­‰ï¼‰å‡ºå‘ï¼Œæ²¿å¼•ç”¨é“¾éå†æ‰€æœ‰å¯è¾¾å¯¹è±¡ã€‚ é—®é¢˜åœ¨äºï¼šå½“å †è¢«åˆ’åˆ†ä¸ºå¤šä¸ªåŒºåŸŸï¼ˆä»£ã€Regionï¼‰å¹¶ä¸”åªå›æ”¶å…¶ä¸­ä¸€éƒ¨åˆ†æ—¶ï¼Œå¦‚ä½•é«˜æ•ˆåœ°æ‰¾åˆ°ä»&quot;ä¸å›æ”¶åŒºåŸŸ&quot;æŒ‡å‘&quot;å›æ”¶åŒºåŸŸ&quot;çš„å¼•ç”¨ï¼Ÿ ä»¥ Young GC ä¸ºä¾‹ï¼šåªå›æ”¶æ–°ç”Ÿä»£ï¼Œä½†è€å¹´ä»£ä¸­å¯èƒ½æŒæœ‰æŒ‡å‘æ–°ç”Ÿä»£å¯¹è±¡çš„å¼•ç”¨ã€‚å¦‚æœä¸å¤„ç†è¿™äº›è·¨ä»£å¼•ç”¨ï¼Œå°±ä¼šé”™è¯¯åœ°å›æ”¶ä»è¢«è€å¹´ä»£å¼•ç”¨çš„æ–°ç”Ÿä»£å¯¹è±¡ã€‚æœ€æœ´ç´ çš„åšæ³•æ˜¯æ‰«ææ•´ä¸ªè€å¹´ä»£æ¥æ‰¾å‡ºè¿™äº›å¼•ç”¨â€”â€”ä½†è€å¹´ä»£é€šå¸¸è¿œå¤§äºæ–°ç”Ÿä»£ï¼Œè¿™æ ·åšçš„ä»£ä»·è¿‡é«˜ï¼Œè¿èƒŒäº†åˆ†ä»£æ”¶é›†&quot;åªå›æ”¶ä¸€éƒ¨åˆ†å †&quot;çš„åˆè¡·ã€‚ å¡è¡¨ï¼ˆCard Tableï¼‰å’Œ RSetï¼ˆRemembered Setï¼‰æ­£æ˜¯ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜è€Œè®¾è®¡çš„è¾…åŠ©æ•°æ®ç»“æ„ã€‚äºŒè€…çš„å…³ç³»å¹¶éäº’ç›¸æ›¿ä»£ï¼Œè€Œæ˜¯å±‚æ¬¡ä¸åŒã€åä½œäº’è¡¥ï¼šå¡è¡¨æ˜¯åº•å±‚çš„è„æ ‡è®°æœºåˆ¶ï¼ŒRSet æ˜¯å»ºç«‹åœ¨å¡è¡¨ä¹‹ä¸Šçš„æ›´é«˜å±‚ç´¢å¼•ç»“æ„ã€‚ æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ åœ¨æ·±å…¥ç»†èŠ‚ä¹‹å‰ï¼Œ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">åŸºæœ¬è®¾è®¡åŸåˆ™</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">åŸºæœ¬è¯­æ³•</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">è¾¹ç•Œ&#x2F;ç»‘å®šç±»å‹ï¼ˆbounding typeï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E6%B3%9B%E5%9E%8B%E8%BE%B9%E7%95%8C%E6%A8%A1%E5%BC%8F-recursive-generic-type-bounds"><span class="toc-number">3.1.</span> <span class="toc-text">é€’å½’æ³›å‹è¾¹ç•Œæ¨¡å¼ï¼ˆRecursive Generic Type Boundsï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E5%92%8C-comparable-%E6%AF%94%E8%BE%83"><span class="toc-number">3.1.1.</span> <span class="toc-text">æ³¨æ„å’Œ Comparable æ¯”è¾ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E5%8F%89%E7%B1%BB%E5%9E%8B-intersection-types"><span class="toc-number">3.1.2.</span> <span class="toc-text">äº¤å‰ç±»å‹ï¼ˆIntersection Typesï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E7%B1%BB%E5%9E%8B%E8%BE%B9%E7%95%8C"><span class="toc-number">3.1.3.</span> <span class="toc-text">é€’å½’ç±»å‹è¾¹ç•Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E9%99%90%E5%AE%9A%E7%B1%BB%E5%9E%8B-self-bounded-types"><span class="toc-number">3.1.4.</span> <span class="toc-text">è‡ªé™å®šç±»å‹ï¼ˆSelf-bounded Typesï¼‰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">ç±»å‹æ“¦é™¤ï¼ˆtype erasureï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%A6%E9%99%A4%E7%9A%84%E5%AE%9E%E9%99%85%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">4.1.</span> <span class="toc-text">æ“¦é™¤çš„å®é™…å·¥ä½œæµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%A5%E6%8E%A5%E6%96%B9%E6%B3%95%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E4%BE%8B%E5%AD%90"><span class="toc-number">4.1.1.</span> <span class="toc-text">æ¡¥æ¥æ–¹æ³•çš„å¦ä¸€ç§ä¾‹å­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%A5%E6%96%B9%E6%B3%95%E7%9A%84%E7%94%9F%E6%88%90%E8%A7%84%E5%88%99"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">æ¡¥æ–¹æ³•çš„ç”Ÿæˆè§„åˆ™</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B-clash"><span class="toc-number">4.1.2.</span> <span class="toc-text">ç±»å‹ clash</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8E%E9%81%97%E7%95%99%E4%BB%A3%E7%A0%81%E7%9A%84%E5%86%B2%E7%AA%81"><span class="toc-number">4.2.</span> <span class="toc-text">ä¸é—ç•™ä»£ç çš„å†²çª</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">é’»çŸ³æ“ä½œç¬¦ &lt;&gt;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">Type Witness ç±»å‹è§è¯&#x2F;ç›®å‡»è€…</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">æ³›å‹ä¸èƒ½åšä»€ä¹ˆï¼ˆRestricstions and Limitationsï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%AE%9E%E4%BE%8B%E5%8C%96-type-parameters"><span class="toc-number">7.1.</span> <span class="toc-text">ä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹å®ä¾‹åŒ– type parameters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B%E8%AF%86%E5%88%AB-inquiry-%E5%8F%AA%E8%83%BD%E5%9C%A8-raw-type-%E4%B8%8A%E5%B7%A5%E4%BD%9C"><span class="toc-number">7.2.</span> <span class="toc-text">åŠ¨æ€ç±»å‹è¯†åˆ«ï¼ˆinquiryï¼‰åªèƒ½åœ¨ raw type ä¸Šå·¥ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%83%BD%E5%88%9B%E5%BB%BA-parameterizedtype-%E4%BD%9C%E5%85%83%E7%B4%A0%E7%9A%84%E6%95%B0%E7%BB%84"><span class="toc-number">7.3.</span> <span class="toc-text">ä¸èƒ½åˆ›å»º ParameterizedType ä½œå…ƒç´ çš„æ•°ç»„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0%E5%8F%AF%E4%BB%A5%E5%92%8Cvargargs-%E4%B8%80%E8%B5%B7%E5%B7%A5%E4%BD%9C"><span class="toc-number">7.4.</span> <span class="toc-text">ç±»å‹å‚æ•°å¯ä»¥å’Œvargargs ä¸€èµ·å·¥ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%83%BD%E5%88%9D%E5%A7%8B%E5%8C%96-type-variables%EF%BC%9A"><span class="toc-number">7.5.</span> <span class="toc-text">ä¸èƒ½åˆå§‹åŒ– type variablesï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%83%BD%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%B3%9B%E5%9E%8B%E6%95%B0%E7%BB%84"><span class="toc-number">7.6.</span> <span class="toc-text">ä¸èƒ½å®ä¾‹åŒ–æ³›å‹æ•°ç»„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%B1%BB%E7%9A%84-type-variables-%E4%B8%8D%E8%83%BD%E5%9C%A8%E5%AE%83%E7%9A%84-static-%E4%B8%8A%E4%B8%8B%E6%96%87%E9%87%8C%E5%B7%A5%E4%BD%9C"><span class="toc-number">7.7.</span> <span class="toc-text">æ³›å‹ç±»çš„ type variables ä¸èƒ½åœ¨å®ƒçš„ static ä¸Šä¸‹æ–‡é‡Œå·¥ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%83%BD%E6%8A%9B%E5%87%BA%E5%92%8C%E6%8D%95%E8%8E%B7%E6%B3%9B%E5%9E%8B%E7%B1%BB"><span class="toc-number">7.8.</span> <span class="toc-text">ä¸èƒ½æŠ›å‡ºå’Œæ•è·æ³›å‹ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A7%E5%A6%99%E5%9C%B0%E4%BD%BF%E7%94%A8%E6%B3%9B%E5%9E%8B-%E5%8F%AF%E4%BB%A5%E7%A0%B4%E5%9D%8F-checked-exception-%E7%9A%84%E9%99%90%E5%88%B6"><span class="toc-number">7.9.</span> <span class="toc-text">å·§å¦™åœ°ä½¿ç”¨æ³›å‹ï¼Œå¯ä»¥ç ´å checked exception çš„é™åˆ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B8%E8%BF%9C%E4%B8%8D%E8%A6%81%E5%86%99boolean-equals-t-object"><span class="toc-number">7.10.</span> <span class="toc-text">æ°¸è¿œä¸è¦å†™boolean equals(T object)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%8D%E8%B0%88%E6%95%B0%E7%BB%84%E5%92%8C%E6%B3%9B%E5%9E%8B%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF%E5%92%8C%E5%8D%8F%E5%8F%98"><span class="toc-number">7.11.</span> <span class="toc-text">å†è°ˆæ•°ç»„å’Œæ³›å‹ç±»çš„ç»§æ‰¿å’Œåå˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E4%B8%8E%E6%95%B0%E7%BB%84"><span class="toc-number">7.12.</span> <span class="toc-text">æ³›å‹ä¸æ•°ç»„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%8D%8F%E5%8F%98-vs-%E6%B3%9B%E5%9E%8B%E4%B8%8D%E5%8F%98"><span class="toc-number">7.12.1.</span> <span class="toc-text">æ•°ç»„åå˜ vs æ³›å‹ä¸å˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E5%88%9B%E5%BB%BA%E6%B3%9B%E5%9E%8B%E6%95%B0%E7%BB%84"><span class="toc-number">7.12.2.</span> <span class="toc-text">ä¸ºä»€ä¹ˆä¸èƒ½åˆ›å»ºæ³›å‹æ•°ç»„</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">æ³›å‹èƒ½å¤Ÿåšä»€ä¹ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6-wildcard"><span class="toc-number">8.1.</span> <span class="toc-text">é€šé…ç¬¦ï¼ˆwildcardï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pecs-%E5%8E%9F%E5%88%99"><span class="toc-number">8.1.1.</span> <span class="toc-text">PECS åŸåˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E7%9A%84%E4%BE%8B%E5%AD%90-%EF%BC%9F%E5%92%8C-t-%E5%90%8C%E6%97%B6%E5%87%BA%E7%8E%B0"><span class="toc-number">8.1.2.</span> <span class="toc-text">æ—¥æœŸçš„ä¾‹å­-ï¼Ÿå’Œ T åŒæ—¶å‡ºç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E4%B8%A5%E6%A0%BC%E7%9A%84"><span class="toc-number">8.1.3.</span> <span class="toc-text">æ›´ä¸¥æ ¼çš„&lt;?&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6%E6%8D%95%E8%8E%B7%EF%BC%9A%E5%8D%95%E5%B1%82-%E5%8F%82%E6%95%B0%E6%96%B9%E6%B3%95%E5%A5%97%E7%9D%80%E5%8D%95%E5%B1%82-t-%E5%8F%82%E6%95%B0%E6%96%B9%E6%B3%95-%E8%80%8C%E9%80%BB%E8%BE%91%E6%98%AF%E5%9C%A8%E5%86%85%E5%B1%82%E6%96%B9%E6%B3%95%E9%87%8C%E5%86%99%E7%9A%84"><span class="toc-number">8.1.4.</span> <span class="toc-text">é€šé…ç¬¦æ•è·ï¼šå•å±‚&lt;?&gt;å‚æ•°æ–¹æ³•å¥—ç€å•å±‚&lt;T&gt;å‚æ•°æ–¹æ³•ï¼Œè€Œé€»è¾‘æ˜¯åœ¨å†…å±‚æ–¹æ³•é‡Œå†™çš„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%BD%E7%81%B5%E7%B1%BB%E5%9E%8B"><span class="toc-number">8.1.5.</span> <span class="toc-text">å¹½çµç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">8.1.5.1.</span> <span class="toc-text">æ„é€ ç±»å‹çš„ç”¨æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%9F%BA%E4%BA%8E%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">8.1.5.2.</span> <span class="toc-text">ä¸åŸºäºæ¥å£çš„ç”¨æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#builder-pattern"><span class="toc-number">8.1.5.3.</span> <span class="toc-text">builder pattern</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">9.</span> <span class="toc-text">æ³›å‹ä¸åå°„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E4%B8%8E-class"><span class="toc-number">9.1.</span> <span class="toc-text">æ³›å‹ä¸ class</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E8%83%BD%E5%A4%9F%E5%9C%A8%E6%93%A6%E9%99%A4%E5%90%8E%E7%9F%A5%E9%81%93%E4%BA%9B%E4%BB%80%E4%B9%88"><span class="toc-number">9.2.</span> <span class="toc-text">åå°„èƒ½å¤Ÿåœ¨æ“¦é™¤åçŸ¥é“äº›ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E4%BB%A5%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%9C%E8%A5%BF"><span class="toc-number">9.3.</span> <span class="toc-text">ä¸å¯ä»¥çŸ¥é“çš„ä¸œè¥¿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF"><span class="toc-number">9.3.1.</span> <span class="toc-text">è·å–ç±»å‹ä¿¡æ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E4%BC%9A%E4%B8%A2%E5%A4%B1%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF"><span class="toc-number">9.3.1.1.</span> <span class="toc-text">ä»€ä¹ˆæƒ…å†µä¸‹ä¼šä¸¢å¤±ç±»å‹ä¿¡æ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E8%83%BD%E5%A4%9F%E8%8E%B7%E5%8F%96%E5%88%B0%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF"><span class="toc-number">9.3.1.2.</span> <span class="toc-text">ä»€ä¹ˆæƒ…å†µä¸‹èƒ½å¤Ÿè·å–åˆ°ç±»å‹ä¿¡æ¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E7%9A%84%E7%B1%BB%E5%9E%8B-hierarchy"><span class="toc-number">9.4.</span> <span class="toc-text">åå°„çš„ç±»å‹ hierarchy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#class"><span class="toc-number">9.4.1.</span> <span class="toc-text">Class</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#typevariable-%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F"><span class="toc-number">9.4.2.</span> <span class="toc-text">TypeVariableï¼ˆç±»å‹å˜é‡ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parameterizedtype-%E5%8F%82%E6%95%B0%E5%8C%96%E7%B1%BB%E5%9E%8B"><span class="toc-number">9.4.3.</span> <span class="toc-text">ParameterizedTypeï¼ˆå‚æ•°åŒ–ç±»å‹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#genericarraytype-%E6%B3%9B%E5%9E%8B%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">9.4.4.</span> <span class="toc-text">GenericArrayTypeï¼ˆæ³›å‹æ•°ç»„ç±»å‹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">9.4.5.</span> <span class="toc-text">ä¸»è¦ä½¿ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#typeliteral"><span class="toc-number">9.5.</span> <span class="toc-text">TypeLiteral</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E6%8D%95%E8%8E%B7%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">9.6.</span> <span class="toc-text">è¿è¡Œæ—¶æ•è·ç±»å‹å‚æ•°çš„æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">9.6.1.</span> <span class="toc-text">æ–¹æ³•ä¸€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">9.6.2.</span> <span class="toc-text">æ–¹æ³•äºŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89"><span class="toc-number">9.6.3.</span> <span class="toc-text">æ–¹æ³•ä¸‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%9A%84%E9%87%8D%E8%BD%BD%E9%99%90%E5%88%B6"><span class="toc-number">9.7.</span> <span class="toc-text">æ³›å‹çš„é‡è½½é™åˆ¶</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">10.</span> <span class="toc-text">å„ç§æ³›å‹é»‘é­”æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E4%BC%BC%E5%B9%BD%E7%81%B5%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="toc-number">10.1.</span> <span class="toc-text">ç±»ä¼¼å¹½çµç±»å‹çš„æ¨¡å¼åŒ¹é…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%80%9A%E9%85%8D%E7%AC%A6%E7%9A%84-bound"><span class="toc-number">10.2.</span> <span class="toc-text">è·å–é€šé…ç¬¦çš„ bound</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#optional-%E9%87%8C%E9%80%9A%E9%85%8D%E7%AC%A6%E8%BD%AC%E6%88%90%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="toc-number">10.3.</span> <span class="toc-text">Optional é‡Œé€šé…ç¬¦è½¬æˆç±»å‹å‚æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A1%AE%E8%AE%A4%E6%B6%88%E8%B4%B9%E7%B1%BB%E5%9E%8B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95"><span class="toc-number">10.4.</span> <span class="toc-text">ç¡®è®¤æ¶ˆè´¹ç±»å‹çš„ä¸¤ç§æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%9C%A8-lambda-%E4%B8%8E-stream-%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD"><span class="toc-number">10.5.</span> <span class="toc-text">æ³›å‹åœ¨ Lambda ä¸ Stream ä¸­çš„ç±»å‹æ¨æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD"><span class="toc-number">10.5.1.</span> <span class="toc-text">ç›®æ ‡ç±»å‹æ¨æ–­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream-%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E4%BC%A0%E6%92%AD"><span class="toc-number">10.5.2.</span> <span class="toc-text">Stream é“¾å¼è°ƒç”¨ä¸­çš„ç±»å‹ä¼ æ’­</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E4%B8%8E%E6%B3%A8%E8%A7%A3-type-annotations"><span class="toc-number">10.6.</span> <span class="toc-text">æ³›å‹ä¸æ³¨è§£ï¼ˆType Annotationsï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">10.7.</span> <span class="toc-text">æ³›å‹æœ€ä½³å®è·µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%BF%E5%85%8D%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B"><span class="toc-number">10.7.1.</span> <span class="toc-text">é¿å…åŸå§‹ç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%85%88%E4%BD%BF%E7%94%A8-list-%E8%80%8C%E9%9D%9E%E6%95%B0%E7%BB%84"><span class="toc-number">10.7.2.</span> <span class="toc-text">ä¼˜å…ˆä½¿ç”¨ List è€Œéæ•°ç»„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pecs-%E5%8E%9F%E5%88%99%E7%9A%84%E5%AE%9E%E8%B7%B5"><span class="toc-number">10.7.3.</span> <span class="toc-text">PECS åŸåˆ™çš„å®è·µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%9F%E6%9F%A5%E8%A1%A8"><span class="toc-number">10.7.4.</span> <span class="toc-text">æ¨¡å¼é€ŸæŸ¥è¡¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">11.</span> <span class="toc-text">å…¶ä»–èµ„æ–™</span></a></li></ol></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2017 - 2026 By magicliang</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">ç°¡</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="/js/tw_cn.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="/"></script></div></body></html>